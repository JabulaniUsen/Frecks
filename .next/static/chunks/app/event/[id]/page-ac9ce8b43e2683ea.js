(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[744],{5906:function(e,r,t){Promise.resolve().then(t.bind(t,2634))},2634:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return I}});var s=t(7437),a=t(7648),i=t(2265),n=t(1713),l=t(1770),c=t(9376),d=t(2381),o=t(9174),m=t(279),x=t(5060),u=t(2660),h=t(1047),f=t(3774),p=t(5805),g=t(1723),b=t(9554),j=t(9397),v=t(4286),N=t(1817),y=t(6629),w=t(1980),k=t(5658),_=t(5819),E=t(5526);let P=async e=>{let r=e.validationUrl||"".concat(window.location.origin,"/ticket/").concat(e.ticketId);try{return await _.toDataURL(r,{errorCorrectionLevel:"M",type:"image/png",margin:1,width:300})}catch(e){throw console.error("Error generating QR code:",e),e}},S=async(e,r)=>{try{let a=await P(e),i=await fetch(a),n=await i.blob(),l=new File([n],"qr-".concat(e.ticketId,".png"),{type:"image/png"}),c="".concat(r,"/").concat(e.ticketId,".png"),{data:d,error:o}=await E.supabase.storage.from("ticket-qr").upload(c,l,{cacheControl:"3600",upsert:!0});if(o){var t,s;if(null===(t=o.message)||void 0===t?void 0:t.includes("Bucket not found"))throw Error('Storage bucket "ticket-qr" not found. Please create it in your Supabase dashboard.');if(null===(s=o.message)||void 0===s?void 0:s.includes("new row violates row-level security"))throw Error("Permission denied. Please check storage bucket policies.");throw Error("QR code upload failed: ".concat(o.message))}if(!d)throw Error("Upload succeeded but no data returned");let{data:m}=E.supabase.storage.from("ticket-qr").getPublicUrl(c);if(!(null==m?void 0:m.publicUrl))throw Error("Failed to get public URL for uploaded QR code");return m.publicUrl}catch(e){throw console.error("Error generating and uploading QR code:",e),e}};var C=t(4362),q=t(4014),F=t(24),Z=t(2834),D=t(4438);function I(){let e=(0,c.useParams)(),r=(0,c.useRouter)(),t=e.id,{user:_,profile:I}=(0,C.a)(),{data:L,isLoading:U,error:A}=(0,n.a)({queryKey:["event",t],queryFn:()=>(0,y.Y)(t),enabled:!!t}),[M,R]=(0,i.useState)({}),[z,T]=(0,i.useState)("select"),[B,O]=(0,i.useState)(""),[Q,Y]=(0,i.useState)(""),[W,H]=(0,i.useState)(!1),[J,V]=(0,i.useState)(!1),K=(null==L?void 0:L.ticket_types)||[],G=Object.entries(M).reduce((e,r)=>{let[t,s]=r,a=K.find(e=>e.id===t);return e+((null==a?void 0:a.price)||0)*s},0),X=G+200,$=K.reduce((e,r)=>e+(r.sold_count||0),0),ee=Object.values(M).reduce((e,r)=>e+r,0);(0,i.useEffect)(()=>{(0,k.Uc)().then(()=>{V(!0)})},[]),(0,i.useEffect)(()=>{"checkout"===z&&I&&(I.full_name&&!B.trim()&&O(I.full_name),I.email&&!Q.trim()&&Y(I.email))},[z,I]);let er=(0,l.D)({mutationFn:async()=>{if(!B.trim()||!Q.trim())throw Error("Please fill in your name and email");if(0===ee)throw Error("Please select at least one ticket");let e="frecks_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(7)),r=[];for(let[e,s]of Object.entries(M))for(let a=0;a<s;a++){let s={ticketId:"temp_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(7)),orderId:"",eventId:t,timestamp:Date.now()},i=await P(s),n="".concat(t,"_").concat(e,"_").concat(Date.now(),"_").concat(a,"_").concat(Math.random().toString(36).substring(7));r.push({ticket_type_id:e,qr_code:n,qr_code_data:{...s,qrCodeImage:i}})}let s=await (0,w.LV)({user_id:null==_?void 0:_.id,event_id:t,email:Q.trim(),full_name:B.trim(),total_amount:X,paystack_reference:e,payment_status:"pending",tickets:r});if(s.id&&(null==_?void 0:_.id)){let{data:e}=await E.supabase.from("tickets").select("id, ticket_type_id").eq("order_id",s.id).order("created_at",{ascending:!0});if(e&&e.length===r.length)for(let r=0;r<e.length;r++){let a=e[r],i=window.location.origin,n="".concat(i,"/ticket/").concat(a.id),l={ticketId:a.id,orderId:s.id,eventId:t,timestamp:Date.now(),validationUrl:n},c=await S(l,_.id);await E.supabase.from("tickets").update({qr_code:n,qr_code_data:{...l,qrCodeImageUrl:c}}).eq("id",a.id)}}return{order:s,paystackReference:e}}}),et=(0,l.D)({mutationFn:async e=>{let{orderId:r,paystackReference:t}=e,s=await (0,k.m5)(r,t);if(!s.verified)throw Error(s.error||"Payment verification failed");return s}});if(U)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-center",children:"Loading event..."})});if(A||!L)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Event not found"}),(0,s.jsx)(a.default,{href:"/",children:(0,s.jsx)(d.z,{children:"Back to Home"})})]})});let es=(e,r)=>{R(t=>{let s=Math.max(0,Math.min(10,(t[e]||0)+r));if(0===s){let{[e]:r,...s}=t;return s}return{...t,[e]:s}})},ea=async()=>{if(!B.trim()||!Q.trim()){D.Am.error("Please fill in your name and email");return}if(!J){D.Am.error("Payment system is loading. Please wait a moment.");return}H(!0),T("processing");try{let e=await er.mutateAsync(),s=e.order,a=e.paystackReference;(0,k.Wb)({email:Q.trim(),amount:X,ref:a,metadata:{orderId:s.id,eventId:t,custom_fields:[{display_name:"Full Name",variable_name:"full_name",value:B.trim()}]},callback:async e=>{try{await et.mutateAsync({orderId:s.id,paystackReference:e.reference}),r.push("/invoice/".concat(s.id))}catch(e){console.error("Payment verification error:",e),D.Am.error((null==e?void 0:e.message)||"Payment verification failed. Please contact support."),T("checkout")}finally{H(!1)}},onClose:()=>{H(!1),T("checkout"),D.Am.info("Payment cancelled")}})}catch(e){console.error("Order creation error:",e),D.Am.error((null==e?void 0:e.message)||"Failed to create order. Please try again."),H(!1),T("checkout")}};return(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)(F.default,{}),(0,s.jsxs)("main",{className:"pt-20",children:[(0,s.jsxs)("div",{className:"relative h-64 md:h-96 overflow-hidden",children:[(0,s.jsx)("img",{src:L.image_url||"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=800&h=600&fit=crop",alt:L.title,className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-background/50 to-transparent"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-6",children:(0,s.jsx)("div",{className:"container mx-auto",children:(0,s.jsxs)(a.default,{href:"/",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-4 transition-colors",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4"}),"Back to Events"]})})})]}),(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2",children:[(0,s.jsx)(o.C,{className:"bg-primary text-primary-foreground mb-4",children:L.category}),(0,s.jsx)("h1",{className:"text-3xl md:text-4xl font-bold mb-6",children:L.title}),(0,s.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4 mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-card rounded-xl border border-border",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(h.Z,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Date & Time"}),(0,s.jsx)("div",{className:"font-semibold",children:(0,q.WU)(new Date(L.date),"EEE, MMM d, yyyy • h:mm a")})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-card rounded-xl border border-border",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(f.Z,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Location"}),(0,s.jsx)("div",{className:"font-semibold",children:L.location})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-card rounded-xl border border-border",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(p.Z,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Attendees"}),(0,s.jsxs)("div",{className:"font-semibold",children:[$," going"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-card rounded-xl border border-border",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(g.Z,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Duration"}),(0,s.jsx)("div",{className:"font-semibold",children:"3-4 hours"})]})]})]}),(0,s.jsxs)("div",{className:"prose prose-lg max-w-none",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"About This Event"}),(0,s.jsx)("p",{className:"text-muted-foreground whitespace-pre-line",children:L.description||"Join us for an unforgettable experience at ".concat(L.title,"! This event brings together students from across the university for an amazing time filled with entertainment, networking, and fun.")})]})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"sticky top-24 bg-card rounded-2xl border border-border shadow-card overflow-hidden",children:["select"===z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"p-6 border-b border-border",children:(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Select Tickets"})}),(0,s.jsx)("div",{className:"p-6 space-y-4",children:0===K.length?(0,s.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No tickets available for this event."}):K.map(e=>(0,s.jsxs)("div",{className:"p-4 bg-background rounded-xl border border-border",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,s.jsx)("div",{className:"text-lg font-bold text-primary",children:e.is_free?"Free":"₦".concat(e.price)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-3 mt-3",children:[(0,s.jsx)("button",{onClick:()=>es(e.id,-1),className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center hover:bg-muted/80 transition-colors",children:(0,s.jsx)(b.Z,{className:"w-4 h-4"})}),(0,s.jsx)("span",{className:"w-8 text-center font-semibold",children:M[e.id]||0}),e.quantity&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["/ ",e.quantity-(e.sold_count||0)," left"]}),(0,s.jsx)("button",{onClick:()=>es(e.id,1),className:"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center hover:brightness-110 transition-all",children:(0,s.jsx)(j.Z,{className:"w-4 h-4"})})]})]},e.id))}),(0,s.jsxs)("div",{className:"p-6 border-t border-border bg-muted/30",children:[(0,s.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:["Subtotal (",ee," ",1===ee?"ticket":"tickets",")"]}),(0,s.jsxs)("span",{className:"font-medium",children:["₦",G.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Service Charge"}),(0,s.jsxs)("span",{className:"font-medium",children:["₦",200..toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between pt-2 border-t border-border",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Total"}),(0,s.jsxs)("span",{className:"text-2xl font-bold",children:["₦",X.toLocaleString()]})]})]}),(0,s.jsx)(d.z,{variant:"hero",className:"w-full",size:"lg",onClick:()=>{ee>0&&T("checkout")},disabled:0===ee,children:"Continue to Checkout"})]})]}),"checkout"===z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"p-6 border-b border-border",children:[(0,s.jsxs)("button",{onClick:()=>T("select"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground mb-2",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4"}),"Back"]}),(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Checkout"})]}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(x._,{htmlFor:"fullName",children:"Full Name *"}),(0,s.jsx)(m.I,{id:"fullName",type:"text",placeholder:"John Doe",value:B,onChange:e=>O(e.target.value),className:"mt-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(x._,{htmlFor:"email",children:"Email *"}),(0,s.jsx)(m.I,{id:"email",type:"email",placeholder:"john@university.edu",value:Q,onChange:e=>Y(e.target.value),className:"mt-2",required:!0})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)(v.Z,{className:"w-4 h-4 text-primary"}),"Your payment is processed securely by Paystack"]})]}),(0,s.jsxs)("div",{className:"p-6 border-t border-border bg-muted/30",children:[(0,s.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,s.jsxs)("span",{className:"font-medium",children:["₦",G.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Service Charge"}),(0,s.jsxs)("span",{className:"font-medium",children:["₦",200..toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between pt-2 border-t border-border",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Total"}),(0,s.jsxs)("span",{className:"text-2xl font-bold",children:["₦",X.toLocaleString()]})]})]}),(0,s.jsx)(d.z,{variant:"hero",className:"w-full",size:"lg",onClick:ea,disabled:!B.trim()||!Q.trim()||!J||W,children:W?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Pay ₦".concat(X.toLocaleString())})]})]}),"processing"===z&&(0,s.jsxs)("div",{className:"p-8 text-center",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(N.Z,{className:"w-10 h-10 text-primary animate-spin"})}),(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Processing Payment"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"Please complete your payment in the popup window..."})]})]})})]})})]}),(0,s.jsx)(Z.Z,{})]})}},2834:function(e,r,t){"use strict";var s=t(7437),a=t(5080),i=t(7760),n=t(2351),l=t(9219),c=t(4767),d=t(2381);r.Z=e=>{let{showNewsletter:r=!1}=e;return(0,s.jsxs)("footer",{id:"about",className:"bg-card border-t border-border",children:[r&&(0,s.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,s.jsxs)("div",{className:"bg-primary rounded-3xl p-8 md:p-12 text-center",children:[(0,s.jsx)("h3",{className:"text-2xl md:text-3xl font-bold text-primary-foreground mb-4",children:"Never Miss an Event! \uD83C\uDFAB"}),(0,s.jsx)("p",{className:"text-primary-foreground/80 mb-6 max-w-md mx-auto",children:"Subscribe to get notified about new events, exclusive deals, and early bird tickets."}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 max-w-md mx-auto",children:[(0,s.jsx)("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-5 py-3 rounded-full bg-primary-foreground/20 border border-primary-foreground/30 text-primary-foreground placeholder:text-primary-foreground/60 outline-none focus:ring-2 focus:ring-primary-foreground/50"}),(0,s.jsx)(d.z,{variant:"secondary",size:"lg",children:"Subscribe"})]})]})}),(0,s.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-8",children:[(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsxs)("a",{href:"/",className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-primary flex items-center justify-center",children:(0,s.jsx)(a.Z,{className:"w-5 h-5 text-primary-foreground"})}),(0,s.jsx)("span",{className:"text-xl font-bold text-primary",children:"Frecks"})]}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Your go-to platform for discovering and booking campus events. Made by students, for students."}),(0,s.jsx)("div",{className:"flex gap-3",children:[i.Z,n.Z,l.Z,c.Z].map((e,r)=>(0,s.jsx)("a",{href:"#",className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center hover:bg-primary hover:text-primary-foreground transition-colors",children:(0,s.jsx)(e,{className:"w-5 h-5"})},r))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold mb-4",children:"Company"}),(0,s.jsx)("ul",{className:"space-y-2",children:["About Us","Careers","Blog","Press"].map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold mb-4",children:"Support"}),(0,s.jsx)("ul",{className:"space-y-2",children:["Help Center","Safety","Terms","Privacy"].map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold mb-4",children:"For Venues"}),(0,s.jsx)("ul",{className:"space-y-2",children:["Partner With Us","List Your Event","Pricing","Resources"].map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]})]})}),(0,s.jsx)("div",{className:"border-t border-border",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-muted-foreground",children:[(0,s.jsx)("p",{children:"\xa9 2026 Frecks. All rights reserved."}),(0,s.jsx)("p",{children:"Made with \uD83E\uDDE1 for students everywhere"})]})})})]})}}},function(e){e.O(0,[227,182,972,506,642,850,823,730,666,713,438,152,24,814,971,117,560],function(){return e(e.s=5906)}),_N_E=e.O()}]);