(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[710],{8932:function(e,t,r){Promise.resolve().then(r.bind(r,8671))},8671:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var s=r(7437),n=r(9376),a=r(1713),i=r(2381),l=r(9174),d=r(6629),c=r(4362),o=r(2660),u=r(5080),m=r(525),x=r(5252),h=r(5805),f=r(6215),v=r(7648),p=r(4014),b=r(1817);function g(){let e=(0,n.useParams)();(0,n.useRouter)();let t=e.id,{profile:r,user:g}=(0,c.a)(),{data:y,isLoading:j}=(0,a.a)({queryKey:["event",t],queryFn:()=>(0,d.Y)(t),enabled:!!t}),{data:N,isLoading:w}=(0,a.a)({queryKey:["event-analytics",t],queryFn:()=>(0,d.Q6)(t),enabled:!!t});if(!r||"creator"!==r.role)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"mb-2",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Only creators can view analytics."})]})});if(j||w)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(b.Z,{className:"w-8 h-8 animate-spin"})});if(!y)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"mb-2",children:"Event not found"}),(0,s.jsx)(v.default,{href:"/dashboard/creator",children:(0,s.jsx)(i.z,{variant:"outline",children:"Back to Dashboard"})})]})});let k=(null==N?void 0:N.orders)||[],_=(null==N?void 0:N.tickets)||[],S=y.ticket_types||[],Z=_.length,M=S.reduce((e,t)=>e+(t.quantity||0),0),q=k.reduce((e,t)=>e+Math.max(0,(parseFloat(t.total_amount)||0)-200),0),I=k.length,C=_.filter(e=>"used"===e.status).length,z=_.filter(e=>"valid"===e.status).length,E=S.map(e=>{let t=_.filter(t=>t.ticket_type_id===e.id),r=t.length*(e.price||0);return{name:e.name,sold:t.length,revenue:r,price:e.price||0}});return(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)("div",{className:"border-b border-border bg-card sticky top-0 z-10",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(v.default,{href:"/dashboard/creator",children:(0,s.jsx)(i.z,{variant:"ghost",size:"icon",children:(0,s.jsx)(o.Z,{className:"w-5 h-5"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Event Analytics"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:y.title})]})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(v.default,{href:"/dashboard/creator/edit/".concat(t),children:(0,s.jsx)(i.z,{variant:"outline",children:"Edit Event"})})})]})})}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[(0,s.jsx)("div",{className:"bg-card rounded-2xl border border-border p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[y.image_url&&(0,s.jsx)("img",{src:y.image_url,alt:y.title,className:"w-full md:w-64 h-48 object-cover rounded-lg"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2",children:y.title}),(0,s.jsx)(l.C,{className:"active"===y.status?"bg-primary":"bg-muted",children:y.status})]})}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:y.description}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Date & Time"}),(0,s.jsx)("p",{className:"font-medium",children:(0,p.WU)(new Date(y.date),"MMM d, yyyy • h:mm a")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Location"}),(0,s.jsx)("p",{className:"font-medium",children:y.location})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Category"}),(0,s.jsx)("p",{className:"font-medium",children:y.category})]})]})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(u.Z,{className:"w-6 h-6 text-primary"})}),(0,s.jsx)(m.Z,{className:"w-5 h-5 text-primary"})]}),(0,s.jsx)("div",{className:"text-2xl font-bold mb-1",children:Z}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tickets Sold"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground mt-2",children:M>0?"".concat(Math.round(Z/M*100),"% of ").concat(M):"No tickets available"})]}),(0,s.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-green-500/10 flex items-center justify-center",children:(0,s.jsx)(x.Z,{className:"w-6 h-6 text-green-600"})}),(0,s.jsx)(m.Z,{className:"w-5 h-5 text-green-600"})]}),(0,s.jsxs)("div",{className:"text-2xl font-bold mb-1",children:["₦",q.toLocaleString()]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Revenue"}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:[I," ",1===I?"order":"orders"]})]}),(0,s.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center",children:(0,s.jsx)(h.Z,{className:"w-6 h-6 text-blue-600"})}),(0,s.jsx)(m.Z,{className:"w-5 h-5 text-blue-600"})]}),(0,s.jsx)("div",{className:"text-2xl font-bold mb-1",children:C}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Checked In"}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:[z," pending"]})]}),(0,s.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-purple-500/10 flex items-center justify-center",children:(0,s.jsx)(f.Z,{className:"w-6 h-6 text-purple-600"})}),(0,s.jsx)(m.Z,{className:"w-5 h-5 text-purple-600"})]}),(0,s.jsx)("div",{className:"text-2xl font-bold mb-1",children:I}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Orders"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground mt-2",children:"All paid"})]})]}),(0,s.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-6 mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Revenue by Ticket Type"}),(0,s.jsx)("div",{className:"space-y-4",children:E.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.sold," sold @ ₦",e.price.toLocaleString()," each"]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("p",{className:"text-lg font-bold text-primary",children:["₦",e.revenue.toLocaleString()]})})]}),M>0&&(0,s.jsx)("div",{className:"w-full h-2 bg-muted rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:"".concat(e.sold/M*100,"%")}})})]},t))})]}),(0,s.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-6 mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Ticket Types Breakdown"}),(0,s.jsx)("div",{className:"space-y-4",children:S.map((e,t)=>{let r=_.filter(t=>t.ticket_type_id===e.id).length,n=e.quantity||0,a=n>0?r/n*100:0;return(0,s.jsxs)("div",{className:"p-4 border border-border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),e.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.description})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("p",{className:"font-bold",children:0===e.price?"Free":"₦".concat(e.price.toLocaleString())})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-2",children:[(0,s.jsxs)("span",{children:[r," / ",n," sold"]}),(0,s.jsxs)("span",{children:[Math.round(a),"%"]})]}),(0,s.jsx)("div",{className:"w-full h-2 bg-muted rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:"".concat(a,"%")}})})]},e.id||t)})})]}),(0,s.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Recent Orders"}),0===k.length?(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No orders yet"}):(0,s.jsx)("div",{className:"space-y-4",children:k.slice(0,10).map(e=>{var t,r;return(0,s.jsx)("div",{className:"p-4 border border-border rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.full_name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,p.WU)(new Date(e.created_at),"MMM d, yyyy • h:mm a")})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-bold text-primary",children:["₦",Math.max(0,parseFloat(e.total_amount||0)-200).toLocaleString()]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground line-through",children:["₦",parseFloat(e.total_amount||0).toLocaleString()," (includes service charge)"]})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[(null===(t=e.tickets)||void 0===t?void 0:t.length)||0," ",(null===(r=e.tickets)||void 0===r?void 0:r.length)===1?"ticket":"tickets"]})]})]})},e.id)})})]})]})]})}},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var s=r(2265);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:c="",children:o,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...i,width:n,height:n,stroke:r,strokeWidth:d?24*Number(l)/Number(n):l,className:a("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(o)?o:[o]])}),d=(e,t)=>{let r=(0,s.forwardRef)((r,i)=>{let{className:d,...c}=r;return(0,s.createElement)(l,{ref:i,iconNode:t,className:a("lucide-".concat(n(e)),d),...c})});return r.displayName="".concat(e),r}},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6215:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},5252:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},1817:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5080:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},525:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var s=r(2972),n=r.n(s)},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},9174:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var s=r(7437);r(2265);var n=r(535),a=r(3448);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)(i({variant:r}),t),...n})}},2381:function(e,t,r){"use strict";r.d(t,{d:function(){return d},z:function(){return c}});var s=r(7437),n=r(2265),a=r(7495),i=r(535),l=r(3448);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-button hover:brightness-110 active:scale-95",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border-2 border-primary bg-transparent text-primary hover:bg-primary hover:text-primary-foreground",secondary:"bg-secondary text-secondary-foreground hover:brightness-110 active:scale-95",ghost:"hover:bg-muted hover:text-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-primary text-primary-foreground shadow-button hover:brightness-110 active:scale-95 font-bold",accent:"bg-accent text-accent-foreground border border-border hover:bg-muted active:scale-95"},size:{default:"h-11 px-6 py-2",sm:"h-9 px-4 text-xs",lg:"h-14 px-8 text-base",xl:"h-16 px-10 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:c=!1,...o}=e,u=c?a.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(d({variant:n,size:i,className:r})),ref:t,...o})});c.displayName="Button"},4362:function(e,t,r){"use strict";r.d(t,{H:function(){return d},a:function(){return l}});var s=r(7437),n=r(2265),a=r(5526);let i=(0,n.createContext)(void 0),l=()=>{let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},d=e=>{let{children:t}=e,[r,l]=(0,n.useState)(null),[d,c]=(0,n.useState)(null),[o,u]=(0,n.useState)(null),[m,x]=(0,n.useState)(!0),h=(0,n.useRef)(null),f=async e=>{if(h.current!==e){h.current=e;try{let{data:t,error:r}=await a.supabase.from("users").select("id, email, full_name, role, gender, school, avatar_name, avatar_url").eq("id",e).single();if(r)throw r;t?c({id:t.id,email:t.email,full_name:t.full_name,role:t.role||"user",gender:t.gender||null,school:t.school||null,avatar_name:t.avatar_name||null,avatar_url:t.avatar_url||null}):c(null)}catch(e){console.error("Error fetching profile:",e),c(null)}finally{h.current=null}}},v=async()=>{r&&(h.current=null,await f(r.id))};(0,n.useEffect)(()=>{let e=!0,t=null;a.supabase.auth.getSession().then(r=>{var s,n,a;let{data:{session:i},error:d}=r;if(e){if(d){x(!1);return}u(i),l(null!==(n=null==i?void 0:i.user)&&void 0!==n?n:null),t=null!==(a=null==i?void 0:null===(s=i.user)||void 0===s?void 0:s.id)&&void 0!==a?a:null,(null==i?void 0:i.user)&&f(i.user.id),e&&x(!1)}});let{data:{subscription:r}}=a.supabase.auth.onAuthStateChange((r,s)=>{var n,a,i;if(!e)return;let d=null!==(a=null==s?void 0:null===(n=s.user)||void 0===n?void 0:n.id)&&void 0!==a?a:null;d!==t&&(u(s),l(null!==(i=null==s?void 0:s.user)&&void 0!==i?i:null),t=d,(null==s?void 0:s.user)?f(s.user.id):c(null))});return()=>{e=!1,r.unsubscribe()}},[]);let p=async()=>{await a.supabase.auth.signOut(),l(null),c(null),u(null),h.current=null};return(0,s.jsx)(i.Provider,{value:{user:r,profile:d,session:o,loading:m,signOut:p,refreshProfile:v},children:t})}},5526:function(e,t,r){"use strict";r.d(t,{supabase:function(){return c}});var s,n,a=r(8280),i=r(257);let l=(void 0!==i?null===(s=i.env)||void 0===s?void 0:"https://ynkvvjkokwwnqoujeznu.supabase.co":void 0)||"",d=(void 0!==i?null===(n=i.env)||void 0===n?void 0:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlua3Z2amtva3d3bnFvdWplem51Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NjE2ODMsImV4cCI6MjA4NDMzNzY4M30.tVFWjO_kqz2iY3GpunHC78czG6Tb2Ikhl1HbVoINbCg":void 0)||"";if(!l||!d){let e="Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your .env.local file. (Note: In Next.js, client-side env vars must be prefixed with NEXT_PUBLIC_)";throw console.error(e),Error(e)}let c=(0,a.eI)(l,d,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},6629:function(e,t,r){"use strict";r.d(t,{DK:function(){return u},HG:function(){return l},Q6:function(){return x},Qn:function(){return d},TX:function(){return o},Y:function(){return i},ZD:function(){return c},ks:function(){return m},nk:function(){return a},vw:function(){return n}});var s=r(5526);let n=async()=>{let e=new Date().toISOString(),{data:t,error:r}=await s.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",e).order("created_at",{ascending:!1});if(r)throw r;return t},a=async e=>{let t=new Date().toISOString(),r=s.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",t);if(e.search&&e.search.trim()){let t=e.search.trim().replace(/%/g,"\\%").replace(/_/g,"\\_");r=r.or("title.ilike.%".concat(t,"%,description.ilike.%").concat(t,"%"))}e.category&&"all"!==e.category&&(r=r.eq("category",e.category)),e.location&&e.location.trim()&&(r=r.ilike("location","%".concat(e.location,"%"))),e.dateFrom&&(r=r.gte("date",e.dateFrom)),e.dateTo&&(r=r.lte("date",e.dateTo)),r=r.order("date",{ascending:!0});let{data:n,error:a}=await r;if(a)throw a;return n},i=async e=>{let{data:t,error:r}=await s.supabase.from("events").select("*, ticket_types(*)").eq("id",e).single();if(r)throw r;return t},l=async e=>{let{data:t,error:r}=await s.supabase.from("orders").select("*, event:events(*), tickets(*, ticket_type:ticket_types(*))").eq("id",e).single();if(r)throw r;return t},d=async e=>{let{data:t,error:r}=await s.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*)").eq("id",e).single();if(r)throw r;return t},c=async e=>{let{data:t,error:r}=await s.supabase.from("orders").select("id").eq("user_id",e).eq("payment_status","paid");if(r)throw r;if(!t||0===t.length)return[];let n=t.map(e=>e.id),{data:a,error:i}=await s.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*), order:orders(*)").eq("user_id",e).in("order_id",n).order("created_at",{ascending:!1});if(i)throw i;return a||[]},o=async e=>{let t=new Date().toISOString(),{data:r,error:n}=await s.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).gte("date",t).order("date",{ascending:!0});if(n)throw n;return r},u=async e=>{let t=new Date().toISOString(),{data:r,error:n}=await s.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).lt("date",t).order("date",{ascending:!1});if(n)throw n;return r},m=async e=>{let{data:t,error:r}=await s.supabase.from("creator_profiles").select("*").eq("user_id",e).maybeSingle();if(r)throw r;return t||null},x=async e=>{let{data:t,error:r}=await s.supabase.from("orders").select("*, tickets(*)").eq("event_id",e).eq("payment_status","paid");if(r)throw r;let{data:n,error:a}=await s.supabase.from("tickets").select("*, ticket_type:ticket_types(*)").eq("event_id",e);if(a)throw a;return{orders:t||[],tickets:n||[]}}},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(1994),n=r(3335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}}},function(e){e.O(0,[182,972,730,713,971,117,560],function(){return e(e.s=8932)}),_N_E=e.O()}]);