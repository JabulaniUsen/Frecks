(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[232],{6472:function(e,t,r){Promise.resolve().then(r.bind(r,7297))},7297:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var s=r(7437),a=r(2265),i=r(9376),l=r(9501),n=r(3590),o=r(7119),c=r(1770),d=r(2381),m=r(279),u=r(5060),x=r(3675),h=r(4362),p=r(1980),g=r(5526),f=r(2660),j=r(2489),v=r(1817),y=r(3113),N=r(6858),_=r(401),b=r(7648),k=r(4014),w=r(4438),S=r(767);let E={EVENT_FORM:"frecks_event_form_draft",TICKET_FORM:"frecks_ticket_form_draft",BENEFITS_FORM:"frecks_benefits_form_draft",IMAGE_PREVIEW:"frecks_image_preview_draft",CURRENT_STEP:"frecks_create_event_step"},I=["Concert","Sports","Party","Comedy","Film","Workshop","Conference","Festival","Other"],T=o.Ry({title:o.Z_().min(3,"Title must be at least 3 characters"),description:o.Z_().min(10,"Description must be at least 10 characters"),category:o.Z_().min(1,"Please select a category"),image:o.Yj().optional(),is_online:o.O7().default(!1),location:o.Z_().min(3,"Location is required"),start_date:o.Z_().min(1,"Start date is required"),start_time:o.Z_().min(1,"Start time is required"),end_date:o.Z_().optional(),end_time:o.Z_().optional()});function F(){let e=(0,i.useRouter)(),{profile:t,user:r}=(0,h.a)(),o=(()=>{try{let e=localStorage.getItem(E.CURRENT_STEP),t=localStorage.getItem(E.EVENT_FORM),r=localStorage.getItem(E.TICKET_FORM),s=localStorage.getItem(E.BENEFITS_FORM),a=localStorage.getItem(E.IMAGE_PREVIEW);return{step:e?parseInt(e):1,eventForm:t?JSON.parse(t):null,ticketForm:r?JSON.parse(r):null,benefitsForm:s?JSON.parse(s):null,imagePreview:a}}catch(e){return console.error("Error loading saved data:",e),null}})(),[F,R]=(0,a.useState)((null==o?void 0:o.step)||1),[O,C]=(0,a.useState)((null==o?void 0:o.imagePreview)||null),[P,D]=(0,a.useState)(!1),[M,V]=(0,a.useState)(!1),[U,q]=(0,a.useState)(!1),[A,Z]=(0,a.useState)(!1),[z,L]=(0,a.useState)(!1),B=(0,l.cI)({resolver:(0,n.F)(T),defaultValues:(null==o?void 0:o.eventForm)||{is_online:!1,end_date:"",end_time:""}}),Y=(0,l.cI)({defaultValues:(null==o?void 0:o.ticketForm)||{ticket_types:[{name:"",price:0,quantity:100}]}}),{fields:G,append:W,remove:J}=(0,l.Dq)({control:Y.control,name:"ticket_types"}),$=(0,l.cI)({defaultValues:(null==o?void 0:o.benefitsForm)||{ticket_types:[]}}),K=B.watch(),Q=Y.watch("ticket_types"),H=$.watch("ticket_types");(0,a.useEffect)(()=>{try{let e=B.getValues(),t=Y.getValues(),r=$.getValues();(e.title||e.description||e.category)&&localStorage.setItem(E.EVENT_FORM,JSON.stringify(e)),t.ticket_types&&t.ticket_types.length>0&&localStorage.setItem(E.TICKET_FORM,JSON.stringify(t)),r.ticket_types&&r.ticket_types.length>0&&localStorage.setItem(E.BENEFITS_FORM,JSON.stringify(r)),O?localStorage.setItem(E.IMAGE_PREVIEW,O):localStorage.removeItem(E.IMAGE_PREVIEW),localStorage.setItem(E.CURRENT_STEP,F.toString())}catch(e){console.error("Error saving to localStorage:",e)}},[K,Q,H,O,F,B,Y,$]);let X=()=>{try{localStorage.removeItem(E.EVENT_FORM),localStorage.removeItem(E.TICKET_FORM),localStorage.removeItem(E.BENEFITS_FORM),localStorage.removeItem(E.IMAGE_PREVIEW),localStorage.removeItem(E.CURRENT_STEP)}catch(e){console.error("Error clearing localStorage:",e)}};(0,a.useEffect)(()=>{o&&(o.eventForm||o.ticketForm||o.benefitsForm)&&V(!0)},[]);let ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.85;return new Promise((s,a)=>{let i=new FileReader;i.readAsDataURL(e),i.onload=i=>{var l;let n=new Image;n.src=null===(l=i.target)||void 0===l?void 0:l.result,n.onload=()=>{let i=document.createElement("canvas"),l=n.width,o=n.height;l>t&&(o=o*t/l,l=t),i.width=l,i.height=o;let c=i.getContext("2d");if(!c){a(Error("Failed to get canvas context"));return}c.drawImage(n,0,0,l,o),i.toBlob(t=>{if(!t){a(Error("Failed to compress image"));return}s(new File([t],e.name,{type:"image/jpeg",lastModified:Date.now()}))},"image/jpeg",r)},n.onerror=()=>a(Error("Failed to load image"))},i.onerror=()=>a(Error("Failed to read file"))})},et=async e=>{if(!r)throw Error("User not authenticated");try{let a=await ee(e),i="".concat(r.id,"/").concat(Date.now(),".").concat("jpg");console.log("Uploading image to storage bucket:",i);let{data:l,error:n}=await g.supabase.storage.from("event-images").upload(i,a,{cacheControl:"3600",upsert:!1});if(n){var t,s;if(console.error("Storage upload error:",n),null===(t=n.message)||void 0===t?void 0:t.includes("Bucket not found"))throw Error('Storage bucket "event-images" not found. Please create it in your Supabase dashboard.');if(null===(s=n.message)||void 0===s?void 0:s.includes("new row violates row-level security"))throw Error("Permission denied. Please check storage bucket policies.");throw Error("Image upload failed: ".concat(n.message))}if(!l)throw Error("Upload succeeded but no data returned");console.log("Upload successful, getting public URL...");let{data:o}=g.supabase.storage.from("event-images").getPublicUrl(i);if(!(null==o?void 0:o.publicUrl))throw Error("Failed to get public URL for uploaded image");return console.log("Image URL generated:",o.publicUrl),o.publicUrl}catch(e){throw console.error("Upload image error:",e),e}},er=(0,c.D)({mutationFn:async()=>{let e;if(!r||!t)throw Error("User not authenticated");let s=B.getValues("image");if(s){D(!0);try{e=await et(s),console.log("Image uploaded successfully:",e)}catch(e){throw console.error("Image upload error:",e),D(!1),Error("Failed to upload image: ".concat(e.message||"Unknown error",". Please try again or create the event without an image."))}finally{D(!1)}}let a=new Date("".concat(K.start_date,"T").concat(K.start_time)),i=K.is_online?"Online - ".concat(K.location):K.location,l=Q.map((e,t)=>{var r;return{name:e.name,price:e.price,quantity:e.quantity,description:(null===(r=H[t])||void 0===r?void 0:r.description)||"",is_free:0===e.price}}),n=await (0,p.yM)({creator_id:r.id,title:K.title,description:K.description,category:K.category,image_url:e,date:a.toISOString(),location:i,ticket_types:l});if(!n)throw Error("Event creation returned no data");return n},onSuccess:t=>{X(),e.push("/dashboard/creator?created=".concat(t.id))},onError:e=>{var t;let r=(null==e?void 0:e.message)||(null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to create event. Please try again.";w.Am.error("Failed to create event",{description:r}),D(!1)}}),es=async()=>{var e,t;if(1===F){if(!await B.trigger()){let t=Object.keys(B.formState.errors)[0];t&&(null===(e=document.querySelector('[name="'.concat(t,'"]')))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}));return}R(e=>Math.min(e+1,4));return}if(2===F){if(!await Y.trigger()){let e=Y.formState.errors.ticket_types;if(e){let r=Object.keys(e)[0];null===(t=document.querySelector('[name="ticket_types.'.concat(r,'"]')))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"})}return}let e=Y.getValues("ticket_types");$.reset({ticket_types:e.map(e=>({name:e.name,price:e.price,quantity:e.quantity,description:""}))}),R(e=>Math.min(e+1,4));return}if(3===F){R(e=>Math.min(e+1,4));return}},ea=async()=>{let e=await B.trigger(),t=await Y.trigger();if(!e||!t){q(!0);return}await er.mutateAsync()};return r&&t&&"creator"===t.role?(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)("div",{className:"border-b border-border bg-card sticky top-0 z-10",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(b.default,{href:"/dashboard/creator",children:(0,s.jsx)(d.z,{variant:"ghost",size:"icon",children:(0,s.jsx)(f.Z,{className:"w-5 h-5"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Create New Event"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Step ",F," of 4"]})]})]}),(0,s.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>{Z(!0)},children:"Clear Draft"})]}),(0,s.jsx)("div",{className:"mt-4 flex gap-2",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:"flex-1 h-2 rounded-full transition-colors ".concat(e<=F?"bg-primary":"bg-muted")},e))})]})}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[1===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Event Details"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tell us about your event. You can edit this later."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Event Image"}),(0,s.jsx)("div",{className:"mt-2",children:O?(0,s.jsxs)("div",{className:"relative w-full h-64 rounded-lg overflow-hidden border border-border",children:[(0,s.jsx)("img",{src:O,alt:"Event preview",className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>{C(null),B.setValue("image",void 0)},className:"absolute top-2 right-2 p-2 bg-background/80 rounded-full hover:bg-background",disabled:P,children:(0,s.jsx)(j.Z,{className:"w-4 h-4"})}),P&&(0,s.jsx)("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(v.Z,{className:"w-6 h-6 animate-spin text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Uploading image..."})]})})]}):(0,s.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,s.jsx)(y.Z,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,s.jsxs)("p",{className:"mb-2 text-sm text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, GIF up to 5MB"})]}),(0,s.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(!r.type.startsWith("image/")){B.setError("image",{message:"Please upload an image file"});return}if(r.size>5242880){B.setError("image",{message:"Image must be less than 5MB"});return}B.setValue("image",r),B.clearErrors("image");let e=new FileReader;e.onloadend=()=>{C(e.result)},e.readAsDataURL(r)}}})]})}),B.formState.errors.image&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.image.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"title",children:"Event Title *"}),(0,s.jsx)(m.I,{id:"title",...B.register("title"),placeholder:"e.g., Spring Fest 2026",className:"mt-2"}),B.formState.errors.title&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.title.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"description",children:"Description *"}),(0,s.jsx)(x.g,{id:"description",...B.register("description"),placeholder:"Describe your event in detail...",rows:6,className:"mt-2"}),B.formState.errors.description&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.description.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"category",children:"Category *"}),(0,s.jsxs)("select",{id:"category",...B.register("category"),className:"mt-2 w-full px-3 py-2 rounded-lg border border-border bg-background",children:[(0,s.jsx)("option",{value:"",children:"Select a category"}),I.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),B.formState.errors.category&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.category.message)})]}),(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsxs)(u._,{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...B.register("is_online"),className:"w-4 h-4"}),(0,s.jsx)("span",{children:"This is an online event"})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"location",children:K.is_online?"Online Event Link/Platform *":"Location *"}),(0,s.jsx)(m.I,{id:"location",...B.register("location"),placeholder:K.is_online?"e.g., Zoom, Google Meet, or event link":"e.g., Main Campus Amphitheater",className:"mt-2"}),B.formState.errors.location&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.location.message)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"start_date",children:"Start Date *"}),(0,s.jsx)(m.I,{id:"start_date",type:"date",...B.register("start_date"),className:"mt-2",min:new Date().toISOString().split("T")[0]}),B.formState.errors.start_date&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.start_date.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"start_time",children:"Start Time *"}),(0,s.jsx)(m.I,{id:"start_time",type:"time",...B.register("start_time"),className:"mt-2"}),B.formState.errors.start_time&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.start_time.message)})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"end_date",children:"End Date (Optional)"}),(0,s.jsx)(m.I,{id:"end_date",type:"date",...B.register("end_date"),className:"mt-2",min:K.start_date||new Date().toISOString().split("T")[0]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"end_time",children:"End Time (Optional)"}),(0,s.jsx)(m.I,{id:"end_time",type:"time",...B.register("end_time"),className:"mt-2"})]})]})]})]}),2===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Types"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set up your ticket types and pricing. You can add multiple ticket types."}),Object.keys(Y.formState.errors).length>0&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-destructive/10 text-destructive rounded-lg text-sm",children:"Please fix the errors below before proceeding."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[G.map((e,t)=>{var r,a,i,l,n,o,c,x,h,p,g,f;return(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["Ticket Type ",t+1]}),G.length>1&&(0,s.jsx)(d.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>J(t),children:(0,s.jsx)(j.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Ticket Name *"}),(0,s.jsx)(m.I,{...Y.register("ticket_types.".concat(t,".name")),placeholder:"e.g., General Admission, VIP, Early Bird",className:"mt-2"}),(null===(a=Y.formState.errors.ticket_types)||void 0===a?void 0:null===(r=a[t])||void 0===r?void 0:r.name)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(l=Y.formState.errors.ticket_types[t])||void 0===l?void 0:null===(i=l.name)||void 0===i?void 0:i.message)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Price (₦) *"}),(0,s.jsx)(m.I,{type:"number",step:"0.01",min:"0",...Y.register("ticket_types.".concat(t,".price"),{valueAsNumber:!0}),placeholder:"0.00",className:"mt-2"}),(null===(o=Y.formState.errors.ticket_types)||void 0===o?void 0:null===(n=o[t])||void 0===n?void 0:n.price)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(x=Y.formState.errors.ticket_types[t])||void 0===x?void 0:null===(c=x.price)||void 0===c?void 0:c.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Quantity *"}),(0,s.jsx)(m.I,{type:"number",min:"1",...Y.register("ticket_types.".concat(t,".quantity"),{valueAsNumber:!0}),placeholder:"100",className:"mt-2"}),(null===(p=Y.formState.errors.ticket_types)||void 0===p?void 0:null===(h=p[t])||void 0===h?void 0:h.quantity)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(f=Y.formState.errors.ticket_types[t])||void 0===f?void 0:null===(g=f.quantity)||void 0===g?void 0:g.message)})]})]})]},e.id)}),(0,s.jsx)(d.z,{type:"button",variant:"outline",onClick:()=>W({name:"",price:0,quantity:100}),className:"w-full",children:"+ Add Another Ticket Type"})]})]}),3===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Benefits (Optional)"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add benefits or details for each ticket type. This is optional."})]}),(0,s.jsx)("div",{className:"space-y-6",children:$.watch("ticket_types").length>0?$.watch("ticket_types").map((e,t)=>(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold mb-4",children:e.name||"Ticket Type ".concat(t+1)}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Benefits/Description (Optional)"}),(0,s.jsx)(x.g,{...$.register("ticket_types.".concat(t,".description")),placeholder:"e.g., Access to VIP area, Free drinks, Early entry...",rows:4,className:"mt-2"})]})]},t)):(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No ticket types found. Please go back to Step 2 and add ticket types."})})]}),4===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Preview Event"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review your event details before publishing."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[O&&(0,s.jsx)("div",{className:"w-full h-64 rounded-lg overflow-hidden border border-border",children:(0,s.jsx)("img",{src:O,alt:K.title,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-2xl font-bold",children:K.title}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:K.category})]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:K.description})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-border",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Location"}),(0,s.jsx)("p",{className:"font-medium",children:K.location})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Start Date & Time"}),(0,s.jsx)("p",{className:"font-medium",children:K.start_date&&K.start_time?(0,k.WU)(new Date("".concat(K.start_date,"T").concat(K.start_time)),"MMM d, yyyy • h:mm a"):"Not set"})]}),K.end_date&&K.end_time&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"End Date & Time"}),(0,s.jsx)("p",{className:"font-medium",children:(0,k.WU)(new Date("".concat(K.end_date,"T").concat(K.end_time)),"MMM d, yyyy • h:mm a")})]})]})]}),(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Ticket Types"}),Q.map((e,t)=>{var r;return(0,s.jsx)("div",{className:"p-4 bg-muted rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(null===(r=H[t])||void 0===r?void 0:r.description)&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:H[t].description})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"font-bold",children:0===e.price?"Free":"₦".concat(e.price.toLocaleString())}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.quantity," tickets"]})]})]})},t)})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-border",children:[(0,s.jsxs)(d.z,{type:"button",variant:"outline",onClick:()=>{R(e=>Math.max(e-1,1))},disabled:1===F,children:[(0,s.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Previous"]}),F<4?(0,s.jsxs)(d.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),es()},variant:"hero",children:["Next",(0,s.jsx)(N.Z,{className:"w-4 h-4 ml-2"})]}):(0,s.jsx)(d.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),ea()},variant:"hero",disabled:er.isPending||P,children:er.isPending||P?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Z,{className:"w-4 h-4 mr-2 animate-spin"}),P?"Uploading image...":"Creating event..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Create Event"]})})]})]}),(0,s.jsx)(S.aR,{open:M,onOpenChange:V,children:(0,s.jsxs)(S._T,{children:[(0,s.jsxs)(S.fY,{children:[(0,s.jsx)(S.f$,{children:"Restore Draft?"}),(0,s.jsxs)(S.yT,{children:["You have a saved draft. Would you like to restore it?",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Note:"})," If you had an image selected, you'll need to select it again."]})]}),(0,s.jsxs)(S.xo,{children:[(0,s.jsx)(S.le,{onClick:()=>{V(!1),X(),B.reset({is_online:!1,end_date:"",end_time:""}),Y.reset({ticket_types:[{name:"",price:0,quantity:100}]}),$.reset({ticket_types:[]}),C(null),R(1)},children:"Discard Draft"}),(0,s.jsx)(S.OL,{onClick:()=>{V(!1),(null==o?void 0:o.imagePreview)&&C(o.imagePreview)},children:"Restore Draft"})]})]})}),(0,s.jsx)(S.aR,{open:U,onOpenChange:q,children:(0,s.jsxs)(S._T,{children:[(0,s.jsxs)(S.fY,{children:[(0,s.jsx)(S.f$,{children:"Form Validation Error"}),(0,s.jsx)(S.yT,{children:"Please fix all errors before creating the event."})]}),(0,s.jsx)(S.xo,{children:(0,s.jsx)(S.OL,{onClick:()=>q(!1),children:"OK"})})]})}),(0,s.jsx)(S.aR,{open:A,onOpenChange:Z,children:(0,s.jsxs)(S._T,{children:[(0,s.jsxs)(S.fY,{children:[(0,s.jsx)(S.f$,{children:"Clear Draft?"}),(0,s.jsx)(S.yT,{children:"Are you sure you want to clear all saved draft data? This cannot be undone."})]}),(0,s.jsxs)(S.xo,{children:[(0,s.jsx)(S.le,{children:"Cancel"}),(0,s.jsx)(S.OL,{onClick:()=>{X(),B.reset({is_online:!1,end_date:"",end_time:""}),Y.reset({ticket_types:[{name:"",price:0,quantity:100}]}),$.reset({ticket_types:[]}),C(null),R(1),Z(!1),L(!0)},children:"Clear Draft"})]})]})}),(0,s.jsx)(S.aR,{open:z,onOpenChange:L,children:(0,s.jsxs)(S._T,{children:[(0,s.jsxs)(S.fY,{children:[(0,s.jsx)(S.f$,{children:"Draft Cleared"}),(0,s.jsx)(S.yT,{children:"Draft cleared successfully"})]}),(0,s.jsx)(S.xo,{children:(0,s.jsx)(S.OL,{onClick:()=>L(!1),children:"OK"})})]})})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"mb-2",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Only creators can create events."})]})})}o.Ry({name:o.Z_().min(1,"Ticket name is required"),price:o.Rx().min(0,"Price must be 0 or greater"),quantity:o.Rx().min(1,"Quantity must be at least 1")}),o.Ry({ticket_types:o.IX(o.Ry({name:o.Z_(),price:o.Rx(),quantity:o.Rx(),description:o.Z_().optional()}))})},767:function(e,t,r){"use strict";r.d(t,{OL:function(){return g},_T:function(){return m},aR:function(){return o},f$:function(){return h},fY:function(){return u},le:function(){return f},xo:function(){return x},yT:function(){return p}});var s=r(7437),a=r(2265),i=r(277),l=r(3448),n=r(2381);let o=i.fC;i.xz;let c=i.h_,d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(i.aV,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...a,ref:t})});d.displayName=i.aV.displayName;let m=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(d,{}),(0,s.jsx)(i.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...a})]})});m.displayName=i.VY.displayName;let u=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};u.displayName="AlertDialogHeader";let x=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};x.displayName="AlertDialogFooter";let h=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(i.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold",r),...a})});h.displayName=i.Dx.displayName;let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(i.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})});p.displayName=i.dk.displayName;let g=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(i.aU,{ref:t,className:(0,l.cn)((0,n.d)(),r),...a})});g.displayName=i.aU.displayName;let f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(i.$j,{ref:t,className:(0,l.cn)((0,n.d)({variant:"outline"}),"mt-2 sm:mt-0",r),...a})});f.displayName=i.$j.displayName}},function(e){e.O(0,[182,972,506,850,730,438,818,214,817,971,117,560],function(){return e(e.s=6472)}),_N_E=e.O()}]);