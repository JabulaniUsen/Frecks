(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7232],{76472:function(e,t,r){Promise.resolve().then(r.bind(r,97297))},97297:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var s=r(57437),i=r(2265),a=r(99376),n=r(29501),l=r(13590),o=r(67119),c=r(21770),d=r(12381),m=r(40279),u=r(75060),h=r(23675),x=r(14362),g=r(61980),p=r(5526),v=r(32660),f=r(32489),j=r(51817),b=r(53113),y=r(76858),_=r(30401),N=r(27648),S=r(64014),w=r(14438),k=r(30767);let E={EVENT_FORM:"frecks_event_form_draft",TICKET_FORM:"frecks_ticket_form_draft",BENEFITS_FORM:"frecks_benefits_form_draft",IMAGE_PREVIEW:"frecks_image_preview_draft",CURRENT_STEP:"frecks_create_event_step"},I=["Concert","Sports","Party","Comedy","Film","Workshop","Conference","Festival","Other"],T=o.Ry({title:o.Z_().min(3,"Title must be at least 3 characters"),description:o.Z_().min(10,"Description must be at least 10 characters"),category:o.Z_().min(1,"Please select a category"),image:o.Yj().optional(),is_online:o.O7().default(!1),location:o.Z_().min(3,"Location is required"),start_date:o.Z_().min(1,"Start date is required"),start_time:o.Z_().min(1,"Start time is required"),end_date:o.Z_().optional(),end_time:o.Z_().optional()});function F(){let e=(0,a.useRouter)(),{profile:t,user:r}=(0,x.a)(),o=(()=>{try{let e=localStorage.getItem(E.CURRENT_STEP),t=localStorage.getItem(E.EVENT_FORM),r=localStorage.getItem(E.TICKET_FORM),s=localStorage.getItem(E.BENEFITS_FORM),i=localStorage.getItem(E.IMAGE_PREVIEW);return{step:e?parseInt(e):1,eventForm:t?JSON.parse(t):null,ticketForm:r?JSON.parse(r):null,benefitsForm:s?JSON.parse(s):null,imagePreview:i}}catch(e){return console.error("Error loading saved data:",e),null}})(),[F,C]=(0,i.useState)((null==o?void 0:o.step)||1),[R,O]=(0,i.useState)((null==o?void 0:o.imagePreview)||null),[P,M]=(0,i.useState)(!1),[D,U]=(0,i.useState)(!1),[A,V]=(0,i.useState)(!1),[Z,q]=(0,i.useState)(!1),[z,L]=(0,i.useState)(!1),B=(0,n.cI)({resolver:(0,l.F)(T),defaultValues:(null==o?void 0:o.eventForm)||{is_online:!1,end_date:"",end_time:""}}),J=(0,n.cI)({defaultValues:(null==o?void 0:o.ticketForm)||{ticket_types:[{name:"",price:0,quantity:100}]}}),{fields:G,append:W,remove:Y}=(0,n.Dq)({control:J.control,name:"ticket_types"}),K=(0,n.cI)({defaultValues:(null==o?void 0:o.benefitsForm)||{ticket_types:[]}}),X=B.watch(),$=J.watch("ticket_types"),H=K.watch("ticket_types");(0,i.useEffect)(()=>{try{let e=B.getValues(),t=J.getValues(),r=K.getValues();(e.title||e.description||e.category)&&localStorage.setItem(E.EVENT_FORM,JSON.stringify(e)),t.ticket_types&&t.ticket_types.length>0&&localStorage.setItem(E.TICKET_FORM,JSON.stringify(t)),r.ticket_types&&r.ticket_types.length>0&&localStorage.setItem(E.BENEFITS_FORM,JSON.stringify(r)),R?localStorage.setItem(E.IMAGE_PREVIEW,R):localStorage.removeItem(E.IMAGE_PREVIEW),localStorage.setItem(E.CURRENT_STEP,F.toString())}catch(e){console.error("Error saving to localStorage:",e)}},[X,$,H,R,F,B,J,K]);let Q=()=>{try{localStorage.removeItem(E.EVENT_FORM),localStorage.removeItem(E.TICKET_FORM),localStorage.removeItem(E.BENEFITS_FORM),localStorage.removeItem(E.IMAGE_PREVIEW),localStorage.removeItem(E.CURRENT_STEP)}catch(e){console.error("Error clearing localStorage:",e)}};(0,i.useEffect)(()=>{o&&(o.eventForm||o.ticketForm||o.benefitsForm)&&U(!0)},[]);let ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.85;return new Promise((s,i)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=a=>{var n;let l=new Image;l.src=null===(n=a.target)||void 0===n?void 0:n.result,l.onload=()=>{let a=document.createElement("canvas"),n=l.width,o=l.height;n>t&&(o=o*t/n,n=t),a.width=n,a.height=o;let c=a.getContext("2d");if(!c){i(Error("Failed to get canvas context"));return}c.drawImage(l,0,0,n,o),a.toBlob(t=>{if(!t){i(Error("Failed to compress image"));return}s(new File([t],e.name,{type:"image/jpeg",lastModified:Date.now()}))},"image/jpeg",r)},l.onerror=()=>i(Error("Failed to load image"))},a.onerror=()=>i(Error("Failed to read file"))})},et=async e=>{if(!r)throw Error("User not authenticated");try{let i=await ee(e),a="".concat(r.id,"/").concat(Date.now(),".").concat("jpg");console.log("Uploading image to storage bucket:",a);let{data:n,error:l}=await p.supabase.storage.from("event-images").upload(a,i,{cacheControl:"3600",upsert:!1});if(l){var t,s;if(console.error("Storage upload error:",l),null===(t=l.message)||void 0===t?void 0:t.includes("Bucket not found"))throw Error('Storage bucket "event-images" not found. Please create it in your Supabase dashboard.');if(null===(s=l.message)||void 0===s?void 0:s.includes("new row violates row-level security"))throw Error("Permission denied. Please check storage bucket policies.");throw Error("Image upload failed: ".concat(l.message))}if(!n)throw Error("Upload succeeded but no data returned");console.log("Upload successful, getting public URL...");let{data:o}=p.supabase.storage.from("event-images").getPublicUrl(a);if(!(null==o?void 0:o.publicUrl))throw Error("Failed to get public URL for uploaded image");return console.log("Image URL generated:",o.publicUrl),o.publicUrl}catch(e){throw console.error("Upload image error:",e),e}},er=(0,c.D)({mutationFn:async()=>{let e;if(!r||!t)throw Error("User not authenticated");let s=B.getValues("image");if(s){M(!0);try{e=await et(s),console.log("Image uploaded successfully:",e)}catch(e){throw console.error("Image upload error:",e),M(!1),Error("Failed to upload image: ".concat(e.message||"Unknown error",". Please try again or create the event without an image."))}finally{M(!1)}}let i=new Date("".concat(X.start_date,"T").concat(X.start_time)),a=X.is_online?"Online - ".concat(X.location):X.location,n=$.map((e,t)=>{var r;return{name:e.name,price:e.price,quantity:e.quantity,description:(null===(r=H[t])||void 0===r?void 0:r.description)||"",is_free:0===e.price}}),l=await (0,g.yM)({creator_id:r.id,title:X.title,description:X.description,category:X.category,image_url:e,date:i.toISOString(),location:a,ticket_types:n});if(!l)throw Error("Event creation returned no data");return l},onSuccess:t=>{Q(),e.push("/dashboard/creator?created=".concat(t.id))},onError:e=>{var t;let r=(null==e?void 0:e.message)||(null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to create event. Please try again.";w.Am.error("Failed to create event",{description:r}),M(!1)}}),es=async()=>{var e,t;if(1===F){if(!await B.trigger()){let t=Object.keys(B.formState.errors)[0];t&&(null===(e=document.querySelector('[name="'.concat(t,'"]')))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}));return}C(e=>Math.min(e+1,4));return}if(2===F){if(!await J.trigger()){let e=J.formState.errors.ticket_types;if(e){let r=Object.keys(e)[0];null===(t=document.querySelector('[name="ticket_types.'.concat(r,'"]')))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"})}return}let e=J.getValues("ticket_types");K.reset({ticket_types:e.map(e=>({name:e.name,price:e.price,quantity:e.quantity,description:""}))}),C(e=>Math.min(e+1,4));return}if(3===F){C(e=>Math.min(e+1,4));return}},ei=async()=>{let e=await B.trigger(),t=await J.trigger();if(!e||!t){V(!0);return}await er.mutateAsync()};return r&&t&&"creator"===t.role?(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)("div",{className:"border-b border-border bg-card sticky top-0 z-10",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(N.default,{href:"/dashboard/creator",children:(0,s.jsx)(d.z,{variant:"ghost",size:"icon",children:(0,s.jsx)(v.Z,{className:"w-5 h-5"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Create New Event"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Step ",F," of 4"]})]})]}),(0,s.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>{q(!0)},children:"Clear Draft"})]}),(0,s.jsx)("div",{className:"mt-4 flex gap-2",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:"flex-1 h-2 rounded-full transition-colors ".concat(e<=F?"bg-primary":"bg-muted")},e))})]})}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[1===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Event Details"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tell us about your event. You can edit this later."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Event Image"}),(0,s.jsx)("div",{className:"mt-2",children:R?(0,s.jsxs)("div",{className:"relative w-full h-64 rounded-lg overflow-hidden border border-border",children:[(0,s.jsx)("img",{src:R,alt:"Event preview",className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>{O(null),B.setValue("image",void 0)},className:"absolute top-2 right-2 p-2 bg-background/80 rounded-full hover:bg-background",disabled:P,children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})}),P&&(0,s.jsx)("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(j.Z,{className:"w-6 h-6 animate-spin text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Uploading image..."})]})})]}):(0,s.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,s.jsx)(b.Z,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,s.jsxs)("p",{className:"mb-2 text-sm text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, GIF up to 5MB"})]}),(0,s.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(!r.type.startsWith("image/")){B.setError("image",{message:"Please upload an image file"});return}if(r.size>5242880){B.setError("image",{message:"Image must be less than 5MB"});return}B.setValue("image",r),B.clearErrors("image");let e=new FileReader;e.onloadend=()=>{O(e.result)},e.readAsDataURL(r)}}})]})}),B.formState.errors.image&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.image.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"title",children:"Event Title *"}),(0,s.jsx)(m.I,{id:"title",...B.register("title"),placeholder:"e.g., Spring Fest 2026",className:"mt-2"}),B.formState.errors.title&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.title.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"description",children:"Description *"}),(0,s.jsx)(h.g,{id:"description",...B.register("description"),placeholder:"Describe your event in detail...",rows:6,className:"mt-2"}),B.formState.errors.description&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.description.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"category",children:"Category *"}),(0,s.jsxs)("select",{id:"category",...B.register("category"),className:"mt-2 w-full px-3 py-2 rounded-lg border border-border bg-background",children:[(0,s.jsx)("option",{value:"",children:"Select a category"}),I.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),B.formState.errors.category&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.category.message)})]}),(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsxs)(u._,{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...B.register("is_online"),className:"w-4 h-4"}),(0,s.jsx)("span",{children:"This is an online event"})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"location",children:X.is_online?"Online Event Link/Platform *":"Location *"}),(0,s.jsx)(m.I,{id:"location",...B.register("location"),placeholder:X.is_online?"e.g., Zoom, Google Meet, or event link":"e.g., Main Campus Amphitheater",className:"mt-2"}),B.formState.errors.location&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.location.message)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"start_date",children:"Start Date *"}),(0,s.jsx)(m.I,{id:"start_date",type:"date",...B.register("start_date"),className:"mt-2",min:new Date().toISOString().split("T")[0]}),B.formState.errors.start_date&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.start_date.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"start_time",children:"Start Time *"}),(0,s.jsx)(m.I,{id:"start_time",type:"time",...B.register("start_time"),className:"mt-2"}),B.formState.errors.start_time&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(B.formState.errors.start_time.message)})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"end_date",children:"End Date (Optional)"}),(0,s.jsx)(m.I,{id:"end_date",type:"date",...B.register("end_date"),className:"mt-2",min:X.start_date||new Date().toISOString().split("T")[0]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"end_time",children:"End Time (Optional)"}),(0,s.jsx)(m.I,{id:"end_time",type:"time",...B.register("end_time"),className:"mt-2"})]})]})]})]}),2===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Types"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set up your ticket types and pricing. You can add multiple ticket types."}),Object.keys(J.formState.errors).length>0&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-destructive/10 text-destructive rounded-lg text-sm",children:"Please fix the errors below before proceeding."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[G.map((e,t)=>{var r,i,a,n,l,o,c,h,x,g,p,v;return(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["Ticket Type ",t+1]}),G.length>1&&(0,s.jsx)(d.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>Y(t),children:(0,s.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Ticket Name *"}),(0,s.jsx)(m.I,{...J.register("ticket_types.".concat(t,".name")),placeholder:"e.g., General Admission, VIP, Early Bird",className:"mt-2"}),(null===(i=J.formState.errors.ticket_types)||void 0===i?void 0:null===(r=i[t])||void 0===r?void 0:r.name)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(n=J.formState.errors.ticket_types[t])||void 0===n?void 0:null===(a=n.name)||void 0===a?void 0:a.message)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Price (₦) *"}),(0,s.jsx)(m.I,{type:"number",step:"0.01",min:"0",...J.register("ticket_types.".concat(t,".price"),{valueAsNumber:!0}),placeholder:"0.00",className:"mt-2"}),(null===(o=J.formState.errors.ticket_types)||void 0===o?void 0:null===(l=o[t])||void 0===l?void 0:l.price)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(h=J.formState.errors.ticket_types[t])||void 0===h?void 0:null===(c=h.price)||void 0===c?void 0:c.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Quantity *"}),(0,s.jsx)(m.I,{type:"number",min:"1",...J.register("ticket_types.".concat(t,".quantity"),{valueAsNumber:!0}),placeholder:"100",className:"mt-2"}),(null===(g=J.formState.errors.ticket_types)||void 0===g?void 0:null===(x=g[t])||void 0===x?void 0:x.quantity)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(v=J.formState.errors.ticket_types[t])||void 0===v?void 0:null===(p=v.quantity)||void 0===p?void 0:p.message)})]})]})]},e.id)}),(0,s.jsx)(d.z,{type:"button",variant:"outline",onClick:()=>W({name:"",price:0,quantity:100}),className:"w-full",children:"+ Add Another Ticket Type"})]})]}),3===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Benefits (Optional)"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add benefits or details for each ticket type. This is optional."})]}),(0,s.jsx)("div",{className:"space-y-6",children:K.watch("ticket_types").length>0?K.watch("ticket_types").map((e,t)=>(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold mb-4",children:e.name||"Ticket Type ".concat(t+1)}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"Benefits/Description (Optional)"}),(0,s.jsx)(h.g,{...K.register("ticket_types.".concat(t,".description")),placeholder:"e.g., Access to VIP area, Free drinks, Early entry...",rows:4,className:"mt-2"})]})]},t)):(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No ticket types found. Please go back to Step 2 and add ticket types."})})]}),4===F&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Preview Event"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review your event details before publishing."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[R&&(0,s.jsx)("div",{className:"w-full h-64 rounded-lg overflow-hidden border border-border",children:(0,s.jsx)("img",{src:R,alt:X.title,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-2xl font-bold",children:X.title}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:X.category})]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:X.description})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-border",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Location"}),(0,s.jsx)("p",{className:"font-medium",children:X.location})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Start Date & Time"}),(0,s.jsx)("p",{className:"font-medium",children:X.start_date&&X.start_time?(0,S.WU)(new Date("".concat(X.start_date,"T").concat(X.start_time)),"MMM d, yyyy • h:mm a"):"Not set"})]}),X.end_date&&X.end_time&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"End Date & Time"}),(0,s.jsx)("p",{className:"font-medium",children:(0,S.WU)(new Date("".concat(X.end_date,"T").concat(X.end_time)),"MMM d, yyyy • h:mm a")})]})]})]}),(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Ticket Types"}),$.map((e,t)=>{var r;return(0,s.jsx)("div",{className:"p-4 bg-muted rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(null===(r=H[t])||void 0===r?void 0:r.description)&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:H[t].description})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"font-bold",children:0===e.price?"Free":"₦".concat(e.price.toLocaleString())}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.quantity," tickets"]})]})]})},t)})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-border",children:[(0,s.jsxs)(d.z,{type:"button",variant:"outline",onClick:()=>{C(e=>Math.max(e-1,1))},disabled:1===F,children:[(0,s.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Previous"]}),F<4?(0,s.jsxs)(d.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),es()},variant:"hero",children:["Next",(0,s.jsx)(y.Z,{className:"w-4 h-4 ml-2"})]}):(0,s.jsx)(d.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),ei()},variant:"hero",disabled:er.isPending||P,children:er.isPending||P?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Z,{className:"w-4 h-4 mr-2 animate-spin"}),P?"Uploading image...":"Creating event..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Create Event"]})})]})]}),(0,s.jsx)(k.aR,{open:D,onOpenChange:U,children:(0,s.jsxs)(k._T,{children:[(0,s.jsxs)(k.fY,{children:[(0,s.jsx)(k.f$,{children:"Restore Draft?"}),(0,s.jsxs)(k.yT,{children:["You have a saved draft. Would you like to restore it?",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Note:"})," If you had an image selected, you'll need to select it again."]})]}),(0,s.jsxs)(k.xo,{children:[(0,s.jsx)(k.le,{onClick:()=>{U(!1),Q(),B.reset({is_online:!1,end_date:"",end_time:""}),J.reset({ticket_types:[{name:"",price:0,quantity:100}]}),K.reset({ticket_types:[]}),O(null),C(1)},children:"Discard Draft"}),(0,s.jsx)(k.OL,{onClick:()=>{U(!1),(null==o?void 0:o.imagePreview)&&O(o.imagePreview)},children:"Restore Draft"})]})]})}),(0,s.jsx)(k.aR,{open:A,onOpenChange:V,children:(0,s.jsxs)(k._T,{children:[(0,s.jsxs)(k.fY,{children:[(0,s.jsx)(k.f$,{children:"Form Validation Error"}),(0,s.jsx)(k.yT,{children:"Please fix all errors before creating the event."})]}),(0,s.jsx)(k.xo,{children:(0,s.jsx)(k.OL,{onClick:()=>V(!1),children:"OK"})})]})}),(0,s.jsx)(k.aR,{open:Z,onOpenChange:q,children:(0,s.jsxs)(k._T,{children:[(0,s.jsxs)(k.fY,{children:[(0,s.jsx)(k.f$,{children:"Clear Draft?"}),(0,s.jsx)(k.yT,{children:"Are you sure you want to clear all saved draft data? This cannot be undone."})]}),(0,s.jsxs)(k.xo,{children:[(0,s.jsx)(k.le,{children:"Cancel"}),(0,s.jsx)(k.OL,{onClick:()=>{Q(),B.reset({is_online:!1,end_date:"",end_time:""}),J.reset({ticket_types:[{name:"",price:0,quantity:100}]}),K.reset({ticket_types:[]}),O(null),C(1),q(!1),L(!0)},children:"Clear Draft"})]})]})}),(0,s.jsx)(k.aR,{open:z,onOpenChange:L,children:(0,s.jsxs)(k._T,{children:[(0,s.jsxs)(k.fY,{children:[(0,s.jsx)(k.f$,{children:"Draft Cleared"}),(0,s.jsx)(k.yT,{children:"Draft cleared successfully"})]}),(0,s.jsx)(k.xo,{children:(0,s.jsx)(k.OL,{onClick:()=>L(!1),children:"OK"})})]})})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"mb-2",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Only creators can create events."})]})})}o.Ry({name:o.Z_().min(1,"Ticket name is required"),price:o.Rx().min(0,"Price must be 0 or greater"),quantity:o.Rx().min(1,"Quantity must be at least 1")}),o.Ry({ticket_types:o.IX(o.Ry({name:o.Z_(),price:o.Rx(),quantity:o.Rx(),description:o.Z_().optional()}))})},12381:function(e,t,r){"use strict";r.d(t,{d:function(){return o},z:function(){return c}});var s=r(57437),i=r(2265),a=r(37053),n=r(90535),l=r(93448);let o=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-button hover:brightness-110 active:scale-95",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border-2 border-primary bg-transparent text-primary hover:bg-primary hover:text-primary-foreground",secondary:"bg-secondary text-secondary-foreground hover:brightness-110 active:scale-95",ghost:"hover:bg-muted hover:text-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-primary text-primary-foreground shadow-button hover:brightness-110 active:scale-95 font-bold",accent:"bg-accent text-accent-foreground border border-border hover:bg-muted active:scale-95"},size:{default:"h-11 px-6 py-2",sm:"h-9 px-4 text-xs",lg:"h-14 px-8 text-base",xl:"h-16 px-10 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,t)=>{let{className:r,variant:i,size:n,asChild:c=!1,...d}=e,m=c?a.g7:"button";return(0,s.jsx)(m,{className:(0,l.cn)(o({variant:i,size:n,className:r})),ref:t,...d})});c.displayName="Button"},23675:function(e,t,r){"use strict";r.d(t,{g:function(){return n}});var s=r(57437),i=r(2265),a=r(93448);let n=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,s.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...i})});n.displayName="Textarea"},14362:function(e,t,r){"use strict";r.d(t,{H:function(){return o},a:function(){return l}});var s=r(57437),i=r(2265),a=r(5526);let n=(0,i.createContext)(void 0),l=()=>{let e=(0,i.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},o=e=>{let{children:t}=e,[r,l]=(0,i.useState)(null),[o,c]=(0,i.useState)(null),[d,m]=(0,i.useState)(null),[u,h]=(0,i.useState)(!0),x=(0,i.useRef)(null),g=async e=>{if(x.current!==e){x.current=e;try{let{data:t,error:r}=await a.supabase.from("users").select("id, email, full_name, role, gender, school, avatar_name, avatar_url").eq("id",e).single();if(r)throw r;t?c({id:t.id,email:t.email,full_name:t.full_name,role:t.role||"user",gender:t.gender||null,school:t.school||null,avatar_name:t.avatar_name||null,avatar_url:t.avatar_url||null}):c(null)}catch(e){console.error("Error fetching profile:",e),c(null)}finally{x.current=null}}},p=async()=>{r&&(x.current=null,await g(r.id))};(0,i.useEffect)(()=>{let e=!0,t=null;a.supabase.auth.getSession().then(r=>{var s,i,a;let{data:{session:n},error:o}=r;if(e){if(o){h(!1);return}m(n),l(null!==(i=null==n?void 0:n.user)&&void 0!==i?i:null),t=null!==(a=null==n?void 0:null===(s=n.user)||void 0===s?void 0:s.id)&&void 0!==a?a:null,(null==n?void 0:n.user)&&g(n.user.id),e&&h(!1)}});let{data:{subscription:r}}=a.supabase.auth.onAuthStateChange((r,s)=>{var i,a,n;if(!e)return;let o=null!==(a=null==s?void 0:null===(i=s.user)||void 0===i?void 0:i.id)&&void 0!==a?a:null;o!==t&&(m(s),l(null!==(n=null==s?void 0:s.user)&&void 0!==n?n:null),t=o,(null==s?void 0:s.user)?g(s.user.id):c(null))});return()=>{e=!1,r.unsubscribe()}},[]);let v=async()=>{await a.supabase.auth.signOut(),l(null),c(null),m(null),x.current=null};return(0,s.jsx)(n.Provider,{value:{user:r,profile:o,session:d,loading:u,signOut:v,refreshProfile:p},children:t})}},5526:function(e,t,r){"use strict";r.d(t,{supabase:function(){return c}});var s,i,a=r(98280),n=r(40257);let l=(void 0!==n?null===(s=n.env)||void 0===s?void 0:"https://ynkvvjkokwwnqoujeznu.supabase.co":void 0)||"",o=(void 0!==n?null===(i=n.env)||void 0===i?void 0:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlua3Z2amtva3d3bnFvdWplem51Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NjE2ODMsImV4cCI6MjA4NDMzNzY4M30.tVFWjO_kqz2iY3GpunHC78czG6Tb2Ikhl1HbVoINbCg":void 0)||"";if(!l||!o){let e="Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your .env.local file. (Note: In Next.js, client-side env vars must be prefixed with NEXT_PUBLIC_)";throw console.error(e),Error(e)}let c=(0,a.eI)(l,o,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},93448:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(61994),i=r(53335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,s.W)(t))}}},function(e){e.O(0,[4182,2972,5506,3850,5730,4438,6818,1214,8748,2971,2117,1744],function(){return e(e.s=76472)}),_N_E=e.O()}]);