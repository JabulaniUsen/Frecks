(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7737],{51729:function(e,t,r){Promise.resolve().then(r.bind(r,84386))},84386:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return O}});var s=r(57437),i=r(2265),a=r(99376),n=r(29501),o=r(13590),c=r(67119),l=r(11713),d=r(21770),u=r(12381),m=r(40279),h=r(75060),p=r(23675),f=r(14362),g=r(61980),x=r(96629),v=r(5526),y=r(51817),b=r(32660),_=r(32489),w=r(53113),j=r(76858),N=r(30401),k=r(27648),S=r(64014),E=r(14438);let q=["Concert","Sports","Party","Comedy","Film","Workshop","Conference","Festival","Other"],C=c.Ry({title:c.Z_().min(3,"Title must be at least 3 characters"),description:c.Z_().min(10,"Description must be at least 10 characters"),category:c.Z_().min(1,"Please select a category"),image:c.Yj().optional(),is_online:c.O7().default(!1),location:c.Z_().min(3,"Location is required"),start_date:c.Z_().min(1,"Start date is required"),start_time:c.Z_().min(1,"Start time is required"),end_date:c.Z_().optional(),end_time:c.Z_().optional()});function O(){let e=(0,a.useRouter)(),t=(0,a.useParams)().id,{profile:r,user:c}=(0,f.a)(),[O,M]=(0,i.useState)(1),[R,P]=(0,i.useState)(null),[I,Z]=(0,i.useState)(!1),{data:D,isLoading:F}=(0,l.a)({queryKey:["event",t],queryFn:()=>(0,x.Y)(t),enabled:!!t}),T=(0,n.cI)({resolver:(0,o.F)(C),defaultValues:{is_online:!1,end_date:"",end_time:""}}),A=(0,n.cI)({defaultValues:{ticket_types:[]}}),{fields:L,append:U,remove:z}=(0,n.Dq)({control:A.control,name:"ticket_types"}),V=(0,n.cI)({defaultValues:{ticket_types:[]}});(0,i.useEffect)(()=>{if(D){var e;let t=new Date(D.date),r=(null===(e=D.location)||void 0===e?void 0:e.startsWith("Online -"))||!1,s=r?D.location.replace("Online - ",""):D.location;T.reset({title:D.title||"",description:D.description||"",category:D.category||"",is_online:r,location:s||"",start_date:(0,S.WU)(t,"yyyy-MM-dd"),start_time:(0,S.WU)(t,"HH:mm"),end_date:"",end_time:""}),D.image_url&&P(D.image_url),D.ticket_types&&D.ticket_types.length>0&&(A.reset({ticket_types:D.ticket_types.map(e=>({id:e.id,name:e.name||"",price:e.price||0,quantity:e.quantity||0}))}),V.reset({ticket_types:D.ticket_types.map(e=>({description:e.description||""}))}))}},[D,T,A,V]);let W=T.watch(),G=A.watch("ticket_types"),B=V.watch("ticket_types"),K=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.85;return new Promise((s,i)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=a=>{var n;let o=new Image;o.src=null===(n=a.target)||void 0===n?void 0:n.result,o.onload=()=>{let a=document.createElement("canvas"),n=o.width,c=o.height;n>t&&(c=c*t/n,n=t),a.width=n,a.height=c;let l=a.getContext("2d");if(!l){i(Error("Failed to get canvas context"));return}l.drawImage(o,0,0,n,c),a.toBlob(t=>{if(!t){i(Error("Failed to compress image"));return}s(new File([t],e.name,{type:"image/jpeg",lastModified:Date.now()}))},"image/jpeg",r)},o.onerror=()=>i(Error("Failed to load image"))},a.onerror=()=>i(Error("Failed to read file"))})},$=async e=>{if(!c)throw Error("User not authenticated");let t=await K(e),r="".concat(c.id,"/").concat(Date.now(),".").concat("jpg"),{error:s}=await v.supabase.storage.from("event-images").upload(r,t,{cacheControl:"3600",upsert:!1});if(s)throw Error("Image upload failed: ".concat(s.message));let{data:i}=v.supabase.storage.from("event-images").getPublicUrl(r);if(!(null==i?void 0:i.publicUrl))throw Error("Failed to get public URL for uploaded image");return i.publicUrl},H=(0,d.D)({mutationFn:async()=>{if(!c||!r)throw Error("User not authenticated");let e=null==D?void 0:D.image_url,s=T.getValues("image");if(s){Z(!0);try{e=await $(s)}catch(e){console.warn("Image upload failed, keeping existing image:",e.message)}finally{Z(!1)}}let i=new Date("".concat(W.start_date,"T").concat(W.start_time)),a=W.is_online?"Online - ".concat(W.location):W.location,n=G.map((e,t)=>{var r;return{id:e.id,name:e.name,price:e.price,quantity:e.quantity,description:(null===(r=B[t])||void 0===r?void 0:r.description)||"",is_free:0===e.price}});await (0,g.eJ)(t,{title:W.title,description:W.description,category:W.category,image_url:e,date:i.toISOString(),location:a,ticket_types:n})},onSuccess:()=>{E.Am.success("Event updated successfully!"),e.push("/dashboard/creator")},onError:e=>{E.Am.error((null==e?void 0:e.message)||"Failed to update event"),Z(!1)}}),Y=async()=>{var e,t;if(1===O){if(!await T.trigger()){let t=Object.keys(T.formState.errors)[0];t&&(null===(e=document.querySelector('[name="'.concat(t,'"]')))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}));return}M(e=>Math.min(e+1,4));return}if(2===O){if(!await A.trigger()){let e=A.formState.errors.ticket_types;if(e){let r=Object.keys(e)[0];null===(t=document.querySelector('[name="ticket_types.'.concat(r,'"]')))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"})}return}let e=A.getValues("ticket_types");V.reset({ticket_types:e.map(e=>{var t;return{description:(null===(t=B.find((t,r)=>r===G.indexOf(e)))||void 0===t?void 0:t.description)||""}})}),M(e=>Math.min(e+1,4));return}if(3===O){M(e=>Math.min(e+1,4));return}},J=async()=>{let e=await T.trigger(),t=await A.trigger();if(!e||!t){E.Am.error("Please fix all errors before updating the event.");return}await H.mutateAsync()};return c&&r&&"creator"===r.role?F?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(y.Z,{className:"w-8 h-8 animate-spin"})}):D?(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)("div",{className:"border-b border-border bg-card sticky top-0 z-10",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(k.default,{href:"/dashboard/creator",children:(0,s.jsx)(u.z,{variant:"ghost",size:"icon",children:(0,s.jsx)(b.Z,{className:"w-5 h-5"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Edit Event"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Step ",O," of 4"]})]})]})}),(0,s.jsx)("div",{className:"mt-4 flex gap-2",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:"flex-1 h-2 rounded-full transition-colors ".concat(e<=O?"bg-primary":"bg-muted")},e))})]})}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[1===O&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Event Details"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update your event information."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{children:"Event Image"}),(0,s.jsx)("div",{className:"mt-2",children:R?(0,s.jsxs)("div",{className:"relative w-full h-64 rounded-lg overflow-hidden border border-border",children:[(0,s.jsx)("img",{src:R,alt:"Event preview",className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>{P(null),T.setValue("image",void 0)},className:"absolute top-2 right-2 p-2 bg-background/80 rounded-full hover:bg-background",disabled:I,children:(0,s.jsx)(_.Z,{className:"w-4 h-4"})})]}):(0,s.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,s.jsx)(w.Z,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,s.jsxs)("p",{className:"mb-2 text-sm text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, GIF up to 5MB"})]}),(0,s.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(!r.type.startsWith("image/")){T.setError("image",{message:"Please upload an image file"});return}if(r.size>5242880){T.setError("image",{message:"Image must be less than 5MB"});return}T.setValue("image",r),T.clearErrors("image");let e=new FileReader;e.onloadend=()=>{P(e.result)},e.readAsDataURL(r)}}})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{htmlFor:"title",children:"Event Title *"}),(0,s.jsx)(m.I,{id:"title",...T.register("title"),placeholder:"e.g., Spring Fest 2026",className:"mt-2"}),T.formState.errors.title&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.title.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{htmlFor:"description",children:"Description *"}),(0,s.jsx)(p.g,{id:"description",...T.register("description"),placeholder:"Describe your event in detail...",rows:6,className:"mt-2"}),T.formState.errors.description&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.description.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{htmlFor:"category",children:"Category *"}),(0,s.jsxs)("select",{id:"category",...T.register("category"),className:"mt-2 w-full px-3 py-2 rounded-lg border border-border bg-background",children:[(0,s.jsx)("option",{value:"",children:"Select a category"}),q.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),T.formState.errors.category&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.category.message)})]}),(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsxs)(h._,{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...T.register("is_online"),className:"w-4 h-4"}),(0,s.jsx)("span",{children:"This is an online event"})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{htmlFor:"location",children:W.is_online?"Online Event Link/Platform *":"Location *"}),(0,s.jsx)(m.I,{id:"location",...T.register("location"),placeholder:W.is_online?"e.g., Zoom, Google Meet, or event link":"e.g., Main Campus Amphitheater",className:"mt-2"}),T.formState.errors.location&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.location.message)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{htmlFor:"start_date",children:"Start Date *"}),(0,s.jsx)(m.I,{id:"start_date",type:"date",...T.register("start_date"),className:"mt-2"}),T.formState.errors.start_date&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.start_date.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{htmlFor:"start_time",children:"Start Time *"}),(0,s.jsx)(m.I,{id:"start_time",type:"time",...T.register("start_time"),className:"mt-2"}),T.formState.errors.start_time&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.start_time.message)})]})]})]})]}),2===O&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Types"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update your ticket types and pricing."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[L.map((e,t)=>{var r,i,a,n,o,c,l,d,p,f,g,x;return(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["Ticket Type ",t+1]}),L.length>1&&(0,s.jsx)(u.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>z(t),children:(0,s.jsx)(_.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{children:"Ticket Name *"}),(0,s.jsx)(m.I,{...A.register("ticket_types.".concat(t,".name")),placeholder:"e.g., General Admission, VIP, Early Bird",className:"mt-2"}),(null===(i=A.formState.errors.ticket_types)||void 0===i?void 0:null===(r=i[t])||void 0===r?void 0:r.name)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(n=A.formState.errors.ticket_types[t])||void 0===n?void 0:null===(a=n.name)||void 0===a?void 0:a.message)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{children:"Price (₦) *"}),(0,s.jsx)(m.I,{type:"number",step:"0.01",min:"0",...A.register("ticket_types.".concat(t,".price"),{valueAsNumber:!0}),placeholder:"0.00",className:"mt-2"}),(null===(c=A.formState.errors.ticket_types)||void 0===c?void 0:null===(o=c[t])||void 0===o?void 0:o.price)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(d=A.formState.errors.ticket_types[t])||void 0===d?void 0:null===(l=d.price)||void 0===l?void 0:l.message)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{children:"Quantity *"}),(0,s.jsx)(m.I,{type:"number",min:"1",...A.register("ticket_types.".concat(t,".quantity"),{valueAsNumber:!0}),placeholder:"100",className:"mt-2"}),(null===(f=A.formState.errors.ticket_types)||void 0===f?void 0:null===(p=f[t])||void 0===p?void 0:p.quantity)&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(x=A.formState.errors.ticket_types[t])||void 0===x?void 0:null===(g=x.quantity)||void 0===g?void 0:g.message)})]})]})]},e.id)}),(0,s.jsx)(u.z,{type:"button",variant:"outline",onClick:()=>U({name:"",price:0,quantity:100}),className:"w-full",children:"+ Add Another Ticket Type"})]})]}),3===O&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Benefits (Optional)"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update benefits or details for each ticket type."})]}),(0,s.jsx)("div",{className:"space-y-6",children:V.watch("ticket_types").length>0?V.watch("ticket_types").map((e,t)=>{var r;return(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold mb-4",children:(null===(r=G[t])||void 0===r?void 0:r.name)||"Ticket Type ".concat(t+1)}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h._,{children:"Benefits/Description (Optional)"}),(0,s.jsx)(p.g,{...V.register("ticket_types.".concat(t,".description")),placeholder:"e.g., Access to VIP area, Free drinks, Early entry...",rows:4,className:"mt-2"})]})]},t)}):(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No ticket types found. Please go back to Step 2 and add ticket types."})})]}),4===O&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Preview Event"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review your event details before updating."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[R&&(0,s.jsx)("div",{className:"w-full h-64 rounded-lg overflow-hidden border border-border",children:(0,s.jsx)("img",{src:R,alt:W.title,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-2xl font-bold",children:W.title}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:W.category})]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:W.description})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-border",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Location"}),(0,s.jsx)("p",{className:"font-medium",children:W.location})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Start Date & Time"}),(0,s.jsx)("p",{className:"font-medium",children:W.start_date&&W.start_time?(0,S.WU)(new Date("".concat(W.start_date,"T").concat(W.start_time)),"MMM d, yyyy • h:mm a"):"Not set"})]})]})]}),(0,s.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Ticket Types"}),G.map((e,t)=>{var r;return(0,s.jsx)("div",{className:"p-4 bg-muted rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(null===(r=B[t])||void 0===r?void 0:r.description)&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:B[t].description})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"font-bold",children:0===e.price?"Free":"₦".concat(e.price.toLocaleString())}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.quantity," tickets"]})]})]})},t)})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-border",children:[(0,s.jsxs)(u.z,{type:"button",variant:"outline",onClick:()=>{M(e=>Math.max(e-1,1))},disabled:1===O,children:[(0,s.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Previous"]}),O<4?(0,s.jsxs)(u.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),Y()},variant:"hero",children:["Next",(0,s.jsx)(j.Z,{className:"w-4 h-4 ml-2"})]}):(0,s.jsx)(u.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),J()},variant:"hero",disabled:H.isPending||I,children:H.isPending||I?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{className:"w-4 h-4 mr-2 animate-spin"}),I?"Uploading image...":"Updating event..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Update Event"]})})]})]})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"mb-2",children:"Event not found"}),(0,s.jsx)(k.default,{href:"/dashboard/creator",children:(0,s.jsx)(u.z,{variant:"outline",children:"Back to Dashboard"})})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"mb-2",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Only creators can edit events."})]})})}c.Ry({id:c.Z_().optional(),name:c.Z_().min(1,"Ticket name is required"),price:c.Rx().min(0,"Price must be 0 or greater"),quantity:c.Rx().min(1,"Quantity must be at least 1")})},79205:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var s=r(2265);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:l="",children:d,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...n,width:i,height:i,stroke:r,strokeWidth:c?24*Number(o)/Number(i):o,className:a("lucide",l),...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{className:c,...l}=r;return(0,s.createElement)(o,{ref:n,iconNode:t,className:a("lucide-".concat(i(e)),c),...l})});return r.displayName="".concat(e),r}},32660:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},76858:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},30401:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},53113:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},51817:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},32489:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},27648:function(e,t,r){"use strict";r.d(t,{default:function(){return i.a}});var s=r(72972),i=r.n(s)},99376:function(e,t,r){"use strict";var s=r(35475);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},40279:function(e,t,r){"use strict";r.d(t,{I:function(){return n}});var s=r(57437),i=r(2265),a=r(93448);let n=i.forwardRef((e,t)=>{let{className:r,type:i,...n}=e;return(0,s.jsx)("input",{type:i,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});n.displayName="Input"},75060:function(e,t,r){"use strict";r.d(t,{_:function(){return l}});var s=r(57437),i=r(2265),a=r(6394),n=r(90535),o=r(93448);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,s.jsx)(a.f,{ref:t,className:(0,o.cn)(c(),r),...i})});l.displayName=a.f.displayName},23675:function(e,t,r){"use strict";r.d(t,{g:function(){return n}});var s=r(57437),i=r(2265),a=r(93448);let n=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,s.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...i})});n.displayName="Textarea"},61980:function(e,t,r){"use strict";r.d(t,{Bt:function(){return n},D0:function(){return c},E$:function(){return g},LV:function(){return o},Lj:function(){return d},aE:function(){return f},cD:function(){return x},eJ:function(){return a},li:function(){return l},ob:function(){return p},rM:function(){return u},y6:function(){return m},yM:function(){return i},zf:function(){return h}});var s=r(5526);let i=async e=>{console.log("Creating event in database...",{creator_id:e.creator_id,title:e.title,category:e.category});let{data:t,error:r}=await s.supabase.from("events").insert({creator_id:e.creator_id,title:e.title,description:e.description,category:e.category,image_url:e.image_url,date:e.date,location:e.location,is_featured:e.is_featured||!1,status:"active"}).select().single();if(r)throw console.error("Event creation error:",r),Error("Failed to create event: ".concat(r.message," (").concat(r.code||"unknown",")"));if(!t)throw Error("Event creation returned no data");console.log("Event created, ID:",t.id),console.log("Creating ticket types...",e.ticket_types.length);let i=e.ticket_types.map(e=>({event_id:t.id,name:e.name,description:e.description,price:e.price,quantity:e.quantity,is_free:e.is_free||!1})),{error:a}=await s.supabase.from("ticket_types").insert(i);if(a)throw console.error("Ticket types creation error:",a),Error("Failed to create ticket types: ".concat(a.message," (").concat(a.code||"unknown",")"));return console.log("Ticket types created successfully"),t},a=async(e,t)=>{let{data:r,error:i}=await s.supabase.from("events").update({title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured||!1,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw Error("Failed to update event: ".concat(i.message));if(!r)throw Error("Event update returned no data");let{data:a}=await s.supabase.from("ticket_types").select("id").eq("event_id",e),n=new Set((null==a?void 0:a.map(e=>e.id))||[]),o=new Set(t.ticket_types.filter(e=>e.id).map(e=>e.id)),c=Array.from(n).filter(e=>!o.has(e));for(let r of(c.length>0&&await s.supabase.from("ticket_types").delete().in("id",c),t.ticket_types))r.id&&n.has(r.id)?await s.supabase.from("ticket_types").update({name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1}).eq("id",r.id):await s.supabase.from("ticket_types").insert({event_id:e,name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1});return r},n=async(e,t)=>{let{data:r,error:i}=await s.supabase.from("events").select("*").eq("id",e).eq("creator_id",t).single();if(i)throw i;if(!r)throw Error("Event not found or access denied");let{error:a}=await s.supabase.from("deleted_events").insert({original_event_id:r.id,creator_id:r.creator_id,title:r.title,description:r.description,category:r.category,image_url:r.image_url,date:r.date,location:r.location,is_featured:r.is_featured,status:"cancelled",deleted_by:t,created_at:r.created_at,updated_at:r.updated_at});if(a)throw a;let{error:n}=await s.supabase.from("events").delete().eq("id",e).eq("creator_id",t);if(n)throw n;return{success:!0}},o=async e=>{let{data:t,error:r}=await s.supabase.from("orders").insert({user_id:e.user_id,event_id:e.event_id,email:e.email,full_name:e.full_name,total_amount:e.total_amount,paystack_reference:e.paystack_reference,payment_status:e.payment_status||"pending"}).select().single();if(r)throw r;let i=e.tickets.map(r=>({ticket_type_id:r.ticket_type_id,event_id:e.event_id,user_id:e.user_id,order_id:t.id,qr_code:r.qr_code,qr_code_data:r.qr_code_data,status:(e.payment_status,"valid")})),{error:a}=await s.supabase.from("tickets").insert(i);if(a)throw a;if("paid"===e.payment_status){let t=new Map;for(let r of e.tickets){let e=t.get(r.ticket_type_id)||0;t.set(r.ticket_type_id,e+1)}for(let[e,r]of t){let{data:t}=await s.supabase.from("ticket_types").select("sold_count").eq("id",e).single();t&&await s.supabase.from("ticket_types").update({sold_count:t.sold_count+r}).eq("id",e)}}return t},c=async(e,t)=>{let{data:r,error:i}=await s.supabase.from("creator_profiles").upsert({user_id:e,...t}).select().single();if(i)throw i;return r},l=async(e,t)=>{var r;let{data:i,error:a}=await s.supabase.from("tickets").select("*, event:events!inner(creator_id, id)").eq("id",e).single();if(a||!i)throw Error("Ticket not found");if((null===(r=i.event)||void 0===r?void 0:r.creator_id)!==t)throw Error("Only the event creator can validate tickets");if("used"===i.status)throw Error("Ticket has already been validated");if("cancelled"===i.status)throw Error("Ticket has been cancelled");let{error:n}=await s.supabase.from("tickets").update({status:"used",checked_in_at:new Date().toISOString(),checked_in_by:t}).eq("id",e);if(n)throw Error("Failed to validate ticket: ".concat(n.message));return await s.supabase.from("qr_scans").insert({ticket_id:e,scanned_by:t,scan_result:"valid"}),{success:!0,ticketId:e}},d=async(e,t)=>{let{data:r,error:i}=await s.supabase.from("users").update({full_name:t.full_name,gender:t.gender,school:t.school,avatar_name:t.avatar_name,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return r},u=async e=>{let{data:t,error:r}=await s.supabase.from("events").select("*").eq("id",e).single();if(r)throw r;if(!t)throw Error("Event not found");let{error:i}=await s.supabase.from("deleted_events").insert({original_event_id:t.id,creator_id:t.creator_id,title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured,status:"cancelled",deleted_by:t.creator_id,created_at:t.created_at,updated_at:t.updated_at});if(i)throw i;let{error:a}=await s.supabase.from("events").delete().eq("id",e);if(a)throw a;return{success:!0}},m=async(e,t)=>{let{data:r,error:i}=await s.supabase.from("users").update({role:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;if("creator"===t){let{data:t}=await s.supabase.from("creator_profiles").select("id").eq("user_id",e).maybeSingle();t||await s.supabase.from("creator_profiles").insert({user_id:e})}return r},h=async(e,t)=>{let{data:r,error:i}=await s.supabase.from("users").update({banned:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return r},p=async(e,t)=>{let{data:r,error:i}=await s.supabase.from("events").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return r},f=async(e,t,r)=>{let{data:i,error:a}=await s.supabase.from("creator_profiles").select("account_balance").eq("user_id",e).single();if(a)throw a;if(!i)throw Error("Creator profile not found");let n=Number(i.account_balance)||0;if(n<t)throw Error("Insufficient balance. Available: ₦".concat(n.toLocaleString()));let{data:o,error:c}=await s.supabase.from("withdrawals").insert({creator_id:e,amount:t,status:"pending",...r}).select().single();if(c)throw c;let{error:l}=await s.supabase.from("creator_profiles").update({account_balance:n-t}).eq("user_id",e);if(l)throw l;return await s.supabase.from("wallet_transactions").insert({creator_id:e,type:"withdrawal",amount:-t,status:"pending",description:"Withdrawal request - ".concat(r.bank_name," ").concat(r.bank_account_number)}),o},g=async(e,t,r)=>{let{data:i,error:a}=await s.supabase.from("withdrawals").update({status:"approved",approved_by:t,approved_at:new Date().toISOString(),admin_note:r}).eq("id",e).select().single();if(a)throw a;return await s.supabase.from("wallet_transactions").update({status:"completed"}).eq("creator_id",i.creator_id).eq("amount",-i.amount).eq("type","withdrawal").eq("status","pending"),i},x=async(e,t,r)=>{let{data:i,error:a}=await s.supabase.from("withdrawals").select("*").eq("id",e).single();if(a)throw a;if(!i)throw Error("Withdrawal not found");let{error:n}=await s.supabase.from("withdrawals").update({status:"rejected",approved_by:t,rejected_at:new Date().toISOString(),admin_note:r}).eq("id",e);if(n)throw n;let{data:o}=await s.supabase.from("creator_profiles").select("account_balance").eq("user_id",i.creator_id).single();if(o){let e=Number(o.account_balance)||0;await s.supabase.from("creator_profiles").update({account_balance:e+Number(i.amount)}).eq("user_id",i.creator_id)}return await s.supabase.from("wallet_transactions").update({status:"failed"}).eq("creator_id",i.creator_id).eq("amount",-i.amount).eq("type","withdrawal").eq("status","pending"),i}},66840:function(e,t,r){"use strict";r.d(t,{WV:function(){return o},jH:function(){return c}});var s=r(2265),i=r(54887),a=r(37053),n=r(57437),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,a.Z8)(`Primitive.${t}`),i=s.forwardRef((e,s)=>{let{asChild:i,...a}=e,o=i?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(o,{...a,ref:s})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function c(e,t){e&&i.flushSync(()=>e.dispatchEvent(t))}},2894:function(e,t,r){"use strict";r.d(t,{R:function(){return o},m:function(){return n}});var s=r(18238),i=r(7989),a=r(11255),n=class extends i.F{#e;#t;#r;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||o(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||("pending"===this.state.status?this.scheduleGc():this.#t.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#s({type:"continue"})};this.#r=(0,a.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#s({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});let r="pending"===this.state.status,s=!this.#r.canStart();try{if(r)t();else{this.#s({type:"pending",variables:e,isPaused:s}),await this.#t.config.onMutate?.(e,this);let t=await this.options.onMutate?.(e);t!==this.state.context&&this.#s({type:"pending",context:t,variables:e,isPaused:s})}let i=await this.#r.start();return await this.#t.config.onSuccess?.(i,e,this.state.context,this),await this.options.onSuccess?.(i,e,this.state.context),await this.#t.config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,e,this.state.context),this.#s({type:"success",data:i}),i}catch(t){try{throw await this.#t.config.onError?.(t,e,this.state.context,this),await this.options.onError?.(t,e,this.state.context),await this.#t.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,t,e,this.state.context),t}finally{this.#s({type:"error",error:t})}}finally{this.#t.runNext(this)}}#s(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),s.Vr.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},21770:function(e,t,r){"use strict";r.d(t,{D:function(){return d}});var s=r(2265),i=r(2894),a=r(18238),n=r(24112),o=r(45345),c=class extends n.l{#i;#a=void 0;#n;#o;constructor(e,t){super(),this.#i=e,this.setOptions(t),this.bindMethods(),this.#c()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#i.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#i.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#c(),this.#l(e)}getCurrentResult(){return this.#a}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#c(),this.#l()}mutate(e,t){return this.#o=t,this.#n?.removeObserver(this),this.#n=this.#i.getMutationCache().build(this.#i,this.options),this.#n.addObserver(this),this.#n.execute(e)}#c(){let e=this.#n?.state??(0,i.R)();this.#a={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#l(e){a.Vr.batch(()=>{if(this.#o&&this.hasListeners()){let t=this.#a.variables,r=this.#a.context;e?.type==="success"?(this.#o.onSuccess?.(e.data,t,r),this.#o.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#o.onError?.(e.error,t,r),this.#o.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#a)})})}},l=r(29827);function d(e,t){let r=(0,l.NL)(t),[i]=s.useState(()=>new c(r,e));s.useEffect(()=>{i.setOptions(e)},[i,e]);let n=s.useSyncExternalStore(s.useCallback(e=>i.subscribe(a.Vr.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),d=s.useCallback((e,t)=>{i.mutate(e,t).catch(o.ZT)},[i]);if(n.error&&(0,o.L3)(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:d,mutateAsync:n.mutate}}}},function(e){e.O(0,[4182,2972,5730,1713,4438,6818,9913,2971,2117,1744],function(){return e(e.s=51729)}),_N_E=e.O()}]);