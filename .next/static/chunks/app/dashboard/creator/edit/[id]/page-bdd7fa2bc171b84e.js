(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[737],{1729:function(e,t,s){Promise.resolve().then(s.bind(s,4386))},4386:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return O}});var r=s(7437),i=s(2265),a=s(9376),n=s(9501),o=s(3590),c=s(7119),l=s(1713),d=s(1770),u=s(2381),m=s(279),h=s(5060),p=s(3675),f=s(4362),x=s(1980),v=s(6629),g=s(5526),y=s(1817),b=s(2660),j=s(2489),w=s(3113),N=s(6858),_=s(401),k=s(7648),S=s(4014),C=s(4438);let E=["Concert","Sports","Party","Comedy","Film","Workshop","Conference","Festival","Other"],M=c.Ry({title:c.Z_().min(3,"Title must be at least 3 characters"),description:c.Z_().min(10,"Description must be at least 10 characters"),category:c.Z_().min(1,"Please select a category"),image:c.Yj().optional(),is_online:c.O7().default(!1),location:c.Z_().min(3,"Location is required"),start_date:c.Z_().min(1,"Start date is required"),start_time:c.Z_().min(1,"Start time is required"),end_date:c.Z_().optional(),end_time:c.Z_().optional()});function O(){let e=(0,a.useRouter)(),t=(0,a.useParams)().id,{profile:s,user:c}=(0,f.a)(),[O,P]=(0,i.useState)(1),[R,Z]=(0,i.useState)(null),[q,F]=(0,i.useState)(!1),{data:D,isLoading:I}=(0,l.a)({queryKey:["event",t],queryFn:()=>(0,v.Y)(t),enabled:!!t}),T=(0,n.cI)({resolver:(0,o.F)(M),defaultValues:{is_online:!1,end_date:"",end_time:""}}),A=(0,n.cI)({defaultValues:{ticket_types:[]}}),{fields:U,append:L,remove:z}=(0,n.Dq)({control:A.control,name:"ticket_types"}),V=(0,n.cI)({defaultValues:{ticket_types:[]}});(0,i.useEffect)(()=>{if(D){var e;let t=new Date(D.date),s=(null===(e=D.location)||void 0===e?void 0:e.startsWith("Online -"))||!1,r=s?D.location.replace("Online - ",""):D.location;T.reset({title:D.title||"",description:D.description||"",category:D.category||"",is_online:s,location:r||"",start_date:(0,S.WU)(t,"yyyy-MM-dd"),start_time:(0,S.WU)(t,"HH:mm"),end_date:"",end_time:""}),D.image_url&&Z(D.image_url),D.ticket_types&&D.ticket_types.length>0&&(A.reset({ticket_types:D.ticket_types.map(e=>({id:e.id,name:e.name||"",price:e.price||0,quantity:e.quantity||0}))}),V.reset({ticket_types:D.ticket_types.map(e=>({description:e.description||""}))}))}},[D,T,A,V]);let G=T.watch(),W=A.watch("ticket_types"),B=V.watch("ticket_types"),K=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.85;return new Promise((r,i)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=a=>{var n;let o=new Image;o.src=null===(n=a.target)||void 0===n?void 0:n.result,o.onload=()=>{let a=document.createElement("canvas"),n=o.width,c=o.height;n>t&&(c=c*t/n,n=t),a.width=n,a.height=c;let l=a.getContext("2d");if(!l){i(Error("Failed to get canvas context"));return}l.drawImage(o,0,0,n,c),a.toBlob(t=>{if(!t){i(Error("Failed to compress image"));return}r(new File([t],e.name,{type:"image/jpeg",lastModified:Date.now()}))},"image/jpeg",s)},o.onerror=()=>i(Error("Failed to load image"))},a.onerror=()=>i(Error("Failed to read file"))})},H=async e=>{if(!c)throw Error("User not authenticated");let t=await K(e),s="".concat(c.id,"/").concat(Date.now(),".").concat("jpg"),{error:r}=await g.supabase.storage.from("event-images").upload(s,t,{cacheControl:"3600",upsert:!1});if(r)throw Error("Image upload failed: ".concat(r.message));let{data:i}=g.supabase.storage.from("event-images").getPublicUrl(s);if(!(null==i?void 0:i.publicUrl))throw Error("Failed to get public URL for uploaded image");return i.publicUrl},Y=(0,d.D)({mutationFn:async()=>{if(!c||!s)throw Error("User not authenticated");let e=null==D?void 0:D.image_url,r=T.getValues("image");if(r){F(!0);try{e=await H(r)}catch(e){console.warn("Image upload failed, keeping existing image:",e.message)}finally{F(!1)}}let i=new Date("".concat(G.start_date,"T").concat(G.start_time)),a=G.is_online?"Online - ".concat(G.location):G.location,n=W.map((e,t)=>{var s;return{id:e.id,name:e.name,price:e.price,quantity:e.quantity,description:(null===(s=B[t])||void 0===s?void 0:s.description)||"",is_free:0===e.price}});await (0,x.eJ)(t,{title:G.title,description:G.description,category:G.category,image_url:e,date:i.toISOString(),location:a,ticket_types:n})},onSuccess:()=>{C.Am.success("Event updated successfully!"),e.push("/dashboard/creator")},onError:e=>{C.Am.error((null==e?void 0:e.message)||"Failed to update event"),F(!1)}}),Q=async()=>{var e,t;if(1===O){if(!await T.trigger()){let t=Object.keys(T.formState.errors)[0];t&&(null===(e=document.querySelector('[name="'.concat(t,'"]')))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}));return}P(e=>Math.min(e+1,4));return}if(2===O){if(!await A.trigger()){let e=A.formState.errors.ticket_types;if(e){let s=Object.keys(e)[0];null===(t=document.querySelector('[name="ticket_types.'.concat(s,'"]')))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"})}return}let e=A.getValues("ticket_types");V.reset({ticket_types:e.map(e=>{var t;return{description:(null===(t=B.find((t,s)=>s===W.indexOf(e)))||void 0===t?void 0:t.description)||""}})}),P(e=>Math.min(e+1,4));return}if(3===O){P(e=>Math.min(e+1,4));return}},$=async()=>{let e=await T.trigger(),t=await A.trigger();if(!e||!t){C.Am.error("Please fix all errors before updating the event.");return}await Y.mutateAsync()};return c&&s&&"creator"===s.role?I?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)(y.Z,{className:"w-8 h-8 animate-spin"})}):D?(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)("div",{className:"border-b border-border bg-card sticky top-0 z-10",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(k.default,{href:"/dashboard/creator",children:(0,r.jsx)(u.z,{variant:"ghost",size:"icon",children:(0,r.jsx)(b.Z,{className:"w-5 h-5"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Edit Event"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Step ",O," of 4"]})]})]})}),(0,r.jsx)("div",{className:"mt-4 flex gap-2",children:[1,2,3,4].map(e=>(0,r.jsx)("div",{className:"flex-1 h-2 rounded-full transition-colors ".concat(e<=O?"bg-primary":"bg-muted")},e))})]})}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[1===O&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Event Details"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update your event information."})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{children:"Event Image"}),(0,r.jsx)("div",{className:"mt-2",children:R?(0,r.jsxs)("div",{className:"relative w-full h-64 rounded-lg overflow-hidden border border-border",children:[(0,r.jsx)("img",{src:R,alt:"Event preview",className:"w-full h-full object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>{Z(null),T.setValue("image",void 0)},className:"absolute top-2 right-2 p-2 bg-background/80 rounded-full hover:bg-background",disabled:q,children:(0,r.jsx)(j.Z,{className:"w-4 h-4"})})]}):(0,r.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,r.jsx)(w.Z,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,r.jsxs)("p",{className:"mb-2 text-sm text-muted-foreground",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, GIF up to 5MB"})]}),(0,r.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){if(!s.type.startsWith("image/")){T.setError("image",{message:"Please upload an image file"});return}if(s.size>5242880){T.setError("image",{message:"Image must be less than 5MB"});return}T.setValue("image",s),T.clearErrors("image");let e=new FileReader;e.onloadend=()=>{Z(e.result)},e.readAsDataURL(s)}}})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"title",children:"Event Title *"}),(0,r.jsx)(m.I,{id:"title",...T.register("title"),placeholder:"e.g., Spring Fest 2026",className:"mt-2"}),T.formState.errors.title&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.title.message)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"description",children:"Description *"}),(0,r.jsx)(p.g,{id:"description",...T.register("description"),placeholder:"Describe your event in detail...",rows:6,className:"mt-2"}),T.formState.errors.description&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.description.message)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"category",children:"Category *"}),(0,r.jsxs)("select",{id:"category",...T.register("category"),className:"mt-2 w-full px-3 py-2 rounded-lg border border-border bg-background",children:[(0,r.jsx)("option",{value:"",children:"Select a category"}),E.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),T.formState.errors.category&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.category.message)})]}),(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsxs)(h._,{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",...T.register("is_online"),className:"w-4 h-4"}),(0,r.jsx)("span",{children:"This is an online event"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"location",children:G.is_online?"Online Event Link/Platform *":"Location *"}),(0,r.jsx)(m.I,{id:"location",...T.register("location"),placeholder:G.is_online?"e.g., Zoom, Google Meet, or event link":"e.g., Main Campus Amphitheater",className:"mt-2"}),T.formState.errors.location&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.location.message)})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"start_date",children:"Start Date *"}),(0,r.jsx)(m.I,{id:"start_date",type:"date",...T.register("start_date"),className:"mt-2"}),T.formState.errors.start_date&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.start_date.message)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"start_time",children:"Start Time *"}),(0,r.jsx)(m.I,{id:"start_time",type:"time",...T.register("start_time"),className:"mt-2"}),T.formState.errors.start_time&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(T.formState.errors.start_time.message)})]})]})]})]}),2===O&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Types"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update your ticket types and pricing."})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[U.map((e,t)=>{var s,i,a,n,o,c,l,d,p,f,x,v;return(0,r.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h3",{className:"font-semibold",children:["Ticket Type ",t+1]}),U.length>1&&(0,r.jsx)(u.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>z(t),children:(0,r.jsx)(j.Z,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{children:"Ticket Name *"}),(0,r.jsx)(m.I,{...A.register("ticket_types.".concat(t,".name")),placeholder:"e.g., General Admission, VIP, Early Bird",className:"mt-2"}),(null===(i=A.formState.errors.ticket_types)||void 0===i?void 0:null===(s=i[t])||void 0===s?void 0:s.name)&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(n=A.formState.errors.ticket_types[t])||void 0===n?void 0:null===(a=n.name)||void 0===a?void 0:a.message)})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{children:"Price (₦) *"}),(0,r.jsx)(m.I,{type:"number",step:"0.01",min:"0",...A.register("ticket_types.".concat(t,".price"),{valueAsNumber:!0}),placeholder:"0.00",className:"mt-2"}),(null===(c=A.formState.errors.ticket_types)||void 0===c?void 0:null===(o=c[t])||void 0===o?void 0:o.price)&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(d=A.formState.errors.ticket_types[t])||void 0===d?void 0:null===(l=d.price)||void 0===l?void 0:l.message)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{children:"Quantity *"}),(0,r.jsx)(m.I,{type:"number",min:"1",...A.register("ticket_types.".concat(t,".quantity"),{valueAsNumber:!0}),placeholder:"100",className:"mt-2"}),(null===(f=A.formState.errors.ticket_types)||void 0===f?void 0:null===(p=f[t])||void 0===p?void 0:p.quantity)&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:String(null===(v=A.formState.errors.ticket_types[t])||void 0===v?void 0:null===(x=v.quantity)||void 0===x?void 0:x.message)})]})]})]},e.id)}),(0,r.jsx)(u.z,{type:"button",variant:"outline",onClick:()=>L({name:"",price:0,quantity:100}),className:"w-full",children:"+ Add Another Ticket Type"})]})]}),3===O&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Ticket Benefits (Optional)"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update benefits or details for each ticket type."})]}),(0,r.jsx)("div",{className:"space-y-6",children:V.watch("ticket_types").length>0?V.watch("ticket_types").map((e,t)=>{var s;return(0,r.jsxs)("div",{className:"p-6 border border-border rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold mb-4",children:(null===(s=W[t])||void 0===s?void 0:s.name)||"Ticket Type ".concat(t+1)}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{children:"Benefits/Description (Optional)"}),(0,r.jsx)(p.g,{...V.register("ticket_types.".concat(t,".description")),placeholder:"e.g., Access to VIP area, Free drinks, Early entry...",rows:4,className:"mt-2"})]})]},t)}):(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No ticket types found. Please go back to Step 2 and add ticket types."})})]}),4===O&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Preview Event"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review your event details before updating."})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[R&&(0,r.jsx)("div",{className:"w-full h-64 rounded-lg overflow-hidden border border-border",children:(0,r.jsx)("img",{src:R,alt:G.title,className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl font-bold",children:G.title}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:G.category})]}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:G.description})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-border",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Location"}),(0,r.jsx)("p",{className:"font-medium",children:G.location})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Start Date & Time"}),(0,r.jsx)("p",{className:"font-medium",children:G.start_date&&G.start_time?(0,S.WU)(new Date("".concat(G.start_date,"T").concat(G.start_time)),"MMM d, yyyy • h:mm a"):"Not set"})]})]})]}),(0,r.jsxs)("div",{className:"p-6 border border-border rounded-lg space-y-4",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"Ticket Types"}),W.map((e,t)=>{var s;return(0,r.jsx)("div",{className:"p-4 bg-muted rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),(null===(s=B[t])||void 0===s?void 0:s.description)&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:B[t].description})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"font-bold",children:0===e.price?"Free":"₦".concat(e.price.toLocaleString())}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.quantity," tickets"]})]})]})},t)})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-border",children:[(0,r.jsxs)(u.z,{type:"button",variant:"outline",onClick:()=>{P(e=>Math.max(e-1,1))},disabled:1===O,children:[(0,r.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Previous"]}),O<4?(0,r.jsxs)(u.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),Q()},variant:"hero",children:["Next",(0,r.jsx)(N.Z,{className:"w-4 h-4 ml-2"})]}):(0,r.jsx)(u.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),$()},variant:"hero",disabled:Y.isPending||q,children:Y.isPending||q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.Z,{className:"w-4 h-4 mr-2 animate-spin"}),q?"Uploading image...":"Updating event..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Update Event"]})})]})]})]}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"mb-2",children:"Event not found"}),(0,r.jsx)(k.default,{href:"/dashboard/creator",children:(0,r.jsx)(u.z,{variant:"outline",children:"Back to Dashboard"})})]})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"mb-2",children:"Access Denied"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Only creators can edit events."})]})})}c.Ry({id:c.Z_().optional(),name:c.Z_().min(1,"Ticket name is required"),price:c.Rx().min(0,"Price must be 0 or greater"),quantity:c.Rx().min(1,"Quantity must be at least 1")})},9205:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var r=s(2265);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,r.forwardRef)((e,t)=>{let{color:s="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:l="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...n,width:i,height:i,stroke:s,strokeWidth:c?24*Number(o)/Number(i):o,className:a("lucide",l),...m},[...u.map(e=>{let[t,s]=e;return(0,r.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let s=(0,r.forwardRef)((s,n)=>{let{className:c,...l}=s;return(0,r.createElement)(o,{ref:n,iconNode:t,className:a("lucide-".concat(i(e)),c),...l})});return s.displayName="".concat(e),s}},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6858:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},401:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},3113:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},1817:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return i.a}});var r=s(2972),i=s.n(r)},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},6629:function(e,t,s){"use strict";s.d(t,{DK:function(){return u},HG:function(){return o},Q6:function(){return h},Qn:function(){return c},TX:function(){return d},Y:function(){return n},ZD:function(){return l},ks:function(){return m},nk:function(){return a},vw:function(){return i}});var r=s(5526);let i=async()=>{let e=new Date().toISOString(),{data:t,error:s}=await r.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",e).order("created_at",{ascending:!1});if(s)throw s;return t},a=async e=>{let t=new Date().toISOString(),s=r.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",t);if(e.search&&e.search.trim()){let t=e.search.trim().replace(/%/g,"\\%").replace(/_/g,"\\_");s=s.or("title.ilike.%".concat(t,"%,description.ilike.%").concat(t,"%"))}e.category&&"all"!==e.category&&(s=s.eq("category",e.category)),e.location&&e.location.trim()&&(s=s.ilike("location","%".concat(e.location,"%"))),e.dateFrom&&(s=s.gte("date",e.dateFrom)),e.dateTo&&(s=s.lte("date",e.dateTo)),s=s.order("date",{ascending:!0});let{data:i,error:a}=await s;if(a)throw a;return i},n=async e=>{let{data:t,error:s}=await r.supabase.from("events").select("*, ticket_types(*)").eq("id",e).single();if(s)throw s;return t},o=async e=>{let{data:t,error:s}=await r.supabase.from("orders").select("*, event:events(*), tickets(*, ticket_type:ticket_types(*))").eq("id",e).single();if(s)throw s;return t},c=async e=>{let{data:t,error:s}=await r.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*)").eq("id",e).single();if(s)throw s;return t},l=async e=>{let{data:t,error:s}=await r.supabase.from("orders").select("id").eq("user_id",e).eq("payment_status","paid");if(s)throw s;if(!t||0===t.length)return[];let i=t.map(e=>e.id),{data:a,error:n}=await r.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*), order:orders(*)").eq("user_id",e).in("order_id",i).order("created_at",{ascending:!1});if(n)throw n;return a||[]},d=async e=>{let t=new Date().toISOString(),{data:s,error:i}=await r.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).gte("date",t).order("date",{ascending:!0});if(i)throw i;return s},u=async e=>{let t=new Date().toISOString(),{data:s,error:i}=await r.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).lt("date",t).order("date",{ascending:!1});if(i)throw i;return s},m=async e=>{let{data:t,error:s}=await r.supabase.from("creator_profiles").select("*").eq("user_id",e).maybeSingle();if(s)throw s;return t||null},h=async e=>{let{data:t,error:s}=await r.supabase.from("orders").select("*, tickets(*)").eq("event_id",e).eq("payment_status","paid");if(s)throw s;let{data:i,error:a}=await r.supabase.from("tickets").select("*, ticket_type:ticket_types(*)").eq("event_id",e);if(a)throw a;return{orders:t||[],tickets:i||[]}}},6840:function(e,t,s){"use strict";s.d(t,{WV:function(){return o},jH:function(){return c}});var r=s(2265),i=s(4887),a=s(7495),n=s(7437),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let s=(0,a.Z8)(`Primitive.${t}`),i=r.forwardRef((e,r)=>{let{asChild:i,...a}=e,o=i?s:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(o,{...a,ref:r})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function c(e,t){e&&i.flushSync(()=>e.dispatchEvent(t))}},2894:function(e,t,s){"use strict";s.d(t,{R:function(){return o},m:function(){return n}});var r=s(8238),i=s(7989),a=s(1255),n=class extends i.F{#e;#t;#s;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||o(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||("pending"===this.state.status?this.scheduleGc():this.#t.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#r({type:"continue"})};this.#s=(0,a.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#r({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#r({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});let s="pending"===this.state.status,r=!this.#s.canStart();try{if(s)t();else{this.#r({type:"pending",variables:e,isPaused:r}),await this.#t.config.onMutate?.(e,this);let t=await this.options.onMutate?.(e);t!==this.state.context&&this.#r({type:"pending",context:t,variables:e,isPaused:r})}let i=await this.#s.start();return await this.#t.config.onSuccess?.(i,e,this.state.context,this),await this.options.onSuccess?.(i,e,this.state.context),await this.#t.config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,e,this.state.context),this.#r({type:"success",data:i}),i}catch(t){try{throw await this.#t.config.onError?.(t,e,this.state.context,this),await this.options.onError?.(t,e,this.state.context),await this.#t.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,t,e,this.state.context),t}finally{this.#r({type:"error",error:t})}}finally{this.#t.runNext(this)}}#r(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),r.Vr.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},1770:function(e,t,s){"use strict";s.d(t,{D:function(){return d}});var r=s(2265),i=s(2894),a=s(8238),n=s(4112),o=s(5345),c=class extends n.l{#i;#a=void 0;#n;#o;constructor(e,t){super(),this.#i=e,this.setOptions(t),this.bindMethods(),this.#c()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#i.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#i.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#c(),this.#l(e)}getCurrentResult(){return this.#a}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#c(),this.#l()}mutate(e,t){return this.#o=t,this.#n?.removeObserver(this),this.#n=this.#i.getMutationCache().build(this.#i,this.options),this.#n.addObserver(this),this.#n.execute(e)}#c(){let e=this.#n?.state??(0,i.R)();this.#a={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#l(e){a.Vr.batch(()=>{if(this.#o&&this.hasListeners()){let t=this.#a.variables,s=this.#a.context;e?.type==="success"?(this.#o.onSuccess?.(e.data,t,s),this.#o.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#o.onError?.(e.error,t,s),this.#o.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#a)})})}},l=s(9827);function d(e,t){let s=(0,l.NL)(t),[i]=r.useState(()=>new c(s,e));r.useEffect(()=>{i.setOptions(e)},[i,e]);let n=r.useSyncExternalStore(r.useCallback(e=>i.subscribe(a.Vr.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),d=r.useCallback((e,t)=>{i.mutate(e,t).catch(o.ZT)},[i]);if(n.error&&(0,o.L3)(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:d,mutateAsync:n.mutate}}}},function(e){e.O(0,[182,972,730,713,438,818,817,971,117,560],function(){return e(e.s=1729)}),_N_E=e.O()}]);