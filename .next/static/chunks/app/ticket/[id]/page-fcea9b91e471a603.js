(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{8553:function(e,t,s){Promise.resolve().then(s.bind(s,3499))},3499:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var r=s(7437),i=s(9376),a=s(9827),n=s(1713),o=s(1770),c=s(2381),d=s(9174),l=s(6629),u=s(1980),h=s(1817);let m=(0,s(9205).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var p=s(2934),f=s(5080),x=s(1047),y=s(3774),v=s(2369),b=s(4014),g=s(24),_=s(2834),w=s(4438),j=s(4362);function k(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),{user:s}=(0,j.a)(),k=(0,a.NL)(),N=e.id,{data:C,isLoading:q,error:M}=(0,n.a)({queryKey:["ticket",N],queryFn:()=>(0,l.Qn)(N),enabled:!!N}),S=(0,o.D)({mutationFn:async()=>{if(!s)throw Error("You must be logged in to validate tickets");if(!C)throw Error("Ticket not found");return await (0,u.li)(C.id,s.id)},onSuccess:()=>{w.Am.success("Ticket validated successfully!"),k.invalidateQueries({queryKey:["ticket",N]})},onError:e=>{w.Am.error(e.message||"Failed to validate ticket")}});if(q)return(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)(g.default,{}),(0,r.jsx)("div",{className:"pt-20 min-h-screen flex items-center justify-center",children:(0,r.jsx)(h.Z,{className:"w-8 h-8 animate-spin"})}),(0,r.jsx)(_.Z,{})]});if(M||!C)return(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)(g.default,{}),(0,r.jsx)("main",{className:"pt-20",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto bg-card rounded-2xl border border-border p-8 text-center",children:[(0,r.jsx)(m,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Ticket Not Found"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6",children:"The ticket you're looking for doesn't exist or has been removed."}),(0,r.jsx)(c.z,{onClick:()=>t.push("/"),children:"Go to Home"})]})})}),(0,r.jsx)(_.Z,{})]});let Z=C.event,E=C.ticket_type,O="used"===C.status,D="cancelled"===C.status,F="valid"===C.status,R=F&&s&&(null==Z?void 0:Z.creator_id)===s.id;return(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)(g.default,{}),(0,r.jsx)("main",{className:"pt-20",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[F&&(0,r.jsxs)(d.C,{className:"bg-green-500 text-white text-lg px-4 py-2",children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Valid"]}),O&&(0,r.jsxs)(d.C,{className:"bg-blue-500 text-white text-lg px-4 py-2",children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Validated"]}),D&&(0,r.jsxs)(d.C,{className:"bg-red-500 text-white text-lg px-4 py-2",children:[(0,r.jsx)(m,{className:"w-4 h-4 mr-2"}),"Cancelled"]})]}),(0,r.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-8 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:(0,r.jsx)(f.Z,{className:"w-6 h-6 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Ticket Details"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground font-mono",children:["ID: ",C.id.slice(0,8),"..."]})]})]}),(0,r.jsxs)("div",{className:"mb-6 pb-6 border-b border-border",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:(null==E?void 0:E.name)||"General Admission"}),(null==E?void 0:E.description)&&(0,r.jsx)("p",{className:"text-muted-foreground",children:E.description}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)(d.C,{variant:"outline",className:"text-lg",children:(null==E?void 0:E.is_free)?"Free":"₦".concat(Number((null==E?void 0:E.price)||0).toLocaleString())})})]}),Z&&(0,r.jsxs)("div",{className:"mb-6 pb-6 border-b border-border",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Event Information"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-bold text-xl mb-2",children:Z.title}),(0,r.jsx)(d.C,{className:"mb-3",children:Z.category})]}),Z.description&&(0,r.jsx)("p",{className:"text-muted-foreground",children:Z.description}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5 text-primary mt-0.5 shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Date & Time"}),(0,r.jsx)("p",{className:"font-semibold",children:(0,b.WU)(new Date(Z.date),"MMM d, yyyy • h:mm a")})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(y.Z,{className:"w-5 h-5 text-primary mt-0.5 shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Location"}),(0,r.jsx)("p",{className:"font-semibold",children:Z.location})]})]})]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Ticket Holder"}),(0,r.jsxs)("div",{className:"space-y-3",children:[C.order_id&&(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(v.Z,{className:"w-5 h-5 text-muted-foreground"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Order ID"}),(0,r.jsx)("p",{className:"font-semibold font-mono text-sm",children:C.order_id})]})]}),C.checked_in_at&&(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(p.Z,{className:"w-5 h-5 text-green-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Validated At"}),(0,r.jsx)("p",{className:"font-semibold",children:(0,b.WU)(new Date(C.checked_in_at),"MMM d, yyyy • h:mm a")})]})]})]})]}),R&&(0,r.jsx)("div",{className:"pt-6 border-t border-border",children:(0,r.jsx)(c.z,{onClick:()=>S.mutate(),disabled:S.isPending||O,className:"w-full",size:"lg",variant:"hero",children:S.isPending?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Validating..."]}):O?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Already Validated"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Validate Ticket"]})})}),!R&&F&&s&&(null==Z?void 0:Z.creator_id)!==s.id&&(0,r.jsx)("div",{className:"pt-6 border-t border-border",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center",children:"Only the event creator can validate tickets."})}),!s&&(0,r.jsxs)("div",{className:"pt-6 border-t border-border",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center mb-4",children:"Please log in as the event creator to validate this ticket."}),(0,r.jsx)(c.z,{onClick:()=>t.push("/auth/signin"),variant:"outline",className:"w-full",children:"Sign In"})]})]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(c.z,{variant:"outline",onClick:()=>t.back(),children:"Go Back"})})]})})}),(0,r.jsx)(_.Z,{})]})}},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},2934:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},9219:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]])},7760:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]])},1817:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3774:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2351:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]])},4767:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]])},2834:function(e,t,s){"use strict";var r=s(7437),i=s(5080),a=s(7760),n=s(2351),o=s(9219),c=s(4767),d=s(2381);t.Z=e=>{let{showNewsletter:t=!1}=e;return(0,r.jsxs)("footer",{id:"about",className:"bg-card border-t border-border",children:[t&&(0,r.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,r.jsxs)("div",{className:"bg-primary rounded-3xl p-8 md:p-12 text-center",children:[(0,r.jsx)("h3",{className:"text-2xl md:text-3xl font-bold text-primary-foreground mb-4",children:"Never Miss an Event! \uD83C\uDFAB"}),(0,r.jsx)("p",{className:"text-primary-foreground/80 mb-6 max-w-md mx-auto",children:"Subscribe to get notified about new events, exclusive deals, and early bird tickets."}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 max-w-md mx-auto",children:[(0,r.jsx)("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-5 py-3 rounded-full bg-primary-foreground/20 border border-primary-foreground/30 text-primary-foreground placeholder:text-primary-foreground/60 outline-none focus:ring-2 focus:ring-primary-foreground/50"}),(0,r.jsx)(d.z,{variant:"secondary",size:"lg",children:"Subscribe"})]})]})}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-8",children:[(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsxs)("a",{href:"/",className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-primary flex items-center justify-center",children:(0,r.jsx)(i.Z,{className:"w-5 h-5 text-primary-foreground"})}),(0,r.jsx)("span",{className:"text-xl font-bold text-primary",children:"Frecks"})]}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Your go-to platform for discovering and booking campus events. Made by students, for students."}),(0,r.jsx)("div",{className:"flex gap-3",children:[a.Z,n.Z,o.Z,c.Z].map((e,t)=>(0,r.jsx)("a",{href:"#",className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center hover:bg-primary hover:text-primary-foreground transition-colors",children:(0,r.jsx)(e,{className:"w-5 h-5"})},t))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-4",children:"Company"}),(0,r.jsx)("ul",{className:"space-y-2",children:["About Us","Careers","Blog","Press"].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-4",children:"Support"}),(0,r.jsx)("ul",{className:"space-y-2",children:["Help Center","Safety","Terms","Privacy"].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-4",children:"For Venues"}),(0,r.jsx)("ul",{className:"space-y-2",children:["Partner With Us","List Your Event","Pricing","Resources"].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]})]})}),(0,r.jsx)("div",{className:"border-t border-border",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-muted-foreground",children:[(0,r.jsx)("p",{children:"\xa9 2026 Frecks. All rights reserved."}),(0,r.jsx)("p",{children:"Made with \uD83E\uDDE1 for students everywhere"})]})})})]})}},9174:function(e,t,s){"use strict";s.d(t,{C:function(){return o}});var r=s(7437);s(2265);var i=s(535),a=s(3448);let n=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:s,...i}=e;return(0,r.jsx)("div",{className:(0,a.cn)(n({variant:s}),t),...i})}},1980:function(e,t,s){"use strict";s.d(t,{Bt:function(){return n},D0:function(){return c},LV:function(){return o},Lj:function(){return l},eJ:function(){return a},li:function(){return d},yM:function(){return i}});var r=s(5526);let i=async e=>{console.log("Creating event in database...",{creator_id:e.creator_id,title:e.title,category:e.category});let{data:t,error:s}=await r.supabase.from("events").insert({creator_id:e.creator_id,title:e.title,description:e.description,category:e.category,image_url:e.image_url,date:e.date,location:e.location,is_featured:e.is_featured||!1,status:"active"}).select().single();if(s)throw console.error("Event creation error:",s),Error("Failed to create event: ".concat(s.message," (").concat(s.code||"unknown",")"));if(!t)throw Error("Event creation returned no data");console.log("Event created, ID:",t.id),console.log("Creating ticket types...",e.ticket_types.length);let i=e.ticket_types.map(e=>({event_id:t.id,name:e.name,description:e.description,price:e.price,quantity:e.quantity,is_free:e.is_free||!1})),{error:a}=await r.supabase.from("ticket_types").insert(i);if(a)throw console.error("Ticket types creation error:",a),Error("Failed to create ticket types: ".concat(a.message," (").concat(a.code||"unknown",")"));return console.log("Ticket types created successfully"),t},a=async(e,t)=>{let{data:s,error:i}=await r.supabase.from("events").update({title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured||!1,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw Error("Failed to update event: ".concat(i.message));if(!s)throw Error("Event update returned no data");let{data:a}=await r.supabase.from("ticket_types").select("id").eq("event_id",e),n=new Set((null==a?void 0:a.map(e=>e.id))||[]),o=new Set(t.ticket_types.filter(e=>e.id).map(e=>e.id)),c=Array.from(n).filter(e=>!o.has(e));for(let s of(c.length>0&&await r.supabase.from("ticket_types").delete().in("id",c),t.ticket_types))s.id&&n.has(s.id)?await r.supabase.from("ticket_types").update({name:s.name,description:s.description,price:s.price,quantity:s.quantity,is_free:s.is_free||!1}).eq("id",s.id):await r.supabase.from("ticket_types").insert({event_id:e,name:s.name,description:s.description,price:s.price,quantity:s.quantity,is_free:s.is_free||!1});return s},n=async(e,t)=>{let{data:s,error:i}=await r.supabase.from("events").select("*").eq("id",e).eq("creator_id",t).single();if(i)throw i;if(!s)throw Error("Event not found or access denied");let{error:a}=await r.supabase.from("deleted_events").insert({original_event_id:s.id,creator_id:s.creator_id,title:s.title,description:s.description,category:s.category,image_url:s.image_url,date:s.date,location:s.location,is_featured:s.is_featured,status:"cancelled",deleted_by:t,created_at:s.created_at,updated_at:s.updated_at});if(a)throw a;let{error:n}=await r.supabase.from("events").delete().eq("id",e).eq("creator_id",t);if(n)throw n;return{success:!0}},o=async e=>{let{data:t,error:s}=await r.supabase.from("orders").insert({user_id:e.user_id,event_id:e.event_id,email:e.email,full_name:e.full_name,total_amount:e.total_amount,paystack_reference:e.paystack_reference,payment_status:e.payment_status||"pending"}).select().single();if(s)throw s;let i=e.tickets.map(s=>({ticket_type_id:s.ticket_type_id,event_id:e.event_id,user_id:e.user_id,order_id:t.id,qr_code:s.qr_code,qr_code_data:s.qr_code_data,status:(e.payment_status,"valid")})),{error:a}=await r.supabase.from("tickets").insert(i);if(a)throw a;if("paid"===e.payment_status){let t=new Map;for(let s of e.tickets){let e=t.get(s.ticket_type_id)||0;t.set(s.ticket_type_id,e+1)}for(let[e,s]of t){let{data:t}=await r.supabase.from("ticket_types").select("sold_count").eq("id",e).single();t&&await r.supabase.from("ticket_types").update({sold_count:t.sold_count+s}).eq("id",e)}}return t},c=async(e,t)=>{let{data:s,error:i}=await r.supabase.from("creator_profiles").upsert({user_id:e,...t}).select().single();if(i)throw i;return s},d=async(e,t)=>{var s;let{data:i,error:a}=await r.supabase.from("tickets").select("*, event:events!inner(creator_id, id)").eq("id",e).single();if(a||!i)throw Error("Ticket not found");if((null===(s=i.event)||void 0===s?void 0:s.creator_id)!==t)throw Error("Only the event creator can validate tickets");if("used"===i.status)throw Error("Ticket has already been validated");if("cancelled"===i.status)throw Error("Ticket has been cancelled");let{error:n}=await r.supabase.from("tickets").update({status:"used",checked_in_at:new Date().toISOString(),checked_in_by:t}).eq("id",e);if(n)throw Error("Failed to validate ticket: ".concat(n.message));return await r.supabase.from("qr_scans").insert({ticket_id:e,scanned_by:t,scan_result:"valid"}),{success:!0,ticketId:e}},l=async(e,t)=>{let{data:s,error:i}=await r.supabase.from("users").update({full_name:t.full_name,gender:t.gender,school:t.school,avatar_name:t.avatar_name,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return s}},6629:function(e,t,s){"use strict";s.d(t,{DK:function(){return u},HG:function(){return o},Q6:function(){return m},Qn:function(){return c},TX:function(){return l},Y:function(){return n},ZD:function(){return d},ks:function(){return h},nk:function(){return a},vw:function(){return i}});var r=s(5526);let i=async()=>{let e=new Date().toISOString(),{data:t,error:s}=await r.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",e).order("created_at",{ascending:!1});if(s)throw s;return t},a=async e=>{let t=new Date().toISOString(),s=r.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",t);if(e.search&&e.search.trim()){let t=e.search.trim().replace(/%/g,"\\%").replace(/_/g,"\\_");s=s.or("title.ilike.%".concat(t,"%,description.ilike.%").concat(t,"%"))}e.category&&"all"!==e.category&&(s=s.eq("category",e.category)),e.location&&e.location.trim()&&(s=s.ilike("location","%".concat(e.location,"%"))),e.dateFrom&&(s=s.gte("date",e.dateFrom)),e.dateTo&&(s=s.lte("date",e.dateTo)),s=s.order("date",{ascending:!0});let{data:i,error:a}=await s;if(a)throw a;return i},n=async e=>{let{data:t,error:s}=await r.supabase.from("events").select("*, ticket_types(*)").eq("id",e).single();if(s)throw s;return t},o=async e=>{let{data:t,error:s}=await r.supabase.from("orders").select("*, event:events(*), tickets(*, ticket_type:ticket_types(*))").eq("id",e).single();if(s)throw s;return t},c=async e=>{let{data:t,error:s}=await r.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*)").eq("id",e).single();if(s)throw s;return t},d=async e=>{let{data:t,error:s}=await r.supabase.from("orders").select("id").eq("user_id",e).eq("payment_status","paid");if(s)throw s;if(!t||0===t.length)return[];let i=t.map(e=>e.id),{data:a,error:n}=await r.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*), order:orders(*)").eq("user_id",e).in("order_id",i).order("created_at",{ascending:!1});if(n)throw n;return a||[]},l=async e=>{let t=new Date().toISOString(),{data:s,error:i}=await r.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).gte("date",t).order("date",{ascending:!0});if(i)throw i;return s},u=async e=>{let t=new Date().toISOString(),{data:s,error:i}=await r.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).lt("date",t).order("date",{ascending:!1});if(i)throw i;return s},h=async e=>{let{data:t,error:s}=await r.supabase.from("creator_profiles").select("*").eq("user_id",e).maybeSingle();if(s)throw s;return t||null},m=async e=>{let{data:t,error:s}=await r.supabase.from("orders").select("*, tickets(*)").eq("event_id",e).eq("payment_status","paid");if(s)throw s;let{data:i,error:a}=await r.supabase.from("tickets").select("*, ticket_type:ticket_types(*)").eq("event_id",e);if(a)throw a;return{orders:t||[],tickets:i||[]}}},2894:function(e,t,s){"use strict";s.d(t,{R:function(){return o},m:function(){return n}});var r=s(8238),i=s(7989),a=s(1255),n=class extends i.F{#e;#t;#s;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||o(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||("pending"===this.state.status?this.scheduleGc():this.#t.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#r({type:"continue"})};this.#s=(0,a.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#r({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#r({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});let s="pending"===this.state.status,r=!this.#s.canStart();try{if(s)t();else{this.#r({type:"pending",variables:e,isPaused:r}),await this.#t.config.onMutate?.(e,this);let t=await this.options.onMutate?.(e);t!==this.state.context&&this.#r({type:"pending",context:t,variables:e,isPaused:r})}let i=await this.#s.start();return await this.#t.config.onSuccess?.(i,e,this.state.context,this),await this.options.onSuccess?.(i,e,this.state.context),await this.#t.config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,e,this.state.context),this.#r({type:"success",data:i}),i}catch(t){try{throw await this.#t.config.onError?.(t,e,this.state.context,this),await this.options.onError?.(t,e,this.state.context),await this.#t.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,t,e,this.state.context),t}finally{this.#r({type:"error",error:t})}}finally{this.#t.runNext(this)}}#r(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),r.Vr.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},1770:function(e,t,s){"use strict";s.d(t,{D:function(){return l}});var r=s(2265),i=s(2894),a=s(8238),n=s(4112),o=s(5345),c=class extends n.l{#i;#a=void 0;#n;#o;constructor(e,t){super(),this.#i=e,this.setOptions(t),this.bindMethods(),this.#c()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#i.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#i.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#c(),this.#d(e)}getCurrentResult(){return this.#a}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#c(),this.#d()}mutate(e,t){return this.#o=t,this.#n?.removeObserver(this),this.#n=this.#i.getMutationCache().build(this.#i,this.options),this.#n.addObserver(this),this.#n.execute(e)}#c(){let e=this.#n?.state??(0,i.R)();this.#a={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#d(e){a.Vr.batch(()=>{if(this.#o&&this.hasListeners()){let t=this.#a.variables,s=this.#a.context;e?.type==="success"?(this.#o.onSuccess?.(e.data,t,s),this.#o.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#o.onError?.(e.error,t,s),this.#o.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#a)})})}},d=s(9827);function l(e,t){let s=(0,d.NL)(t),[i]=r.useState(()=>new c(s,e));r.useEffect(()=>{i.setOptions(e)},[i,e]);let n=r.useSyncExternalStore(r.useCallback(e=>i.subscribe(a.Vr.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=r.useCallback((e,t)=>{i.mutate(e,t).catch(o.ZT)},[i]);if(n.error&&(0,o.L3)(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}}},function(e){e.O(0,[227,182,972,506,642,850,823,730,666,713,438,24,971,117,560],function(){return e(e.s=8553)}),_N_E=e.O()}]);