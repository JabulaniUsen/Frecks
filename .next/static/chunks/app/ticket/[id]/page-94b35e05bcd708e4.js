(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7295],{18553:function(e,t,r){Promise.resolve().then(r.bind(r,53522))},53522:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return N}});var a=r(57437),s=r(99376),i=r(29827),n=r(11713),o=r(21770),d=r(12381),c=r(69174),l=r(96629),u=r(61980),m=r(51817),f=r(99388),p=r(92934),x=r(95080),h=r(31047),b=r(83774),g=r(92369),_=r(64014),v=r(88361),w=r(92834),y=r(14438),j=r(14362);function N(){let e=(0,s.useParams)(),t=(0,s.useRouter)(),{user:r}=(0,j.a)(),N=(0,i.NL)(),k=e.id,{data:q,isLoading:E,error:S}=(0,n.a)({queryKey:["ticket",k],queryFn:()=>(0,l.Qn)(k),enabled:!!k}),D=(0,o.D)({mutationFn:async()=>{if(!r)throw Error("You must be logged in to validate tickets");if(!q)throw Error("Ticket not found");return await (0,u.li)(q.id,r.id)},onSuccess:()=>{y.Am.success("Ticket validated successfully!"),N.invalidateQueries({queryKey:["ticket",k]})},onError:e=>{y.Am.error(e.message||"Failed to validate ticket")}});if(E)return(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)(v.default,{}),(0,a.jsx)("div",{className:"pt-20 min-h-screen flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-8 h-8 animate-spin"})}),(0,a.jsx)(w.Z,{})]});if(S||!q)return(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)(v.default,{}),(0,a.jsx)("main",{className:"pt-20",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto bg-card rounded-2xl border border-border p-8 text-center",children:[(0,a.jsx)(f.Z,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Ticket Not Found"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"The ticket you're looking for doesn't exist or has been removed."}),(0,a.jsx)(d.z,{onClick:()=>t.push("/"),children:"Go to Home"})]})})}),(0,a.jsx)(w.Z,{})]});let Z=q.event,C=q.ticket_type,F="used"===q.status,I="cancelled"===q.status,T="valid"===q.status,O=T&&r&&(null==Z?void 0:Z.creator_id)===r.id;return(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)(v.default,{}),(0,a.jsx)("main",{className:"pt-20",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[T&&(0,a.jsxs)(c.C,{className:"bg-green-500 text-white text-lg px-4 py-2",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Valid"]}),F&&(0,a.jsxs)(c.C,{className:"bg-blue-500 text-white text-lg px-4 py-2",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Validated"]}),I&&(0,a.jsxs)(c.C,{className:"bg-red-500 text-white text-lg px-4 py-2",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Cancelled"]})]}),(0,a.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-8 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(x.Z,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Ticket Details"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground font-mono",children:["ID: ",q.id.slice(0,8),"..."]})]})]}),(0,a.jsxs)("div",{className:"mb-6 pb-6 border-b border-border",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:(null==C?void 0:C.name)||"General Admission"}),(null==C?void 0:C.description)&&(0,a.jsx)("p",{className:"text-muted-foreground",children:C.description}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(c.C,{variant:"outline",className:"text-lg",children:(null==C?void 0:C.is_free)?"Free":"₦".concat(Number((null==C?void 0:C.price)||0).toLocaleString())})})]}),Z&&(0,a.jsxs)("div",{className:"mb-6 pb-6 border-b border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Event Information"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-xl mb-2",children:Z.title}),(0,a.jsx)(c.C,{className:"mb-3",children:Z.category})]}),Z.description&&(0,a.jsx)("p",{className:"text-muted-foreground",children:Z.description}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5 text-primary mt-0.5 shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Date & Time"}),(0,a.jsx)("p",{className:"font-semibold",children:(0,_.WU)(new Date(Z.date),"MMM d, yyyy • h:mm a")})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(b.Z,{className:"w-5 h-5 text-primary mt-0.5 shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Location"}),(0,a.jsx)("p",{className:"font-semibold",children:Z.location})]})]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Ticket Holder"}),(0,a.jsxs)("div",{className:"space-y-3",children:[q.order_id&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(g.Z,{className:"w-5 h-5 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Order ID"}),(0,a.jsx)("p",{className:"font-semibold font-mono text-sm",children:q.order_id})]})]}),q.checked_in_at&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(p.Z,{className:"w-5 h-5 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Validated At"}),(0,a.jsx)("p",{className:"font-semibold",children:(0,_.WU)(new Date(q.checked_in_at),"MMM d, yyyy • h:mm a")})]})]})]})]}),O&&(0,a.jsx)("div",{className:"pt-6 border-t border-border",children:(0,a.jsx)(d.z,{onClick:()=>D.mutate(),disabled:D.isPending||F,className:"w-full",size:"lg",variant:"hero",children:D.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Validating..."]}):F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Already Validated"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Validate Ticket"]})})}),!O&&T&&r&&(null==Z?void 0:Z.creator_id)!==r.id&&(0,a.jsx)("div",{className:"pt-6 border-t border-border",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center",children:"Only the event creator can validate tickets."})}),!r&&(0,a.jsxs)("div",{className:"pt-6 border-t border-border",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center mb-4",children:"Please log in as the event creator to validate this ticket."}),(0,a.jsx)(d.z,{onClick:()=>t.push("/auth/signin"),variant:"outline",className:"w-full",children:"Sign In"})]})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(d.z,{variant:"outline",onClick:()=>t.back(),children:"Go Back"})})]})})}),(0,a.jsx)(w.Z,{})]})}},92834:function(e,t,r){"use strict";var a=r(57437),s=r(27648),i=r(33145),n=r(37760),o=r(42351),d=r(79219),c=r(74767),l=r(12381);t.Z=e=>{let{showNewsletter:t=!1}=e;return(0,a.jsxs)("footer",{id:"about",className:"bg-card border-t border-border",children:[t&&(0,a.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,a.jsxs)("div",{className:"bg-primary rounded-3xl p-8 md:p-12 text-center",children:[(0,a.jsx)("h3",{className:"text-2xl md:text-3xl font-bold text-primary-foreground mb-4",children:"Never Miss an Event! \uD83C\uDFAB"}),(0,a.jsx)("p",{className:"text-primary-foreground/80 mb-6 max-w-md mx-auto",children:"Subscribe to get notified about new events, exclusive deals, and early bird tickets."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 max-w-md mx-auto",children:[(0,a.jsx)("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-5 py-3 rounded-full bg-primary-foreground/20 border border-primary-foreground/30 text-primary-foreground placeholder:text-primary-foreground/60 outline-none focus:ring-2 focus:ring-primary-foreground/50"}),(0,a.jsx)(l.z,{variant:"secondary",size:"lg",children:"Subscribe"})]})]})}),(0,a.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-8",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(s.default,{href:"/",className:"flex items-center gap-2 mb-4 relative w-32 h-12",children:(0,a.jsx)(i.default,{src:"/logo.png",alt:"Frecks",fill:!0,className:"object-contain object-left"})}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Your go-to platform for discovering and booking campus events. Made by students, for students."}),(0,a.jsx)("div",{className:"flex gap-3",children:[n.Z,o.Z,d.Z,c.Z].map((e,t)=>(0,a.jsx)("a",{href:"#",className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center hover:bg-primary hover:text-primary-foreground transition-colors",children:(0,a.jsx)(e,{className:"w-5 h-5"})},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-4",children:"Company"}),(0,a.jsx)("ul",{className:"space-y-2",children:["About Us","Careers","Blog","Press"].map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-4",children:"Support"}),(0,a.jsx)("ul",{className:"space-y-2",children:["Help Center","Safety","Terms","Privacy"].map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-4",children:"For Venues"}),(0,a.jsx)("ul",{className:"space-y-2",children:["Partner With Us","List Your Event","Pricing","Resources"].map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]})]})}),(0,a.jsx)("div",{className:"border-t border-border",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsx)("p",{children:"\xa9 2026 Frecks. All rights reserved."}),(0,a.jsx)("p",{children:"Made with \uD83E\uDDE1 for students everywhere"})]})})})]})}},69174:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var a=r(57437);r(2265);var s=r(90535),i=r(93448);let n=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)(n({variant:r}),t),...s})}},61980:function(e,t,r){"use strict";r.d(t,{Bt:function(){return n},D0:function(){return d},E$:function(){return h},LV:function(){return o},Lj:function(){return l},aE:function(){return x},cD:function(){return b},eJ:function(){return i},li:function(){return c},ob:function(){return p},rM:function(){return u},y6:function(){return m},yM:function(){return s},zf:function(){return f}});var a=r(5526);let s=async e=>{console.log("Creating event in database...",{creator_id:e.creator_id,title:e.title,category:e.category});let{data:t,error:r}=await a.supabase.from("events").insert({creator_id:e.creator_id,title:e.title,description:e.description,category:e.category,image_url:e.image_url,date:e.date,location:e.location,is_featured:e.is_featured||!1,status:"active"}).select().single();if(r)throw console.error("Event creation error:",r),Error("Failed to create event: ".concat(r.message," (").concat(r.code||"unknown",")"));if(!t)throw Error("Event creation returned no data");console.log("Event created, ID:",t.id),console.log("Creating ticket types...",e.ticket_types.length);let s=e.ticket_types.map(e=>({event_id:t.id,name:e.name,description:e.description,price:e.price,quantity:e.quantity,is_free:e.is_free||!1})),{error:i}=await a.supabase.from("ticket_types").insert(s);if(i)throw console.error("Ticket types creation error:",i),Error("Failed to create ticket types: ".concat(i.message," (").concat(i.code||"unknown",")"));return console.log("Ticket types created successfully"),t},i=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("events").update({title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured||!1,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw Error("Failed to update event: ".concat(s.message));if(!r)throw Error("Event update returned no data");let{data:i}=await a.supabase.from("ticket_types").select("id").eq("event_id",e),n=new Set((null==i?void 0:i.map(e=>e.id))||[]),o=new Set(t.ticket_types.filter(e=>e.id).map(e=>e.id)),d=Array.from(n).filter(e=>!o.has(e));for(let r of(d.length>0&&await a.supabase.from("ticket_types").delete().in("id",d),t.ticket_types))r.id&&n.has(r.id)?await a.supabase.from("ticket_types").update({name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1}).eq("id",r.id):await a.supabase.from("ticket_types").insert({event_id:e,name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1});return r},n=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("events").select("*").eq("id",e).eq("creator_id",t).single();if(s)throw s;if(!r)throw Error("Event not found or access denied");let{error:i}=await a.supabase.from("deleted_events").insert({original_event_id:r.id,creator_id:r.creator_id,title:r.title,description:r.description,category:r.category,image_url:r.image_url,date:r.date,location:r.location,is_featured:r.is_featured,status:"cancelled",deleted_by:t,created_at:r.created_at,updated_at:r.updated_at});if(i)throw i;let{error:n}=await a.supabase.from("events").delete().eq("id",e).eq("creator_id",t);if(n)throw n;return{success:!0}},o=async e=>{let{data:t,error:r}=await a.supabase.from("orders").insert({user_id:e.user_id,event_id:e.event_id,email:e.email,full_name:e.full_name,total_amount:e.total_amount,paystack_reference:e.paystack_reference,payment_status:e.payment_status||"pending"}).select().single();if(r)throw r;let s=e.tickets.map(r=>({ticket_type_id:r.ticket_type_id,event_id:e.event_id,user_id:e.user_id,order_id:t.id,qr_code:r.qr_code,qr_code_data:r.qr_code_data,status:(e.payment_status,"valid")})),{error:i}=await a.supabase.from("tickets").insert(s);if(i)throw i;if("paid"===e.payment_status){let t=new Map;for(let r of e.tickets){let e=t.get(r.ticket_type_id)||0;t.set(r.ticket_type_id,e+1)}for(let[e,r]of t){let{data:t}=await a.supabase.from("ticket_types").select("sold_count").eq("id",e).single();t&&await a.supabase.from("ticket_types").update({sold_count:t.sold_count+r}).eq("id",e)}}return t},d=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("creator_profiles").upsert({user_id:e,...t}).select().single();if(s)throw s;return r},c=async(e,t)=>{var r;let{data:s,error:i}=await a.supabase.from("tickets").select("*, event:events!inner(creator_id, id)").eq("id",e).single();if(i||!s)throw Error("Ticket not found");if((null===(r=s.event)||void 0===r?void 0:r.creator_id)!==t)throw Error("Only the event creator can validate tickets");if("used"===s.status)throw Error("Ticket has already been validated");if("cancelled"===s.status)throw Error("Ticket has been cancelled");let{error:n}=await a.supabase.from("tickets").update({status:"used",checked_in_at:new Date().toISOString(),checked_in_by:t}).eq("id",e);if(n)throw Error("Failed to validate ticket: ".concat(n.message));return await a.supabase.from("qr_scans").insert({ticket_id:e,scanned_by:t,scan_result:"valid"}),{success:!0,ticketId:e}},l=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("users").update({full_name:t.full_name,gender:t.gender,school:t.school,avatar_name:t.avatar_name,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return r},u=async e=>{let{data:t,error:r}=await a.supabase.from("events").select("*").eq("id",e).single();if(r)throw r;if(!t)throw Error("Event not found");let{error:s}=await a.supabase.from("deleted_events").insert({original_event_id:t.id,creator_id:t.creator_id,title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured,status:"cancelled",deleted_by:t.creator_id,created_at:t.created_at,updated_at:t.updated_at});if(s)throw s;let{error:i}=await a.supabase.from("events").delete().eq("id",e);if(i)throw i;return{success:!0}},m=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("users").update({role:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;if("creator"===t){let{data:t}=await a.supabase.from("creator_profiles").select("id").eq("user_id",e).maybeSingle();t||await a.supabase.from("creator_profiles").insert({user_id:e})}return r},f=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("users").update({banned:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return r},p=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("events").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return r},x=async(e,t,r)=>{let{data:s,error:i}=await a.supabase.from("creator_profiles").select("account_balance").eq("user_id",e).single();if(i)throw i;if(!s)throw Error("Creator profile not found");let n=Number(s.account_balance)||0;if(n<t)throw Error("Insufficient balance. Available: ₦".concat(n.toLocaleString()));let{data:o,error:d}=await a.supabase.from("withdrawals").insert({creator_id:e,amount:t,status:"pending",...r}).select().single();if(d)throw d;let{error:c}=await a.supabase.from("creator_profiles").update({account_balance:n-t}).eq("user_id",e);if(c)throw c;return await a.supabase.from("wallet_transactions").insert({creator_id:e,type:"withdrawal",amount:-t,status:"pending",description:"Withdrawal request - ".concat(r.bank_name," ").concat(r.bank_account_number)}),o},h=async(e,t,r)=>{let{data:s,error:i}=await a.supabase.from("withdrawals").update({status:"approved",approved_by:t,approved_at:new Date().toISOString(),admin_note:r}).eq("id",e).select().single();if(i)throw i;return await a.supabase.from("wallet_transactions").update({status:"completed"}).eq("creator_id",s.creator_id).eq("amount",-s.amount).eq("type","withdrawal").eq("status","pending"),s},b=async(e,t,r)=>{let{data:s,error:i}=await a.supabase.from("withdrawals").select("*").eq("id",e).single();if(i)throw i;if(!s)throw Error("Withdrawal not found");let{error:n}=await a.supabase.from("withdrawals").update({status:"rejected",approved_by:t,rejected_at:new Date().toISOString(),admin_note:r}).eq("id",e);if(n)throw n;let{data:o}=await a.supabase.from("creator_profiles").select("account_balance").eq("user_id",s.creator_id).single();if(o){let e=Number(o.account_balance)||0;await a.supabase.from("creator_profiles").update({account_balance:e+Number(s.amount)}).eq("user_id",s.creator_id)}return await a.supabase.from("wallet_transactions").update({status:"failed"}).eq("creator_id",s.creator_id).eq("amount",-s.amount).eq("type","withdrawal").eq("status","pending"),s}}},function(e){e.O(0,[3227,4182,2972,5506,2642,3850,5730,758,5256,2893,1713,4438,3706,9913,8361,2971,2117,1744],function(){return e(e.s=18553)}),_N_E=e.O()}]);