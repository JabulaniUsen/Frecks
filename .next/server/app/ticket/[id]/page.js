(()=>{var e={};e.id=295,e.ids=[295],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},39346:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>l,routeModule:()=>p,tree:()=>d}),r(67714),r(84752),r(96560);var a=r(23191),s=r(88716),i=r(37922),n=r.n(i),o=r(95231),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);r.d(t,c);let d=["",{children:["ticket",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,67714)),"/Users/mac/Desktop/Client projects/frecks-new/app/ticket/[id]/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,24697))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,84752)),"/Users/mac/Desktop/Client projects/frecks-new/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"/Users/mac/Desktop/Client projects/frecks-new/app/not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,24697))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["/Users/mac/Desktop/Client projects/frecks-new/app/ticket/[id]/page.tsx"],u="/ticket/[id]/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/ticket/[id]/page",pathname:"/ticket/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},59420:(e,t,r)=>{Promise.resolve().then(r.bind(r,89117))},89117:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var a=r(10326),s=r(35047),i=r(44976),n=r(20108),o=r(10119),c=r(91664),d=r(38443),l=r(76253),u=r(47272),m=r(77506),p=r(69669),h=r(66307),f=r(21985),x=r(37358),_=r(77636),b=r(79635),y=r(2453),g=r(58407),w=r(24567),v=r(85999),k=r(94001);function j(){let e=(0,s.useParams)(),t=(0,s.useRouter)(),{user:r}=(0,k.a)(),j=(0,i.NL)(),N=e.id,{data:q,isLoading:S,error:M}=(0,n.a)({queryKey:["ticket",N],queryFn:()=>(0,l.Qn)(N),enabled:!!N}),E=(0,o.D)({mutationFn:async()=>{if(!r)throw Error("You must be logged in to validate tickets");if(!q)throw Error("Ticket not found");return await (0,u.li)(q.id,r.id)},onSuccess:()=>{v.Am.success("Ticket validated successfully!"),j.invalidateQueries({queryKey:["ticket",N]})},onError:e=>{v.Am.error(e.message||"Failed to validate ticket")}});if(S)return(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[a.jsx(g.default,{}),a.jsx("div",{className:"pt-20 min-h-screen flex items-center justify-center",children:a.jsx(m.Z,{className:"w-8 h-8 animate-spin"})}),a.jsx(w.Z,{})]});if(M||!q)return(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[a.jsx(g.default,{}),a.jsx("main",{className:"pt-20",children:a.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto bg-card rounded-2xl border border-border p-8 text-center",children:[a.jsx(p.Z,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Ticket Not Found"}),a.jsx("p",{className:"text-muted-foreground mb-6",children:"The ticket you're looking for doesn't exist or has been removed."}),a.jsx(c.z,{onClick:()=>t.push("/"),children:"Go to Home"})]})})}),a.jsx(w.Z,{})]});let C=q.event,D=q.ticket_type,Z="used"===q.status,O="cancelled"===q.status,P="valid"===q.status,z=P&&r&&C?.creator_id===r.id;return(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[a.jsx(g.default,{}),a.jsx("main",{className:"pt-20",children:a.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[P&&(0,a.jsxs)(d.C,{className:"bg-green-500 text-white text-lg px-4 py-2",children:[a.jsx(h.Z,{className:"w-4 h-4 mr-2"}),"Valid"]}),Z&&(0,a.jsxs)(d.C,{className:"bg-blue-500 text-white text-lg px-4 py-2",children:[a.jsx(h.Z,{className:"w-4 h-4 mr-2"}),"Validated"]}),O&&(0,a.jsxs)(d.C,{className:"bg-red-500 text-white text-lg px-4 py-2",children:[a.jsx(p.Z,{className:"w-4 h-4 mr-2"}),"Cancelled"]})]}),(0,a.jsxs)("div",{className:"bg-card rounded-2xl border border-border p-8 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:a.jsx(f.Z,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Ticket Details"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground font-mono",children:["ID: ",q.id.slice(0,8),"..."]})]})]}),(0,a.jsxs)("div",{className:"mb-6 pb-6 border-b border-border",children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:D?.name||"General Admission"}),D?.description&&a.jsx("p",{className:"text-muted-foreground",children:D.description}),a.jsx("div",{className:"mt-3",children:a.jsx(d.C,{variant:"outline",className:"text-lg",children:D?.is_free?"Free":`₦${Number(D?.price||0).toLocaleString()}`})})]}),C&&(0,a.jsxs)("div",{className:"mb-6 pb-6 border-b border-border",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Event Information"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-bold text-xl mb-2",children:C.title}),a.jsx(d.C,{className:"mb-3",children:C.category})]}),C.description&&a.jsx("p",{className:"text-muted-foreground",children:C.description}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx(x.Z,{className:"w-5 h-5 text-primary mt-0.5 shrink-0"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Date & Time"}),a.jsx("p",{className:"font-semibold",children:(0,y.WU)(new Date(C.date),"MMM d, yyyy • h:mm a")})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx(_.Z,{className:"w-5 h-5 text-primary mt-0.5 shrink-0"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Location"}),a.jsx("p",{className:"font-semibold",children:C.location})]})]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Ticket Holder"}),(0,a.jsxs)("div",{className:"space-y-3",children:[q.order_id&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(b.Z,{className:"w-5 h-5 text-muted-foreground"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Order ID"}),a.jsx("p",{className:"font-semibold font-mono text-sm",children:q.order_id})]})]}),q.checked_in_at&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(h.Z,{className:"w-5 h-5 text-green-500"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Validated At"}),a.jsx("p",{className:"font-semibold",children:(0,y.WU)(new Date(q.checked_in_at),"MMM d, yyyy • h:mm a")})]})]})]})]}),z&&a.jsx("div",{className:"pt-6 border-t border-border",children:a.jsx(c.z,{onClick:()=>E.mutate(),disabled:E.isPending||Z,className:"w-full",size:"lg",variant:"hero",children:E.isPending?(0,a.jsxs)(a.Fragment,{children:[a.jsx(m.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Validating..."]}):Z?(0,a.jsxs)(a.Fragment,{children:[a.jsx(h.Z,{className:"w-4 h-4 mr-2"}),"Already Validated"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(h.Z,{className:"w-4 h-4 mr-2"}),"Validate Ticket"]})})}),!z&&P&&r&&C?.creator_id!==r.id&&a.jsx("div",{className:"pt-6 border-t border-border",children:a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Only the event creator can validate tickets."})}),!r&&(0,a.jsxs)("div",{className:"pt-6 border-t border-border",children:[a.jsx("p",{className:"text-sm text-muted-foreground text-center mb-4",children:"Please log in as the event creator to validate this ticket."}),a.jsx(c.z,{onClick:()=>t.push("/auth/signin"),variant:"outline",className:"w-full",children:"Sign In"})]})]}),a.jsx("div",{className:"text-center",children:a.jsx(c.z,{variant:"outline",onClick:()=>t.back(),children:"Go Back"})})]})})}),a.jsx(w.Z,{})]})}},37358:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},66307:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},69669:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},77506:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},77636:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},21985:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},24567:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var a=r(10326),s=r(90434),i=r(46226),n=r(62881);let o=(0,n.Z)("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),c=(0,n.Z)("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),d=(0,n.Z)("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),l=(0,n.Z)("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]);var u=r(91664);let m=({showNewsletter:e=!1})=>{let t={company:["About Us","Careers","Blog","Press"],support:["Help Center","Safety","Terms","Privacy"],venues:["Partner With Us","List Your Event","Pricing","Resources"]};return(0,a.jsxs)("footer",{id:"about",className:"bg-card border-t border-border",children:[e&&a.jsx("div",{className:"container mx-auto px-4 py-12",children:(0,a.jsxs)("div",{className:"bg-primary rounded-3xl p-8 md:p-12 text-center",children:[a.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-primary-foreground mb-4",children:"Never Miss an Event! \uD83C\uDFAB"}),a.jsx("p",{className:"text-primary-foreground/80 mb-6 max-w-md mx-auto",children:"Subscribe to get notified about new events, exclusive deals, and early bird tickets."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 max-w-md mx-auto",children:[a.jsx("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-5 py-3 rounded-full bg-primary-foreground/20 border border-primary-foreground/30 text-primary-foreground placeholder:text-primary-foreground/60 outline-none focus:ring-2 focus:ring-primary-foreground/50"}),a.jsx(u.z,{variant:"secondary",size:"lg",children:"Subscribe"})]})]})}),a.jsx("div",{className:"container mx-auto px-4 py-12",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-8",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx(s.default,{href:"/",className:"flex items-center gap-2 mb-4 relative w-32 h-12",children:a.jsx(i.default,{src:"/logo.png",alt:"Frecks",fill:!0,className:"object-contain object-left"})}),a.jsx("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Your go-to platform for discovering and booking campus events. Made by students, for students."}),a.jsx("div",{className:"flex gap-3",children:[o,c,d,l].map((e,t)=>a.jsx("a",{href:"#",className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center hover:bg-primary hover:text-primary-foreground transition-colors",children:a.jsx(e,{className:"w-5 h-5"})},t))})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold mb-4",children:"Company"}),a.jsx("ul",{className:"space-y-2",children:t.company.map(e=>a.jsx("li",{children:a.jsx("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold mb-4",children:"Support"}),a.jsx("ul",{className:"space-y-2",children:t.support.map(e=>a.jsx("li",{children:a.jsx("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold mb-4",children:"For Venues"}),a.jsx("ul",{className:"space-y-2",children:t.venues.map(e=>a.jsx("li",{children:a.jsx("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:e})},e))})]})]})}),a.jsx("div",{className:"border-t border-border",children:a.jsx("div",{className:"container mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-muted-foreground",children:[a.jsx("p",{children:"\xa9 2026 Frecks. All rights reserved."}),a.jsx("p",{children:"Made with \uD83E\uDDE1 for students everywhere"})]})})})]})}},38443:(e,t,r)=>{"use strict";r.d(t,{C:()=>o});var a=r(10326);r(17577);var s=r(79360),i=r(51223);let n=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:t,...r}){return a.jsx("div",{className:(0,i.cn)(n({variant:t}),e),...r})}},47272:(e,t,r)=>{"use strict";r.d(t,{Bt:()=>n,D0:()=>c,E$:()=>x,LV:()=>o,Lj:()=>l,aE:()=>f,cD:()=>_,eJ:()=>i,li:()=>d,ob:()=>h,rM:()=>u,y6:()=>m,yM:()=>s,zf:()=>p});var a=r(2777);let s=async e=>{console.log("Creating event in database...",{creator_id:e.creator_id,title:e.title,category:e.category});let{data:t,error:r}=await a.supabase.from("events").insert({creator_id:e.creator_id,title:e.title,description:e.description,category:e.category,image_url:e.image_url,date:e.date,location:e.location,is_featured:e.is_featured||!1,status:"active"}).select().single();if(r)throw console.error("Event creation error:",r),Error(`Failed to create event: ${r.message} (${r.code||"unknown"})`);if(!t)throw Error("Event creation returned no data");console.log("Event created, ID:",t.id),console.log("Creating ticket types...",e.ticket_types.length);let s=e.ticket_types.map(e=>({event_id:t.id,name:e.name,description:e.description,price:e.price,quantity:e.quantity,is_free:e.is_free||!1})),{error:i}=await a.supabase.from("ticket_types").insert(s);if(i)throw console.error("Ticket types creation error:",i),Error(`Failed to create ticket types: ${i.message} (${i.code||"unknown"})`);return console.log("Ticket types created successfully"),t},i=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("events").update({title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured||!1,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw Error(`Failed to update event: ${s.message}`);if(!r)throw Error("Event update returned no data");let{data:i}=await a.supabase.from("ticket_types").select("id").eq("event_id",e),n=new Set(i?.map(e=>e.id)||[]),o=new Set(t.ticket_types.filter(e=>e.id).map(e=>e.id)),c=Array.from(n).filter(e=>!o.has(e));for(let r of(c.length>0&&await a.supabase.from("ticket_types").delete().in("id",c),t.ticket_types))r.id&&n.has(r.id)?await a.supabase.from("ticket_types").update({name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1}).eq("id",r.id):await a.supabase.from("ticket_types").insert({event_id:e,name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1});return r},n=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("events").select("*").eq("id",e).eq("creator_id",t).single();if(s)throw s;if(!r)throw Error("Event not found or access denied");let{error:i}=await a.supabase.from("deleted_events").insert({original_event_id:r.id,creator_id:r.creator_id,title:r.title,description:r.description,category:r.category,image_url:r.image_url,date:r.date,location:r.location,is_featured:r.is_featured,status:"cancelled",deleted_by:t,created_at:r.created_at,updated_at:r.updated_at});if(i)throw i;let{error:n}=await a.supabase.from("events").delete().eq("id",e).eq("creator_id",t);if(n)throw n;return{success:!0}},o=async e=>{let{data:t,error:r}=await a.supabase.from("orders").insert({user_id:e.user_id,event_id:e.event_id,email:e.email,full_name:e.full_name,total_amount:e.total_amount,paystack_reference:e.paystack_reference,payment_status:e.payment_status||"pending"}).select().single();if(r)throw r;let s=e.tickets.map(r=>({ticket_type_id:r.ticket_type_id,event_id:e.event_id,user_id:e.user_id,order_id:t.id,qr_code:r.qr_code,qr_code_data:r.qr_code_data,status:(e.payment_status,"valid")})),{error:i}=await a.supabase.from("tickets").insert(s);if(i)throw i;if("paid"===e.payment_status){let t=new Map;for(let r of e.tickets){let e=t.get(r.ticket_type_id)||0;t.set(r.ticket_type_id,e+1)}for(let[e,r]of t){let{data:t}=await a.supabase.from("ticket_types").select("sold_count").eq("id",e).single();t&&await a.supabase.from("ticket_types").update({sold_count:t.sold_count+r}).eq("id",e)}}return t},c=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("creator_profiles").upsert({user_id:e,...t}).select().single();if(s)throw s;return r},d=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("tickets").select("*, event:events!inner(creator_id, id)").eq("id",e).single();if(s||!r)throw Error("Ticket not found");if(r.event?.creator_id!==t)throw Error("Only the event creator can validate tickets");if("used"===r.status)throw Error("Ticket has already been validated");if("cancelled"===r.status)throw Error("Ticket has been cancelled");let{error:i}=await a.supabase.from("tickets").update({status:"used",checked_in_at:new Date().toISOString(),checked_in_by:t}).eq("id",e);if(i)throw Error(`Failed to validate ticket: ${i.message}`);return await a.supabase.from("qr_scans").insert({ticket_id:e,scanned_by:t,scan_result:"valid"}),{success:!0,ticketId:e}},l=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("users").update({full_name:t.full_name,gender:t.gender,school:t.school,avatar_name:t.avatar_name,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return r},u=async e=>{let{data:t,error:r}=await a.supabase.from("events").select("*").eq("id",e).single();if(r)throw r;if(!t)throw Error("Event not found");let{error:s}=await a.supabase.from("deleted_events").insert({original_event_id:t.id,creator_id:t.creator_id,title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured,status:"cancelled",deleted_by:t.creator_id,created_at:t.created_at,updated_at:t.updated_at});if(s)throw s;let{error:i}=await a.supabase.from("events").delete().eq("id",e);if(i)throw i;return{success:!0}},m=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("users").update({role:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;if("creator"===t){let{data:t}=await a.supabase.from("creator_profiles").select("id").eq("user_id",e).maybeSingle();t||await a.supabase.from("creator_profiles").insert({user_id:e})}return r},p=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("users").update({banned:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return r},h=async(e,t)=>{let{data:r,error:s}=await a.supabase.from("events").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return r},f=async(e,t,r)=>{let{data:s,error:i}=await a.supabase.from("creator_profiles").select("account_balance").eq("user_id",e).single();if(i)throw i;if(!s)throw Error("Creator profile not found");let n=Number(s.account_balance)||0;if(n<t)throw Error(`Insufficient balance. Available: ₦${n.toLocaleString()}`);let{data:o,error:c}=await a.supabase.from("withdrawals").insert({creator_id:e,amount:t,status:"pending",...r}).select().single();if(c)throw c;let{error:d}=await a.supabase.from("creator_profiles").update({account_balance:n-t}).eq("user_id",e);if(d)throw d;return await a.supabase.from("wallet_transactions").insert({creator_id:e,type:"withdrawal",amount:-t,status:"pending",description:`Withdrawal request - ${r.bank_name} ${r.bank_account_number}`}),o},x=async(e,t,r)=>{let{data:s,error:i}=await a.supabase.from("withdrawals").update({status:"approved",approved_by:t,approved_at:new Date().toISOString(),admin_note:r}).eq("id",e).select().single();if(i)throw i;return await a.supabase.from("wallet_transactions").update({status:"completed"}).eq("creator_id",s.creator_id).eq("amount",-s.amount).eq("type","withdrawal").eq("status","pending"),s},_=async(e,t,r)=>{let{data:s,error:i}=await a.supabase.from("withdrawals").select("*").eq("id",e).single();if(i)throw i;if(!s)throw Error("Withdrawal not found");let{error:n}=await a.supabase.from("withdrawals").update({status:"rejected",approved_by:t,rejected_at:new Date().toISOString(),admin_note:r}).eq("id",e);if(n)throw n;let{data:o}=await a.supabase.from("creator_profiles").select("account_balance").eq("user_id",s.creator_id).single();if(o){let e=Number(o.account_balance)||0;await a.supabase.from("creator_profiles").update({account_balance:e+Number(s.amount)}).eq("user_id",s.creator_id)}return await a.supabase.from("wallet_transactions").update({status:"failed"}).eq("creator_id",s.creator_id).eq("amount",-s.amount).eq("type","withdrawal").eq("status","pending"),s}},76253:(e,t,r)=>{"use strict";r.d(t,{AW:()=>y,DK:()=>u,HG:()=>o,IP:()=>b,Q6:()=>p,Qn:()=>c,TX:()=>l,T_:()=>x,Y:()=>n,Y9:()=>k,ZD:()=>d,fX:()=>w,ks:()=>m,nk:()=>i,pj:()=>_,sN:()=>v,vw:()=>s,wY:()=>h,z8:()=>f,zk:()=>g});var a=r(2777);let s=async()=>{let e=new Date().toISOString(),{data:t,error:r}=await a.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",e).order("created_at",{ascending:!1});if(r)throw r;return t},i=async e=>{let t=new Date().toISOString(),r=a.supabase.from("events").select("*, ticket_types(*), creator:users!events_creator_id_fkey(school)").eq("status","active").gte("date",t);if(e.search&&e.search.trim()){let t=e.search.trim().replace(/%/g,"\\%").replace(/_/g,"\\_");r=r.or(`title.ilike.%${t}%,description.ilike.%${t}%`)}e.category&&"all"!==e.category&&(r=r.eq("category",e.category)),e.location&&e.location.trim()&&(r=r.ilike("location",`%${e.location}%`)),e.dateFrom&&(r=r.gte("date",e.dateFrom)),e.dateTo&&(r=r.lte("date",e.dateTo)),r=r.order("date",{ascending:!0});let{data:s,error:i}=await r;if(i)throw i;let n=s||[];return e.school&&"all"!==e.school&&(n=n.filter(t=>{let r=t.creator;return r?.school===e.school})),n},n=async e=>{let{data:t,error:r}=await a.supabase.from("events").select("*, ticket_types(*)").eq("id",e).single();if(r)throw r;return t},o=async e=>{let{data:t,error:r}=await a.supabase.from("orders").select("*, event:events(*), tickets(*, ticket_type:ticket_types(*))").eq("id",e).single();if(r)throw r;return t},c=async e=>{let{data:t,error:r}=await a.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*)").eq("id",e).single();if(r)throw r;return t},d=async e=>{let{data:t,error:r}=await a.supabase.from("orders").select("id").eq("user_id",e).eq("payment_status","paid");if(r)throw r;if(!t||0===t.length)return[];let s=t.map(e=>e.id),{data:i,error:n}=await a.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*), order:orders(*)").eq("user_id",e).in("order_id",s).order("created_at",{ascending:!1});if(n)throw n;return i||[]},l=async e=>{let t=new Date().toISOString(),{data:r,error:s}=await a.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).gte("date",t).order("date",{ascending:!0});if(s)throw s;return r},u=async e=>{let t=new Date().toISOString(),{data:r,error:s}=await a.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).lt("date",t).order("date",{ascending:!1});if(s)throw s;return r},m=async e=>{let{data:t,error:r}=await a.supabase.from("creator_profiles").select("*").eq("user_id",e).maybeSingle();if(r)throw r;return t||null},p=async e=>{let{data:t,error:r}=await a.supabase.from("orders").select("*, tickets(*)").eq("event_id",e).eq("payment_status","paid");if(r)throw r;let{data:s,error:i}=await a.supabase.from("tickets").select("*, ticket_type:ticket_types(*)").eq("event_id",e);if(i)throw i;return{orders:t||[],tickets:s||[]}},h=async e=>{let{data:t,error:r}=await a.supabase.from("wallet_transactions").select("*").eq("creator_id",e).order("created_at",{ascending:!1});if(r)throw r;return t},f=async e=>{let{data:t,error:r}=await a.supabase.from("withdrawals").select("*").eq("creator_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]},x=async()=>{let{data:e,error:t}=await a.supabase.from("withdrawals").select("*, creator:users!withdrawals_creator_id_fkey(id, email, full_name, school)").order("created_at",{ascending:!1});if(t)throw t;return e||[]},_=async e=>{let{data:t,error:r}=await a.supabase.from("creator_profiles").select("account_balance, bank_account_name, bank_account_number, bank_name, bank_code, is_bank_verified").eq("user_id",e).single();if(r)throw r;return t},b=async()=>{let{data:e,error:t}=await a.supabase.from("events").select("*, ticket_types(*), creator:users!events_creator_id_fkey(id, email, full_name, school)").order("created_at",{ascending:!1});if(t)throw t;return e||[]},y=async()=>{let{data:e,error:t}=await a.supabase.from("users").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]},g=async()=>{let{data:e,error:t}=await a.supabase.from("orders").select("*, event:events(id, title, creator:users!events_creator_id_fkey(id, email, full_name)), user:users(id, email, full_name)").order("created_at",{ascending:!1});if(t)throw t;return e||[]},w=async()=>{let{data:e,error:t}=await a.supabase.from("tickets").select("*, event:events(id, title), ticket_type:ticket_types(id, name, price, is_free), user:users(id, email, full_name), order:orders(id, payment_status)").order("created_at",{ascending:!1});if(t)throw console.error("Error fetching all tickets:",t),t;return e||[]},v=async()=>{let{data:e,error:t}=await a.supabase.from("users").select("*, creator_profile:creator_profiles(*)").eq("role","creator").order("created_at",{ascending:!1});if(t)throw t;return e||[]},k=async()=>{let{data:e,error:t}=await a.supabase.from("events").select("status");if(t)throw t;let r={active:0,draft:0,completed:0,cancelled:0};e?.forEach(e=>{e.status in r&&r[e.status]++});let{data:s,error:i}=await a.supabase.from("users").select("role, banned");if(i)throw i;let n={user:0,creator:0,admin:0},o=0;s?.forEach(e=>{e.role in n&&n[e.role]++,e.banned&&o++});let{data:c,error:d}=await a.supabase.from("orders").select("total_amount, created_at").eq("payment_status","paid");if(d)throw d;let l=c?.reduce((e,t)=>e+parseFloat(t.total_amount||0),0)||0,u=new Date,m=new Date(u.getFullYear(),u.getMonth(),1).toISOString(),p=c?.filter(e=>e.created_at>=m).reduce((e,t)=>e+parseFloat(t.total_amount||0),0)||0,{data:h,error:f}=await a.supabase.from("tickets").select("id");if(f)throw f;let x=h?.length||0,{data:_,error:b}=await a.supabase.from("users").select("id").eq("role","creator");if(b)throw b;let y=_?.length||0;return{events:{total:e?.length||0,byStatus:r},users:{total:s?.length||0,byRole:n,banned:o},revenue:{total:l,thisMonth:p},tickets:{totalSold:x},organizers:{active:y}}}},67714:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`/Users/mac/Desktop/Client projects/frecks-new/app/ticket/[id]/page.tsx#default`)},10119:(e,t,r)=>{"use strict";r.d(t,{D:()=>l});var a=r(17577),s=r(71180),i=r(12113),n=r(64351),o=r(3341),c=class extends n.l{#e;#t=void 0;#r;#a;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#s(),this.#i()}mutate(e,t){return this.#a=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#s(){let e=this.#r?.state??(0,s.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){i.Vr.batch(()=>{if(this.#a&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context;e?.type==="success"?(this.#a.onSuccess?.(e.data,t,r),this.#a.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#a.onError?.(e.error,t,r),this.#a.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#t)})})}},d=r(44976);function l(e,t){let r=(0,d.NL)(t),[s]=a.useState(()=>new c(r,e));a.useEffect(()=>{s.setOptions(e)},[s,e]);let n=a.useSyncExternalStore(a.useCallback(e=>s.subscribe(i.Vr.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=a.useCallback((e,t)=>{s.mutate(e,t).catch(o.ZT)},[s]);if(n.error&&(0,o.L3)(s.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,759,65,453,561,812,643,108,236,407],()=>r(39346));module.exports=a})();