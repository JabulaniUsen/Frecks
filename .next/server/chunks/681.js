"use strict";exports.id=681,exports.ids=[681],exports.modules={86333:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},24230:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},71709:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},77506:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},91664:(e,t,r)=>{r.d(t,{d:()=>d,z:()=>u});var a=r(10326),i=r(17577),s=r(34214),o=r(79360),n=r(51223);let d=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-button hover:brightness-110 active:scale-95",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border-2 border-primary bg-transparent text-primary hover:bg-primary hover:text-primary-foreground",secondary:"bg-secondary text-secondary-foreground hover:brightness-110 active:scale-95",ghost:"hover:bg-muted hover:text-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-primary text-primary-foreground shadow-button hover:brightness-110 active:scale-95 font-bold",accent:"bg-accent text-accent-foreground border border-border hover:bg-muted active:scale-95"},size:{default:"h-11 px-6 py-2",sm:"h-9 px-4 text-xs",lg:"h-14 px-8 text-base",xl:"h-16 px-10 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=i.forwardRef(({className:e,variant:t,size:r,asChild:i=!1,...o},u)=>{let c=i?s.g7:"button";return a.jsx(c,{className:(0,n.cn)(d({variant:t,size:r,className:e})),ref:u,...o})});u.displayName="Button"},41190:(e,t,r)=>{r.d(t,{I:()=>o});var a=r(10326),i=r(17577),s=r(51223);let o=i.forwardRef(({className:e,type:t,...r},i)=>a.jsx("input",{type:t,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...r}));o.displayName="Input"},44794:(e,t,r)=>{r.d(t,{_:()=>u});var a=r(10326),i=r(17577),s=r(34478),o=r(79360),n=r(51223);let d=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=i.forwardRef(({className:e,...t},r)=>a.jsx(s.f,{ref:r,className:(0,n.cn)(d(),e),...t}));u.displayName=s.f.displayName},82015:(e,t,r)=>{r.d(t,{g:()=>o});var a=r(10326),i=r(17577),s=r(51223);let o=i.forwardRef(({className:e,...t},r)=>a.jsx("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));o.displayName="Textarea"},47272:(e,t,r)=>{r.d(t,{Bt:()=>o,D0:()=>d,E$:()=>m,LV:()=>n,Lj:()=>c,aE:()=>_,cD:()=>b,eJ:()=>s,li:()=>u,ob:()=>h,rM:()=>l,y6:()=>p,yM:()=>i,zf:()=>f});var a=r(2777);let i=async e=>{console.log("Creating event in database...",{creator_id:e.creator_id,title:e.title,category:e.category});let{data:t,error:r}=await a.supabase.from("events").insert({creator_id:e.creator_id,title:e.title,description:e.description,category:e.category,image_url:e.image_url,date:e.date,location:e.location,is_featured:e.is_featured||!1,status:"active"}).select().single();if(r)throw console.error("Event creation error:",r),Error(`Failed to create event: ${r.message} (${r.code||"unknown"})`);if(!t)throw Error("Event creation returned no data");console.log("Event created, ID:",t.id),console.log("Creating ticket types...",e.ticket_types.length);let i=e.ticket_types.map(e=>({event_id:t.id,name:e.name,description:e.description,price:e.price,quantity:e.quantity,is_free:e.is_free||!1})),{error:s}=await a.supabase.from("ticket_types").insert(i);if(s)throw console.error("Ticket types creation error:",s),Error(`Failed to create ticket types: ${s.message} (${s.code||"unknown"})`);return console.log("Ticket types created successfully"),t},s=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("events").update({title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured||!1,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw Error(`Failed to update event: ${i.message}`);if(!r)throw Error("Event update returned no data");let{data:s}=await a.supabase.from("ticket_types").select("id").eq("event_id",e),o=new Set(s?.map(e=>e.id)||[]),n=new Set(t.ticket_types.filter(e=>e.id).map(e=>e.id)),d=Array.from(o).filter(e=>!n.has(e));for(let r of(d.length>0&&await a.supabase.from("ticket_types").delete().in("id",d),t.ticket_types))r.id&&o.has(r.id)?await a.supabase.from("ticket_types").update({name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1}).eq("id",r.id):await a.supabase.from("ticket_types").insert({event_id:e,name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1});return r},o=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("events").select("*").eq("id",e).eq("creator_id",t).single();if(i)throw i;if(!r)throw Error("Event not found or access denied");let{error:s}=await a.supabase.from("deleted_events").insert({original_event_id:r.id,creator_id:r.creator_id,title:r.title,description:r.description,category:r.category,image_url:r.image_url,date:r.date,location:r.location,is_featured:r.is_featured,status:"cancelled",deleted_by:t,created_at:r.created_at,updated_at:r.updated_at});if(s)throw s;let{error:o}=await a.supabase.from("events").delete().eq("id",e).eq("creator_id",t);if(o)throw o;return{success:!0}},n=async e=>{let{data:t,error:r}=await a.supabase.from("orders").insert({user_id:e.user_id,event_id:e.event_id,email:e.email,full_name:e.full_name,total_amount:e.total_amount,paystack_reference:e.paystack_reference,payment_status:e.payment_status||"pending"}).select().single();if(r)throw r;let i=e.tickets.map(r=>({ticket_type_id:r.ticket_type_id,event_id:e.event_id,user_id:e.user_id,order_id:t.id,qr_code:r.qr_code,qr_code_data:r.qr_code_data,status:(e.payment_status,"valid")})),{error:s}=await a.supabase.from("tickets").insert(i);if(s)throw s;if("paid"===e.payment_status){let t=new Map;for(let r of e.tickets){let e=t.get(r.ticket_type_id)||0;t.set(r.ticket_type_id,e+1)}for(let[e,r]of t){let{data:t}=await a.supabase.from("ticket_types").select("sold_count").eq("id",e).single();t&&await a.supabase.from("ticket_types").update({sold_count:t.sold_count+r}).eq("id",e)}}return t},d=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("creator_profiles").upsert({user_id:e,...t}).select().single();if(i)throw i;return r},u=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("tickets").select("*, event:events!inner(creator_id, id)").eq("id",e).single();if(i||!r)throw Error("Ticket not found");if(r.event?.creator_id!==t)throw Error("Only the event creator can validate tickets");if("used"===r.status)throw Error("Ticket has already been validated");if("cancelled"===r.status)throw Error("Ticket has been cancelled");let{error:s}=await a.supabase.from("tickets").update({status:"used",checked_in_at:new Date().toISOString(),checked_in_by:t}).eq("id",e);if(s)throw Error(`Failed to validate ticket: ${s.message}`);return await a.supabase.from("qr_scans").insert({ticket_id:e,scanned_by:t,scan_result:"valid"}),{success:!0,ticketId:e}},c=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("users").update({full_name:t.full_name,gender:t.gender,school:t.school,avatar_name:t.avatar_name,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return r},l=async e=>{let{data:t,error:r}=await a.supabase.from("events").select("*").eq("id",e).single();if(r)throw r;if(!t)throw Error("Event not found");let{error:i}=await a.supabase.from("deleted_events").insert({original_event_id:t.id,creator_id:t.creator_id,title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured,status:"cancelled",deleted_by:t.creator_id,created_at:t.created_at,updated_at:t.updated_at});if(i)throw i;let{error:s}=await a.supabase.from("events").delete().eq("id",e);if(s)throw s;return{success:!0}},p=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("users").update({role:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;if("creator"===t){let{data:t}=await a.supabase.from("creator_profiles").select("id").eq("user_id",e).maybeSingle();t||await a.supabase.from("creator_profiles").insert({user_id:e})}return r},f=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("users").update({banned:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return r},h=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("events").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return r},_=async(e,t,r)=>{let{data:i,error:s}=await a.supabase.from("creator_profiles").select("account_balance").eq("user_id",e).single();if(s)throw s;if(!i)throw Error("Creator profile not found");let o=Number(i.account_balance)||0;if(o<t)throw Error(`Insufficient balance. Available: â‚¦${o.toLocaleString()}`);let{data:n,error:d}=await a.supabase.from("withdrawals").insert({creator_id:e,amount:t,status:"pending",...r}).select().single();if(d)throw d;let{error:u}=await a.supabase.from("creator_profiles").update({account_balance:o-t}).eq("user_id",e);if(u)throw u;return await a.supabase.from("wallet_transactions").insert({creator_id:e,type:"withdrawal",amount:-t,status:"pending",description:`Withdrawal request - ${r.bank_name} ${r.bank_account_number}`}),n},m=async(e,t,r)=>{let{data:i,error:s}=await a.supabase.from("withdrawals").update({status:"approved",approved_by:t,approved_at:new Date().toISOString(),admin_note:r}).eq("id",e).select().single();if(s)throw s;return await a.supabase.from("wallet_transactions").update({status:"completed"}).eq("creator_id",i.creator_id).eq("amount",-i.amount).eq("type","withdrawal").eq("status","pending"),i},b=async(e,t,r)=>{let{data:i,error:s}=await a.supabase.from("withdrawals").select("*").eq("id",e).single();if(s)throw s;if(!i)throw Error("Withdrawal not found");let{error:o}=await a.supabase.from("withdrawals").update({status:"rejected",approved_by:t,rejected_at:new Date().toISOString(),admin_note:r}).eq("id",e);if(o)throw o;let{data:n}=await a.supabase.from("creator_profiles").select("account_balance").eq("user_id",i.creator_id).single();if(n){let e=Number(n.account_balance)||0;await a.supabase.from("creator_profiles").update({account_balance:e+Number(i.amount)}).eq("user_id",i.creator_id)}return await a.supabase.from("wallet_transactions").update({status:"failed"}).eq("creator_id",i.creator_id).eq("amount",-i.amount).eq("type","withdrawal").eq("status","pending"),i}},10119:(e,t,r)=>{r.d(t,{D:()=>c});var a=r(17577),i=r(71180),s=r(12113),o=r(64351),n=r(3341),d=class extends o.l{#e;#t=void 0;#r;#a;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,n.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,n.Ym)(t.mutationKey)!==(0,n.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#s(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#i(),this.#s()}mutate(e,t){return this.#a=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#i(){let e=this.#r?.state??(0,i.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#s(e){s.Vr.batch(()=>{if(this.#a&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context;e?.type==="success"?(this.#a.onSuccess?.(e.data,t,r),this.#a.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#a.onError?.(e.error,t,r),this.#a.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#t)})})}},u=r(44976);function c(e,t){let r=(0,u.NL)(t),[i]=a.useState(()=>new d(r,e));a.useEffect(()=>{i.setOptions(e)},[i,e]);let o=a.useSyncExternalStore(a.useCallback(e=>i.subscribe(s.Vr.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),c=a.useCallback((e,t)=>{i.mutate(e,t).catch(n.ZT)},[i]);if(o.error&&(0,n.L3)(i.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:c,mutateAsync:o.mutate}}}};