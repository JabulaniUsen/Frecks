"use strict";exports.id=205,exports.ids=[205],exports.modules={37358:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},77506:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},77636:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},24061:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},38443:(e,t,r)=>{r.d(t,{C:()=>o});var a=r(10326);r(17577);var i=r(79360),s=r(51223);let n=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:t,...r}){return a.jsx("div",{className:(0,s.cn)(n({variant:t}),e),...r})}},41190:(e,t,r)=>{r.d(t,{I:()=>n});var a=r(10326),i=r(17577),s=r(51223);let n=i.forwardRef(({className:e,type:t,...r},i)=>a.jsx("input",{type:t,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...r}));n.displayName="Input"},44794:(e,t,r)=>{r.d(t,{_:()=>d});var a=r(10326),i=r(17577),s=r(34478),n=r(79360),o=r(51223);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(({className:e,...t},r)=>a.jsx(s.f,{ref:r,className:(0,o.cn)(c(),e),...t}));d.displayName=s.f.displayName},22321:(e,t,r)=>{r.d(t,{G5:()=>s,Wb:()=>i,m5:()=>o,s4:()=>n});let a=("undefined"!=typeof process?"pk_test_305a29a2af6419e97f6aaf29d62c648d334d8a1c":void 0)||"";a||console.warn("Paystack public key is not set. Payment functionality will not work.");let i=e=>{if(!window.PaystackPop){console.error("Paystack not loaded");return}window.PaystackPop.setup({key:a,email:e.email,amount:100*e.amount,ref:e.ref,currency:e.currency||"NGN",metadata:e.metadata,callback:t=>{e.callback&&e.callback(t)},onClose:()=>{e.onClose&&e.onClose()}}).openIframe()},s=async()=>{try{try{let e=await fetch("/api/get-banks",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||`HTTP error! status: ${e.status}`)}let t=await e.json();if(t.error)throw Error(t.error);let r=t.banks||[];return console.log("Banks from API route:",r.length,"banks"),0===r.length&&console.warn("Empty banks array returned"),r}catch(s){console.warn("API route failed, trying edge function:",s.message);let{supabase:e}=await Promise.resolve().then(r.bind(r,2777)),{data:{session:t}}=await e.auth.getSession(),{data:a,error:i}=await e.functions.invoke("get-paystack-banks",{headers:{Authorization:t?`Bearer ${t.access_token}`:""}});if(i)throw i;if(!a)throw Error("No response from bank service");if(a.error)throw Error(a.error);return a.banks||[]}}catch(t){console.error("Error fetching banks:",t);let e=t.message||JSON.stringify(t);if(e.includes("not found")||e.includes("404")||e.includes("Function not found")||e.includes("Failed to send")||e.includes("CORS"))throw Error("Bank service is not available. Please check your environment variables (PAYSTACK_SECRET_KEY) and try again.");throw Error(t.message||"Failed to fetch banks. Please try again.")}},n=async e=>{try{if(!e.account_number||!e.bank_code)return{verified:!1,error:"Account number and bank code are required"};if(10!==e.account_number.length)return{verified:!1,error:"Account number must be exactly 10 digits"};try{let t=await fetch("/api/verify-bank-account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||`HTTP error! status: ${t.status}`)}let r=await t.json();if(r.error)return{verified:!1,error:r.error};return{verified:r.verified||!1,account_name:r.account_name,account_number:r.account_number,bank_id:r.bank_id}}catch(n){console.warn("API route failed, trying edge function:",n.message);let{supabase:t}=await Promise.resolve().then(r.bind(r,2777)),{data:{session:a}}=await t.auth.getSession(),{data:i,error:s}=await t.functions.invoke("verify-bank-account",{body:e,headers:{Authorization:a?`Bearer ${a.access_token}`:""}});if(s)throw s;if(!i)return{verified:!1,error:"No response from verification service"};if(i.error)return{verified:!1,error:i.error};return{verified:i.verified||!1,account_name:i.account_name,account_number:i.account_number,bank_id:i.bank_id}}}catch(t){console.error("Bank verification error:",t);let e=t.message||JSON.stringify(t);if(e.includes("not found")||e.includes("404")||e.includes("Function not found")||e.includes("Failed to send")||e.includes("CORS"))return{verified:!1,error:"Bank verification service is not available. Please check your environment variables (PAYSTACK_SECRET_KEY) and try again."};return{verified:!1,error:t.message||"Failed to verify bank account. Please try again."}}},o=async(e,t)=>{try{try{let r=await fetch("/api/verify-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:e,paystackReference:t})});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(o){console.warn("API route failed, trying edge function:",o.message);let{supabase:a}=await Promise.resolve().then(r.bind(r,2777)),{data:{session:i}}=await a.auth.getSession(),{data:s,error:n}=await a.functions.invoke("verify-payment",{body:{orderId:e,paystackReference:t},headers:{Authorization:i?`Bearer ${i.access_token}`:"","Content-Type":"application/json"}});if(n)throw n;if(!s)throw Error("No response from verification service");return s}}catch(t){console.error("Payment verification error:",t);let e=t.message||JSON.stringify(t);if(e.includes("not found")||e.includes("404")||e.includes("Function not found")||e.includes("Failed to send")||e.includes("CORS"))return{verified:!1,error:"Payment verification service error. Please check your environment variables (PAYSTACK_SECRET_KEY, SUPABASE_SERVICE_ROLE_KEY) and try again."};return{verified:!1,error:t.message||"Failed to verify payment. Please try again."}}}},47272:(e,t,r)=>{r.d(t,{Bt:()=>n,D0:()=>c,LV:()=>o,Lj:()=>u,eJ:()=>s,li:()=>d,yM:()=>i});var a=r(2777);let i=async e=>{console.log("Creating event in database...",{creator_id:e.creator_id,title:e.title,category:e.category});let{data:t,error:r}=await a.supabase.from("events").insert({creator_id:e.creator_id,title:e.title,description:e.description,category:e.category,image_url:e.image_url,date:e.date,location:e.location,is_featured:e.is_featured||!1,status:"active"}).select().single();if(r)throw console.error("Event creation error:",r),Error(`Failed to create event: ${r.message} (${r.code||"unknown"})`);if(!t)throw Error("Event creation returned no data");console.log("Event created, ID:",t.id),console.log("Creating ticket types...",e.ticket_types.length);let i=e.ticket_types.map(e=>({event_id:t.id,name:e.name,description:e.description,price:e.price,quantity:e.quantity,is_free:e.is_free||!1})),{error:s}=await a.supabase.from("ticket_types").insert(i);if(s)throw console.error("Ticket types creation error:",s),Error(`Failed to create ticket types: ${s.message} (${s.code||"unknown"})`);return console.log("Ticket types created successfully"),t},s=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("events").update({title:t.title,description:t.description,category:t.category,image_url:t.image_url,date:t.date,location:t.location,is_featured:t.is_featured||!1,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw Error(`Failed to update event: ${i.message}`);if(!r)throw Error("Event update returned no data");let{data:s}=await a.supabase.from("ticket_types").select("id").eq("event_id",e),n=new Set(s?.map(e=>e.id)||[]),o=new Set(t.ticket_types.filter(e=>e.id).map(e=>e.id)),c=Array.from(n).filter(e=>!o.has(e));for(let r of(c.length>0&&await a.supabase.from("ticket_types").delete().in("id",c),t.ticket_types))r.id&&n.has(r.id)?await a.supabase.from("ticket_types").update({name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1}).eq("id",r.id):await a.supabase.from("ticket_types").insert({event_id:e,name:r.name,description:r.description,price:r.price,quantity:r.quantity,is_free:r.is_free||!1});return r},n=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("events").select("*").eq("id",e).eq("creator_id",t).single();if(i)throw i;if(!r)throw Error("Event not found or access denied");let{error:s}=await a.supabase.from("deleted_events").insert({original_event_id:r.id,creator_id:r.creator_id,title:r.title,description:r.description,category:r.category,image_url:r.image_url,date:r.date,location:r.location,is_featured:r.is_featured,status:"cancelled",deleted_by:t,created_at:r.created_at,updated_at:r.updated_at});if(s)throw s;let{error:n}=await a.supabase.from("events").delete().eq("id",e).eq("creator_id",t);if(n)throw n;return{success:!0}},o=async e=>{let{data:t,error:r}=await a.supabase.from("orders").insert({user_id:e.user_id,event_id:e.event_id,email:e.email,full_name:e.full_name,total_amount:e.total_amount,paystack_reference:e.paystack_reference,payment_status:e.payment_status||"pending"}).select().single();if(r)throw r;let i=e.tickets.map(r=>({ticket_type_id:r.ticket_type_id,event_id:e.event_id,user_id:e.user_id,order_id:t.id,qr_code:r.qr_code,qr_code_data:r.qr_code_data,status:(e.payment_status,"valid")})),{error:s}=await a.supabase.from("tickets").insert(i);if(s)throw s;if("paid"===e.payment_status){let t=new Map;for(let r of e.tickets){let e=t.get(r.ticket_type_id)||0;t.set(r.ticket_type_id,e+1)}for(let[e,r]of t){let{data:t}=await a.supabase.from("ticket_types").select("sold_count").eq("id",e).single();t&&await a.supabase.from("ticket_types").update({sold_count:t.sold_count+r}).eq("id",e)}}return t},c=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("creator_profiles").upsert({user_id:e,...t}).select().single();if(i)throw i;return r},d=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("tickets").select("*, event:events!inner(creator_id, id)").eq("id",e).single();if(i||!r)throw Error("Ticket not found");if(r.event?.creator_id!==t)throw Error("Only the event creator can validate tickets");if("used"===r.status)throw Error("Ticket has already been validated");if("cancelled"===r.status)throw Error("Ticket has been cancelled");let{error:s}=await a.supabase.from("tickets").update({status:"used",checked_in_at:new Date().toISOString(),checked_in_by:t}).eq("id",e);if(s)throw Error(`Failed to validate ticket: ${s.message}`);return await a.supabase.from("qr_scans").insert({ticket_id:e,scanned_by:t,scan_result:"valid"}),{success:!0,ticketId:e}},u=async(e,t)=>{let{data:r,error:i}=await a.supabase.from("users").update({full_name:t.full_name,gender:t.gender,school:t.school,avatar_name:t.avatar_name,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return r}},76253:(e,t,r)=>{r.d(t,{DK:()=>l,HG:()=>o,Q6:()=>p,Qn:()=>c,TX:()=>u,Y:()=>n,ZD:()=>d,ks:()=>f,nk:()=>s,vw:()=>i});var a=r(2777);let i=async()=>{let e=new Date().toISOString(),{data:t,error:r}=await a.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",e).order("created_at",{ascending:!1});if(r)throw r;return t},s=async e=>{let t=new Date().toISOString(),r=a.supabase.from("events").select("*, ticket_types(*)").eq("status","active").gte("date",t);if(e.search&&e.search.trim()){let t=e.search.trim().replace(/%/g,"\\%").replace(/_/g,"\\_");r=r.or(`title.ilike.%${t}%,description.ilike.%${t}%`)}e.category&&"all"!==e.category&&(r=r.eq("category",e.category)),e.location&&e.location.trim()&&(r=r.ilike("location",`%${e.location}%`)),e.dateFrom&&(r=r.gte("date",e.dateFrom)),e.dateTo&&(r=r.lte("date",e.dateTo)),r=r.order("date",{ascending:!0});let{data:i,error:s}=await r;if(s)throw s;return i},n=async e=>{let{data:t,error:r}=await a.supabase.from("events").select("*, ticket_types(*)").eq("id",e).single();if(r)throw r;return t},o=async e=>{let{data:t,error:r}=await a.supabase.from("orders").select("*, event:events(*), tickets(*, ticket_type:ticket_types(*))").eq("id",e).single();if(r)throw r;return t},c=async e=>{let{data:t,error:r}=await a.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*)").eq("id",e).single();if(r)throw r;return t},d=async e=>{let{data:t,error:r}=await a.supabase.from("orders").select("id").eq("user_id",e).eq("payment_status","paid");if(r)throw r;if(!t||0===t.length)return[];let i=t.map(e=>e.id),{data:s,error:n}=await a.supabase.from("tickets").select("*, event:events(*), ticket_type:ticket_types(*), order:orders(*)").eq("user_id",e).in("order_id",i).order("created_at",{ascending:!1});if(n)throw n;return s||[]},u=async e=>{let t=new Date().toISOString(),{data:r,error:i}=await a.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).gte("date",t).order("date",{ascending:!0});if(i)throw i;return r},l=async e=>{let t=new Date().toISOString(),{data:r,error:i}=await a.supabase.from("events").select("*, ticket_types(*)").eq("creator_id",e).lt("date",t).order("date",{ascending:!1});if(i)throw i;return r},f=async e=>{let{data:t,error:r}=await a.supabase.from("creator_profiles").select("*").eq("user_id",e).maybeSingle();if(r)throw r;return t||null},p=async e=>{let{data:t,error:r}=await a.supabase.from("orders").select("*, tickets(*)").eq("event_id",e).eq("payment_status","paid");if(r)throw r;let{data:i,error:s}=await a.supabase.from("tickets").select("*, ticket_type:ticket_types(*)").eq("event_id",e);if(s)throw s;return{orders:t||[],tickets:i||[]}}},10119:(e,t,r)=>{r.d(t,{D:()=>u});var a=r(17577),i=r(71180),s=r(12113),n=r(64351),o=r(3341),c=class extends n.l{#e;#t=void 0;#r;#a;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#s(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#i(),this.#s()}mutate(e,t){return this.#a=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#i(){let e=this.#r?.state??(0,i.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#s(e){s.Vr.batch(()=>{if(this.#a&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context;e?.type==="success"?(this.#a.onSuccess?.(e.data,t,r),this.#a.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#a.onError?.(e.error,t,r),this.#a.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#t)})})}},d=r(44976);function u(e,t){let r=(0,d.NL)(t),[i]=a.useState(()=>new c(r,e));a.useEffect(()=>{i.setOptions(e)},[i,e]);let n=a.useSyncExternalStore(a.useCallback(e=>i.subscribe(s.Vr.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),u=a.useCallback((e,t)=>{i.mutate(e,t).catch(o.ZT)},[i]);if(n.error&&(0,o.L3)(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:u,mutateAsync:n.mutate}}}};